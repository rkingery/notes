<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personal Notes - Multipole Expansion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../electrodynamics/magnetostatics.html" rel="next">
<link href="../electrodynamics/bvps-2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/multipole-expansion.html"><span class="chapter-title">Multipole Expansion</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Classical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/newtonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Newtonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/simple-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Simple Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/reference-frames.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Reference Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/lagrangian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lagrangian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/hamiltonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Hamiltonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/central-forces.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Central Forces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/coupled-oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Coupled Oscillations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/rigid-bodies.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rigid Bodies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/canonical-transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Canonical Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/integrability-and-chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Integrability and Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/continuum-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Continuum Mechanics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Electromagnetism</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/preliminaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/electrostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Electrostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/multipole-expansion.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Multipole Expansion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/magnetostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Magnetostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/maxwell-equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Maxwell’s Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/orthogonal-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix I: Orthogonal Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/complex-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix II: Complex Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Circuit Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/circuit-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Lumped Circuit Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Analyzing Circuits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/nonlinear-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nonlinear Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/digital-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Digital Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/amplifiers.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/first-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">First-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/second-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/ac-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">AC Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/op-amps.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Operational Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/energy-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Energy and Power</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Quantum Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/identical-particles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Identical Particles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/second-quantization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second Quantization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/thermodynamics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Thermodynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/kinetic-theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Kinetic Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Gases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Gases</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#complex-methods" id="toc-complex-methods" class="nav-link active" data-scroll-target="#complex-methods">Complex Methods</a>
  <ul class="collapse">
  <li><a href="#complex-potential" id="toc-complex-potential" class="nav-link" data-scroll-target="#complex-potential">Complex Potential</a></li>
  <li><a href="#conformal-mappings" id="toc-conformal-mappings" class="nav-link" data-scroll-target="#conformal-mappings">Conformal Mappings</a></li>
  <li><a href="#d-boundary-value-problems" id="toc-d-boundary-value-problems" class="nav-link" data-scroll-target="#d-boundary-value-problems">2D Boundary Value Problems</a></li>
  </ul></li>
  <li><a href="#cartesian-multipole-expansion" id="toc-cartesian-multipole-expansion" class="nav-link" data-scroll-target="#cartesian-multipole-expansion">Cartesian Multipole Expansion</a>
  <ul class="collapse">
  <li><a href="#derivation" id="toc-derivation" class="nav-link" data-scroll-target="#derivation">Derivation</a></li>
  <li><a href="#monopole-moment" id="toc-monopole-moment" class="nav-link" data-scroll-target="#monopole-moment">Monopole Moment</a></li>
  <li><a href="#dipole-moment" id="toc-dipole-moment" class="nav-link" data-scroll-target="#dipole-moment">Dipole Moment</a></li>
  <li><a href="#quadrupole-moment" id="toc-quadrupole-moment" class="nav-link" data-scroll-target="#quadrupole-moment">Quadrupole Moment</a></li>
  <li><a href="#higher-order-moments" id="toc-higher-order-moments" class="nav-link" data-scroll-target="#higher-order-moments">Higher-Order Moments</a></li>
  <li><a href="#charges-in-external-fields" id="toc-charges-in-external-fields" class="nav-link" data-scroll-target="#charges-in-external-fields">Charges in External Fields</a></li>
  </ul></li>
  <li><a href="#spherical-multipole-expansion" id="toc-spherical-multipole-expansion" class="nav-link" data-scroll-target="#spherical-multipole-expansion">Spherical Multipole Expansion</a>
  <ul class="collapse">
  <li><a href="#greens-function-expansion" id="toc-greens-function-expansion" class="nav-link" data-scroll-target="#greens-function-expansion">Green’s Function Expansion</a></li>
  <li><a href="#spherical-expansion" id="toc-spherical-expansion" class="nav-link" data-scroll-target="#spherical-expansion">Spherical Expansion</a></li>
  <li><a href="#relation-to-cartesian-expansion" id="toc-relation-to-cartesian-expansion" class="nav-link" data-scroll-target="#relation-to-cartesian-expansion">Relation to Cartesian Expansion</a></li>
  <li><a href="#azimuthally-symmetric-distributions" id="toc-azimuthally-symmetric-distributions" class="nav-link" data-scroll-target="#azimuthally-symmetric-distributions">Azimuthally Symmetric Distributions</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/multipole-expansion.html"><span class="chapter-title">Multipole Expansion</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Multipole Expansion</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p>In this last chapter on electrostatics, we will conclude our discussion of boundary value problems by discussing briefly the applications of complex methods to solving Laplace’s equation in two dimensions. We will then move on to the discussion of the multipole expansion of electrostatics, a way to obtain approximate solutions to electrostatics problems. The idea of a multipole expansion turns out to be very useful not just in electrostatics, but in all of electromagnetism. We’ll see extensions of these ideas to other areas of electromagnetism in future chapters.</p>
<section id="complex-methods" class="level2">
<h2 class="anchored" data-anchor-id="complex-methods">Complex Methods</h2>
<p>In many cases we find ourselves interested in boundary value problems that can be reduced to two dimensions. For example, if the symmetry of a problem dictates that the potential cannot depend on the <span class="math inline">\(z\)</span>-coordinate, we can write <span class="math inline">\(\phi(\mathbf{x}) = \phi(x,y)\)</span>, which reduces the problem to a two dimensional problem in the <span class="math inline">\(xy\)</span>-plane.</p>
<p>While the techniques we’ve covered so far we’ll often work in this setting, there’s another technique that can be used to solve more difficult problems that employs the tools of complex analysis, particular the theory of analytic functions and conformal mappings. We covered the mathematical background of this subject in the appendix. It’s recommend that the reader read that material before proceeding further with this section.</p>
<section id="complex-potential" class="level3">
<h3 class="anchored" data-anchor-id="complex-potential">Complex Potential</h3>
<p>Suppose <span class="math inline">\(\phi(\mathbf{x}) = \phi(x,y)\)</span> is the 2-dimensional scalar potential for some boundary value problem free of source charges. Then we know that the potential must satisfy Laplace’s equation <span class="math inline">\(\nabla^2 \phi = 0\)</span> inside the boundary region. We know from the appendix that any harmonic function in two dimensions can be thought of as the real part of some analytic function in the complex plane.</p>
<p>We can thus use the potential <span class="math inline">\(\phi(x,y)\)</span> to define a complex-valued analytic function <span class="math inline">\(F(z)\)</span> of the form <span class="math display">\[
F(z) = \phi(x,y) + i \psi(x,y) \ ,
\]</span> where <span class="math inline">\(z = x + i y\)</span> is a complex variable whose real part is <span class="math inline">\(x\)</span> and whose imaginary part is <span class="math inline">\(y\)</span>, and <span class="math inline">\(\psi(x,y)\)</span> is the <em>harmonic conjugate</em> of the potential. We call <span class="math inline">\(F(z)\)</span> the <em>complex potential</em>, and <span class="math inline">\(\psi(x,y)\)</span> the <em>stream function</em>.</p>
<p>Since <span class="math inline">\(F(z)\)</span> is analytic inside the boundary region, we know that it must satisfy the Cauchy-Riemann equations in this region, <span class="math display">\[
\frac{\partial \phi}{\partial x} = \frac{\partial \psi}{\partial y} \quad , \quad
\frac{\partial \phi}{\partial y} = -\frac{\partial \psi}{\partial x} \ .
\]</span> Moreover, the potential <span class="math inline">\(\phi(x,y)\)</span> and the stream function <span class="math inline">\(\psi(x,y)\)</span> must each satisfy Laplace’s equation inside the boundary region, <span class="math display">\[
\nabla^2 \phi(x,y) = 0 \quad , \quad \nabla^2 \psi(x,y) = 0 \ .
\]</span> Since the stream function is the harmonic conjugate of the potential, we can express it formally as a function of the potential by <span class="math display">\[
\psi(x,y) = -\int dx \ \frac{\partial \phi}{\partial y} + \int dy \ \frac{\partial \phi}{\partial x} \ .
\]</span> Indeed, this relationship follows directly from the Cauchy-Riemann equations. This means that the stream function is completely determined by the potential, up to additive constants.</p>
<p>We also know that the level curves of <span class="math inline">\(\phi(x,y)\)</span>, i.e.&nbsp;the equipotentials, must be perpendicular to the level curves of <span class="math inline">\(\psi(x,y)\)</span> in this region, or equivalently <span class="math inline">\(\nabla \phi \cdot \nabla \psi = 0\)</span>. This lets us assign meaning to the stream function. The level curves of the stream function represent the direction of flow of electric field lines. To see why this is true, observe we can take the gradient of <span class="math inline">\(\psi(x,y)\)</span> and express it directly in terms of the electric field <span class="math inline">\(\mathbf{E} = -\nabla \phi\)</span> using the Cauchy-Riemann equations. We have <span class="math display">\[
\nabla \psi = \frac{\partial \psi}{\partial x} \mathbf{e}_x + \frac{\partial \psi}{\partial y} \mathbf{e}_y = -\frac{\partial \phi}{\partial y} \mathbf{e}_x + \frac{\partial \phi}{\partial x} \mathbf{e}_y = E_y \mathbf{e}_x - E_x \mathbf{e}_y \ .
\]</span> That is, we have <span class="math display">\[
\mathbf{E}(x,y) = \frac{\partial \psi}{\partial y} \mathbf{e}_x - \frac{\partial \psi}{\partial x} \mathbf{e}_y \ .
\]</span> Since <span class="math inline">\(\nabla \psi\)</span> is perpendicular to the level curves of <span class="math inline">\(\psi(x,y)\)</span>, and since <span class="math inline">\(\mathbf{E} \cdot \nabla \psi = 0\)</span>, it must be the case that the electric field lines point along the level curves of the stream function.</p>
<p>We can also express the electric field directly in terms of a the complex derivative of the complex potential <span class="math inline">\(F(z)\)</span>. Using the properties of complex derivatives, we can write <span class="math display">\[
\frac{dF}{dz} = \frac{\partial \phi}{\partial x} - i \frac{\partial \phi}{\partial y} = -E_x + i E_y \ .
\]</span> Notice if we then take the negative complex conjugate of this derivative, we get a function whose real and imaginary parts are the components of the electric field, <span class="math display">\[
-\bigg(\frac{dF}{dz}\bigg)^* = E_x + i E_y \ .
\]</span> This is just the complex equivalent of the statement that the electric field is the negative gradient of the potential.</p>
<section id="example-complex-potential-of-an-infinite-uniformly-charged-wire" class="level5">
<h5 class="anchored" data-anchor-id="example-complex-potential-of-an-infinite-uniformly-charged-wire">Example: Complex potential of an infinite uniformly charged wire</h5>
<p>Consider again an infinitely long wire of uniform charge line density <span class="math inline">\(\lambda\)</span> oriented along the <span class="math inline">\(z\)</span>-axis. We know the electric field is given in cylindrical coordinates by <span class="math display">\[
\mathbf{E}(\mathbf{x}) = \frac{2\lambda}{\varrho} \mathbf{e}_\varrho \ ,
\]</span> which implies that the potential is <span class="math display">\[
\phi(\mathbf{x}) = -2\lambda \log\varrho \ .
\]</span> We’d like to find the complex potential <span class="math inline">\(F(z)\)</span> for this wire in the <span class="math inline">\(xy\)</span>-plane. We can then write the ordinary potential in the form <span class="math display">\[
\phi(x,y) = -\lambda \log(x^2 + y^2) \ .
\]</span> Away from the wire, the potential must satisfy Laplace’s equation <span class="math inline">\(\nabla^2 \phi(x,y) = 0\)</span>. The associated stream function <span class="math inline">\(\psi(x,y)\)</span> can most easily be found by applying the Cauchy-Riemann equations to <span class="math inline">\(\phi(x,y)\)</span>. We have <span class="math display">\[
\begin{align*}
\frac{\partial \psi}{\partial y} &amp;= \frac{\partial \phi}{\partial x} = -2\lambda \frac{x}{x^2 + y^2} \ , \\
\frac{\partial \psi}{\partial x} &amp;= -\frac{\partial \phi}{\partial y} = 2\lambda \frac{y}{x^2 + y^2} \ .
\end{align*}
\]</span> Integrating both sides of these equations, we then get <span class="math display">\[
\begin{align*}
\psi(x,y) &amp;= -2\lambda \int dy \ \frac{x}{x^2 + y^2} = -2\lambda \tan^{-1} \frac{y}{x} + c_1(x)  \ , \\
\psi(x,y) &amp;= 2\lambda \int dx \ \frac{y}{x^2 + y^2} = 2\lambda \tan^{-1} \frac{x}{y} + c_2(y)  \ .
\end{align*}
\]</span> Now, observe that we can use a trig identity to write <span class="math display">\[
\tan^{-1} \frac{x}{y} = \frac{\pi}{2} - \tan^{-1} \frac{y}{x} \ .
\]</span> This means we must have <span class="math display">\[
\psi(x,y) = -2\lambda \tan^{-1} \frac{y}{x} + c_1(x) = 2\lambda \bigg(\frac{\pi}{2} - \tan^{-1} \frac{y}{x}\bigg) + c_2(y) \ .
\]</span> For these equations to be consistent, we require that <span class="math inline">\(c_1(x)\)</span> and <span class="math inline">\(c_2(y)\)</span> both be constant, with <span class="math inline">\(c_1 = \pi\lambda + c_2\)</span>. Any choice of constants will work so long as this equation is satisfied. We’ll choose <span class="math inline">\(c_1=0\)</span>, so that the stream function can be written <span class="math display">\[
\psi(x,y) = -2\lambda \tan^{-1} \frac{y}{x} \ .
\]</span> This means the complex potential is then <span class="math display">\[
F(z) = \phi(x,y) + i \psi(x,y) = -\lambda \log(x^2 + y^2) - i \ 2\lambda \tan^{-1} \frac{y}{x} \ .
\]</span> We can rewrite this as an explicit function of <span class="math inline">\(z = x+iy\)</span> by observing that in polar coordinates we have <span class="math display">\[
\log z = \log |z| e^{i\varphi} = \log(|z|) + i \varphi = \frac{1}{2} \log(x^2 + y^2) + i \tan^{-1} \frac{y}{x} \ .
\]</span> Plugging this into the complex potential and simplifying, we finally get <span class="math display">\[
F(z) = -2 \lambda \log z \ .
\]</span> Surprisingly, the complex potential looks almost identical to the ordinary potential, except with <span class="math inline">\(\varrho\)</span> replaced by <span class="math inline">\(z\)</span>.</p>
<p>It’s worth mentioning another interesting fact. Notice that in calculating the complex potential for the wire that we’re only looking at the projection of the wire onto the <span class="math inline">\(xy\)</span>-plane. Since the wire is oriented along the <span class="math inline">\(z\)</span>-axis, its projection must be a point charge. This means that the complex potential of a point charge in two dimensions is exactly the same as the complex potential of an infinitely long wire. Indeed, the 2-dimensional Green’s function for a point charge <span class="math inline">\(q\)</span> at the origin is <span class="math inline">\(G(\mathbf{x}) = -2 \log \varrho\)</span>, which means its potential is <span class="math inline">\(\phi(\mathbf{x}) = -2q \log\varrho\)</span>. If we thus set <span class="math inline">\(q = \lambda\)</span> then the two potentials are evidently identical.</p>
</section>
</section>
<section id="conformal-mappings" class="level3">
<h3 class="anchored" data-anchor-id="conformal-mappings">Conformal Mappings</h3>
<p>Now, recall that we can also think of any complex function as a geometric transformation acting on the complex plane. That is, any complex function <span class="math inline">\(w = T(z)\)</span> can be thought of as mapping points <span class="math inline">\(z = x + iy\)</span> in the <span class="math inline">\(z\)</span>-plane to points <span class="math inline">\(w = u+iv\)</span> in the <span class="math inline">\(w\)</span>-plane. When <span class="math inline">\(T(z)\)</span> is analytic in some region of the <span class="math inline">\(z\)</span>-plane, these transformations are called <em>conformal mappings</em>. Conformal mappings can be shown to preserve the angles between curves under mapping. Moreover, under a conformal mapping the area element <span class="math inline">\(da = dxdy\)</span> merely gets rescaled to a new area element <span class="math inline">\(da' = dudv\)</span> by <span class="math display">\[
du dv = \bigg|\frac{dw}{dz}\bigg|^2 dxdy \ .
\]</span> Most importantly for our purposes, conformal mappings preserve harmonic functions. That is, if <span class="math inline">\(\phi(u,v)\)</span> is some function that satisfies Laplace’s equation in the <span class="math inline">\(w\)</span>-plane, then <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span> satisfies Laplace’s equation in the original <span class="math inline">\(z\)</span>-plane, and the boundary conditions are preserved under the transformation <span class="math inline">\(w = T(z)\)</span>.</p>
<p>Let’s first prove the first part. Suppose <span class="math inline">\(\phi(u,v)\)</span> is harmonic in some region of the <span class="math inline">\(w\)</span>-plane, meaning inside this region it satisfies Laplace’s equation with respect to <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, <span class="math display">\[
\frac{\partial^2 \phi}{\partial u^2} + \frac{\partial^2 \phi}{\partial v^2} = 0 \ .
\]</span> Since <span class="math inline">\(\phi(u,v)\)</span> is harmonic, it must be the real part of some analytic function <span class="math inline">\(F(w) = \phi(u,v) + i\psi(u,v)\)</span> in the <span class="math inline">\(w\)</span>-plane. And since the composition of analytic functions is also analytic, then the function <span class="math display">\[
F(T(z)) = \phi\big(u(x,y), v(x,y)\big) + i \psi\big(u(x,y), v(x,y)\big)
\]</span> must also be analytic in some region of the <span class="math inline">\(z\)</span>-plane. In particular, this means the function <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span> must also be harmonic in this region of the <span class="math inline">\(z\)</span>-plane, hence satisfying Laplace’s equation with respect to <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, <span class="math display">\[
\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} = 0 \ .
\]</span> We’ll now prove the second part, namely that conformal mappings preserve the boundary conditions. We’ll focus on the usual cases where we have Dirichlet or Neumann boundary conditions. The mixed boundary condition case follows from these.</p>
<p>Suppose <span class="math inline">\(\mathcal{C}_z\)</span> is some smooth curve in the <span class="math inline">\(z\)</span>-plane that under the conformal mapping <span class="math inline">\(w=T(z)\)</span> maps to another smooth curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane. Suppose first that <span class="math inline">\(\phi(u,v) = \phi_0\)</span> is constant along the curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane. Clearly then, we have <span class="math display">\[
\phi(x,y) = \phi\big(u(x,y), v(x,y)\big) = \phi_0 \ .
\]</span> That is, <span class="math inline">\(\phi(x,y)\)</span> will also be constant along the curve <span class="math inline">\(\mathcal{C}_z\)</span> in the <span class="math inline">\(z\)</span>-plane. This proves that Dirichlet boundary conditions are preserved under a conformal mapping.</p>
<p>Suppose next that <span class="math inline">\(\partial \phi / \partial n_w = 0\)</span> along the curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane, where <span class="math inline">\(\mathbf{n}_w\)</span> is the normal vector to this curve. Since <span class="math display">\[
\frac{\partial \phi}{\partial n_w} = \nabla \phi(u,v) \cdot \mathbf{n}_w = 0 \ ,
\]</span> this can only be true if the curve <span class="math inline">\(\mathcal{C}_w\)</span> is perpendicular to the level curves of <span class="math inline">\(\phi(u,v)\)</span> in the <span class="math inline">\(w\)</span>-plane. However, the level curves of <span class="math inline">\(\phi(u,v)\)</span> are the same as the level curves of <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span>, since constants get mapped to constants under the conformal mapping. This means in the <span class="math inline">\(z\)</span>-plane that the level curves of <span class="math inline">\(\phi(x,y)\)</span> will again be perpendicular to the curve <span class="math inline">\(\mathcal{C}_z\)</span>. That is, if <span class="math inline">\(\mathbf{n}_z\)</span> is the normal vector to the curve <span class="math inline">\(\mathcal{C}_z\)</span> we must have <span class="math display">\[
\frac{\partial \phi}{\partial n_z} = \nabla \phi\big(u(x,y), v(x,y)\big) \cdot \mathbf{n}_z = 0 \ .
\]</span> This proves that Neumann boundary conditions are preserved under a conformal mapping. By combining these results together, it’s possible to show that mixed boundary conditions are also preserved under conformal mappings.</p>
</section>
<section id="d-boundary-value-problems" class="level3">
<h3 class="anchored" data-anchor-id="d-boundary-value-problems">2D Boundary Value Problems</h3>
<p>The results of the previous section mean that, given some conformal mapping, we essentially have a duality between BVPs in the <span class="math inline">\(xy\)</span>-plane and BVPs in the <span class="math inline">\(uv\)</span>-plane. If we can somehow find such a conformal mapping that simplifies the problem so that it’s much easier to solve in the new space using any of the techniques we’ve covered so far, we can map it back to get the potential that solves the original BVP.</p>
<p>Of course, the challenging part is finding a conformal mapping <span class="math inline">\(w = T(z)\)</span> that simplifies the given problem. There’s an art to this, involving looking at the geometry of the original problem and using that to identify a good transformation that makes the problem easier to solve in a new space. This is best shown by example.</p>
<p>Let’s start with a relatively simple BVP that we can solve using methods we’ve already covered.</p>
<section id="example-long-hollow-cylinder-held-at-two-different-potentials" class="level5">
<h5 class="anchored" data-anchor-id="example-long-hollow-cylinder-held-at-two-different-potentials">Example: Long hollow cylinder held at two different potentials</h5>
<p>Suppose an infinitely long hollow cylinder of radius <span class="math inline">\(R\)</span> is such that exactly half of the circular cross-section of the cylinder is held at a constant potential <span class="math inline">\(V\)</span>, while the other half is grounded. We’ll assume each half of the cylinder is separated by a very thin insulating sheet. We’ll assume that no other source charges are present inside our outside the cylinder. We’re interested in finding the potential at each point inside of the cylinder.</p>
<p>FIGURE (show cylinder with given potentials)</p>
<p>Inside the cylinder the potential must satisfy Laplace’s equation. We’ll formulate this problem as a BVP in Cartesian coordinates, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(x,y) = 0 \ , \\
\text{where} \ \phi(x,y) = 0 \ \text{when} \ x^2+y^2 = R^2 \ \text{and} \ x &gt; 0  \ , \\
\text{and} \ \phi(x,y) = V \ \text{when} \ x^2+y^2 = R^2 \ \text{and} \ x &lt; 0 \ .
\end{cases}
\end{align*}
\]</span> We’ll solve this problem two different ways to show that the results agree, first using separation of variables, and second using conformal mappings.</p>
<p>First, recall from the previous chapter that any BVP with cylindrical symmetry, as this problem does, has a solution in cylindrical coordinates of the form <span class="math display">\[
\phi(\varrho,\varphi) = a_0 + b_0 \log\varrho + \sum_{n=1}^\infty \big[(a_n \cos n\varphi + b_n \sin n\varphi)\varrho^n + (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n}\big] \ .
\]</span> For the potential to stay finite inside the cylinder we require that <span class="math inline">\(b_0 = c_n = d_n = 0\)</span>. What remains then is a Fourier series, <span class="math display">\[
\phi(\varrho,\varphi) = a_0 + \sum_{n=1}^\infty (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n} \ .
\]</span> The coefficients can be found using standard Fourier series methods. By applying the boundary conditions, one can show that <span class="math inline">\(a_0 =V/2\)</span>, <span class="math inline">\(a_n=0\)</span> for all <span class="math inline">\(n\)</span>, and <span class="math inline">\(b_n=0\)</span> for all even <span class="math inline">\(n\)</span>, while for odd <span class="math inline">\(n\)</span> we have <span class="math display">\[
b_n = -\frac{2V}{n\pi R^n} \quad , \quad n=1,3,5,\cdots \ .
\]</span> Plugging these in, we get <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{2V}{\pi} \sum_{n=1,3,5,\cdots} \bigg(\frac{\varrho}{R}\bigg)^n \frac{\sin n\varphi}{n} \ .
\]</span> It turns out this solution can also be written in closed form by using the Taylor expansion of the arctangent function. We get <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{V}{\pi} \tan^{-1} \frac{2R\varrho \sin\varphi}{R^2 - \varrho^2} \ .
\]</span> Let’s now show that we get the same result using conformal mappings. Since the problem is cylindrically symmetric, we know that the solution must only depend on <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Suppose then that we seek a potential <span class="math inline">\(\phi(x,y)\)</span>, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the real and imaginary components of a complex variable <span class="math inline">\(z\)</span>. Our goal is to find a conformal mapping <span class="math inline">\(w = T(z)\)</span> that makes <span class="math inline">\(\phi(u,v)\)</span> especially easy to write down in the <span class="math inline">\(w\)</span>-plane. To that end, consider the following conformal mapping, <span class="math display">\[
w = -i \frac{z-R}{z+R} \ .
\]</span> By writing <span class="math inline">\(w = u(x,y) + iv(x,y)\)</span> and simplifying this expression, it’s not hard to show that <span class="math display">\[
u = \frac{2Ry}{(x+R)^2 + y^2} \quad , \quad v = \frac{R^2 - x^2 - y^2}{(x+R)^2 + y^2} \ .
\]</span> To see why this is a useful conformal mapping to consider, let’s look at how the boundary cylinder transforms under the transformation. In the <span class="math inline">\(z\)</span>-plane, the boundary cylinder can be parametrized by <span class="math inline">\(z(\varphi) = R e^{i\varphi}\)</span>, where <span class="math inline">\(-\pi \leq \varphi \leq \pi\)</span>. Under the transformation <span class="math inline">\(w=T(z)\)</span>, the cylinder transforms to a curve in the <span class="math inline">\(w\)</span>-plane of the form <span class="math display">\[
w(\varphi) = -i \frac{z(\varphi)-R}{z(\varphi)+R} = -i \frac{R e^{i\varphi}-R}{R e^{i\varphi}+R} = -i \frac{e^{i\varphi}-1}{e^{i\varphi}+1} \ .
\]</span> By multiplying the numerator and denominator by <span class="math inline">\((e^{i\varphi}+1)^* = e^{-i\varphi}+1\)</span> and simplifying, it’s not hard to show that <span class="math display">\[
w(\varphi) = \frac{\sin\varphi}{1 + \cos\varphi} = \tan \frac{\varphi}{2} \ .
\]</span> This means the cylinder transforms to the curve <span class="math inline">\(u(\varphi) = \tan \varphi / 2\)</span> and <span class="math inline">\(v(\varphi) = 0\)</span> in the <span class="math inline">\(w\)</span>-plane. Clearly this is just the real axis in the <span class="math inline">\(w\)</span>-plane. When <span class="math inline">\(-\pi &lt; \varphi &lt; 0\)</span> the curve runs from <span class="math inline">\(u=-\infty\)</span> to <span class="math inline">\(u=0\)</span>, and when <span class="math inline">\(0 &lt; \varphi &lt; \pi\)</span> the curve runs from <span class="math inline">\(u=0\)</span> to <span class="math inline">\(u=\infty\)</span>. What we’ve managed to do with this conformal mapping is transform the surface of the cylinder in the <span class="math inline">\(z\)</span>-plane into the <span class="math inline">\(u\)</span>-axis in the <span class="math inline">\(w\)</span>-plane. Moreover, the interior of the cylinder in the <span class="math inline">\(z\)</span>-plane gets mapped to the upper half of the <span class="math inline">\(w\)</span>-plane.</p>
<p>What about the boundary conditions? If <span class="math inline">\(\phi(x,y) = 0\)</span> on the cylinder when <span class="math inline">\(x &gt; 0\)</span>, under the conformal mapping we must have <span class="math inline">\(\phi(u,0) = 0\)</span> when <span class="math inline">\(u &gt; 0\)</span>. Similarly, if <span class="math inline">\(\phi(x,y) = V\)</span> on the cylinder when <span class="math inline">\(x &lt; 0\)</span>, we must have <span class="math inline">\(\phi(u,0) = V\)</span> when <span class="math inline">\(u &lt; 0\)</span>. The points <span class="math inline">\(x = \pm R\)</span> in the <span class="math inline">\(z\)</span>-plane where these two parts of the cylinder joint both map to <span class="math inline">\(w = 0\)</span>. In the figure below we show a visualization of this mapping, including the boundary conditions.</p>
<p>FIGURE (show this conformal mapping with BCs included)</p>
<p>We now have an equivalent BVP to solve in the <span class="math inline">\(w\)</span>-plane, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(u,v) = 0 \ , \\
\text{where} \ \phi(u,0) = 0 \ \text{when} \ u &gt; 0 \ , \\
\text{and} \ \phi(u,0) = V \ \text{when} \ u &lt; 0 \ .
\end{cases}
\end{align*}
\]</span> So how do we find such a potential? The trick is to find a function <span class="math inline">\(\phi(w) = \phi(u,v)\)</span> that’s analytic in the upper half-plane while also satisfying the boundary conditions. If the function is analytic we know it must satisfy Laplace’s equation, and if it satisfies the boundary conditions we know it must be the unique solution. To that end, let’s try to guess a solution. Consider the function <span class="math display">\[
\phi(w) = \frac{V}{\pi} \text{Arg} \ w \ ,
\]</span> where <span class="math inline">\(\text{Arg} \ w\)</span> is the phase of <span class="math inline">\(w\)</span>, or equivalently the angle of the point <span class="math inline">\(w = u+iv\)</span> in the <span class="math inline">\(w\)</span>-plane relative to the positive <span class="math inline">\(u\)</span>-axis. First, notice that <span class="math inline">\(\phi(w)\)</span> satisfies the boundary conditions, since <span class="math inline">\(\text{Arg} \ w = 0\)</span> along the positive <span class="math inline">\(u\)</span>-axis and <span class="math inline">\(\text{Arg} \ w = \pi\)</span> along the negative <span class="math inline">\(u\)</span>-axis. Moreover, the function is analytic in the upper half plane <span class="math inline">\(v &gt; 0\)</span> since <span class="math inline">\(f(w) = \text{Arg} \ w\)</span> is analytic when <span class="math inline">\(v &gt; 0\)</span>. This guarantees that <span class="math inline">\(\phi(w) = \phi(u,v)\)</span> satisfies Laplace’s equation in the upper half plane. By the uniqueness theorem then, this must be the unique solution that solves the given BVP in the <span class="math inline">\(w\)</span>-plane.</p>
<p>We now need only transform back to the <span class="math inline">\(z\)</span>-plane to get the original potential <span class="math inline">\(\phi(x,y)\)</span> we seek. To do this we need to express the phase <span class="math inline">\(\text{Arg} \ w\)</span> as a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Since the phase of a product is the sum of their phases, we have <span class="math display">\[
\text{Arg} \ w = \text{Arg} \bigg(-i \frac{z-R}{z+R}\bigg) = \text{Arg} \ i - \text{Arg} \ \frac{z-R}{z+R} \ .
\]</span> Now, <span class="math inline">\(\text{Arg} \ i = \pi/2\)</span>, and the phase of the second term is just the arctangent of its imaginary part divided by its real part, which turns out to be given by <span class="math display">\[
\text{Arg} \ \frac{z-R}{z+R} = \tan^{-1} \frac{2yR}{R^2 - x^2 - y^2} \ .
\]</span> Plugging this back into the potential, we have <span class="math display">\[
\phi(x,y) = \frac{V}{\pi} \bigg[\frac{\pi}{2} - \tan^{-1} \frac{2yR}{R^2 - x^2 - y^2}\bigg] \ .
\]</span> Or, expressed in cylindrical coordinates, we have <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{V}{\pi} \tan^{-1} \frac{2R \varrho\sin\varphi}{R^2 - \varrho^2} \ .
\]</span> This is of course exactly the result we found above using separation of variables. It’s fair to ask if the use of complex methods made this problem any easier than just using separation of variables. In one sense, we replaced the need to solve a PDE with the algebra of complex variables. But in another sense we needed to be a lot more clever. For complex methods to be useful we need to be able to guess a conformal mapping that simplifies the problem. In this case we were able to do that, but it’s not always so obvious how to even find such a mapping. There are, however, problems that are much harder to solve using other methods where complex methods happen to be quite helpful. We’ll see an example of this next.</p>
</section>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example:</h5>
<ul>
<li>Work capacitor example or something just as complex.</li>
</ul>
</section>
</section>
</section>
<section id="cartesian-multipole-expansion" class="level2">
<h2 class="anchored" data-anchor-id="cartesian-multipole-expansion">Cartesian Multipole Expansion</h2>
<p>We will now turn our attention away from boundary value problems and consider again the problem of a localized charge distribution sitting somewhere in space, free of boundary surfaces like conductors or whatever. We know that in this setting we can formally express the potential as an integral <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \frac{\rho(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> The hard part is actually solving this integral for a general charge distribution <span class="math inline">\(\rho(\mathbf{x}')\)</span>. It would be nice then if we could find a systematic way to approximate the potential as a series in inverse powers of the distance of the field point from the charge distribution. Provided we can find such an expansion, we can often find a good approximate solution when we’re far away from the source charges by considering the first few expansion terms. This sort of expansion is called a <em>multipole expansion</em>.</p>
<section id="derivation" class="level3">
<h3 class="anchored" data-anchor-id="derivation">Derivation</h3>
<p>Based on intuition and past examples, we expect that very far away from the charge distribution the potential should be approximately that of a point charge, falling off like <span class="math inline">\(1/r\)</span> when <span class="math inline">\(r \gg r'\)</span>. But we’ve also seen potentials that fall off like <span class="math inline">\(1/r^2\)</span> as well. In fact, we can find charge distributions with potentials that fall off like <span class="math inline">\(1/r^n\)</span> for <em>any</em> positive integer <span class="math inline">\(n\)</span>.</p>
<p>Since the only part of the integrand that depends on the field point <span class="math inline">\(\mathbf{x}\)</span> is the Green’s function <span class="math inline">\(G(\mathbf{x} - \mathbf{x}')\)</span>, it suffices to find an expression of the Green’s function in powers of <span class="math inline">\(1/r\)</span>. Provided we can do this, we can plug the expansion back into the integral formula for the potential and get an expansion for the potential in powers of <span class="math inline">\(1/r\)</span>.</p>
<p>Assuming a scalar field <span class="math inline">\(f(\mathbf{x})\)</span> is infinitely differentiable at some point <span class="math inline">\(\mathbf{x}=\mathbf{x}_0\)</span>, we can Taylor expand the function about this point. It’s not hard to see using index notation that this expansion will take the following form, <span class="math display">\[
f(\mathbf{x}) = \sum_{n=0}^\infty \frac{1}{n!} (\mathbf{x} \cdot \nabla)^n f(\mathbf{x}_0) = f(\mathbf{x}_0) + \mathbf{x} \cdot \nabla f(\mathbf{x}_0) + \frac{1}{2} x_i x_j \frac{\partial^2 f}{\partial x_j \partial x_i} \bigg|_{\mathbf{x}=\mathbf{x}_0} + \cdots \ .
\]</span> We’d like to now Taylor expand the Green’s function <span class="math inline">\(G(\mathbf{x} - \mathbf{x}')\)</span>, assuming <span class="math inline">\(\mathbf{x}'\)</span> is the expansion variable and <span class="math inline">\(\mathbf{x}\)</span> is the expansion point of interest. It’s not hard to see this will be given by <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} (\mathbf{x}' \cdot \nabla)^\ell G(\mathbf{x}) = G(\mathbf{x}) - \mathbf{x}' \cdot \nabla G(\mathbf{x}) + \frac{1}{2} x_i' x_j' \frac{\partial^2 G}{\partial x_j \partial x_i} + \cdots \ .
\]</span> If we now let <span class="math inline">\(G(\mathbf{x} - \mathbf{x}') = 1/|\mathbf{x} - \mathbf{x}'|\)</span>, then <span class="math inline">\(G(\mathbf{x}) = 1/r\)</span>, and so we can write <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} (\mathbf{x}' \cdot \nabla)^\ell \frac{1}{r} = \frac{1}{r} - \mathbf{x}' \cdot \nabla \frac{1}{r} + \frac{1}{2} x_i x_j \frac{\partial^2}{\partial x_j \partial x_i} \frac{1}{r} + \cdots \ .
\]</span> Now, we already know <span class="math inline">\(\nabla 1/r = -\mathbf{x} / r^3\)</span>. Moreover, notice that <span class="math display">\[
x_i' x_j' \frac{\partial^2}{\partial x_j \partial x_i} \frac{1}{r} = x_i' x_j' \frac{\partial^2}{\partial x_j \partial x_i} (x_k x_k)^{-1/2} = x_i' x_j' \frac{3 x_i x_j - r^2 \delta_{ij}}{r^5} \ .
\]</span> Up to the quadratic term, we can thus expand the Green’s function in vector notation as <span class="math display">\[
\boxed{
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} + \frac{\mathbf{x} \cdot \mathbf{x}'}{r^3} + \frac{3 (\mathbf{x} \cdot \mathbf{x}')^2 - r^2 r'^2}{2r^5} + \cdots
} \ .
\]</span> We’ve thus managed to expand the Green’s function in powers of <span class="math inline">\(1/r\)</span>, at least up to the cubic term. We could keep going if we like. In fact the expansion above is just a binomial expansion, so it’s not difficult. We’ll defer the full expansion to later.</p>
<p>Plugging this Green’s function expansion back into the integral for the potential, we get <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[\frac{1}{r} + \frac{\mathbf{x} \cdot \mathbf{x}'}{r^3} + \frac{3 (\mathbf{x} \cdot \mathbf{x}')^2 - r^2 r'^2}{2r^5} + \cdots\bigg] \ .
\]</span> Notice that, apart from the quadratic term, we can group the source-dependent terms together inside each integral to write <span class="math display">\[
\phi(\mathbf{x}) = \frac{1}{r} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') + \frac{\mathbf{x}}{r^3} \cdot \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' + \frac{1}{2r^5} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') [3 (\mathbf{x} \cdot \mathbf{x}')^2 - r^2 r'^2] + \cdots \ .
\]</span> The fact that the integrals of the first two terms depend only on the source suggests we give those a name. The first integral, which is evidently just the total charge of the distribution, we’ll call the <em>monopole moment</em> <span class="math inline">\(q\)</span>, <span class="math display">\[
q \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \ .
\]</span></p>
<p>Notice that this means the first expansion term is just <span class="math inline">\(q/r\)</span>, which agrees with our prior intuition that a charge distribution should act as a point charge in the far field limit, so long as <span class="math inline">\(q \neq 0\)</span>. Its corrections will just be the next expansion terms.</p>
<p>The second integral is evidently a vector depending only on the source distribution. We’ll call it the <em>dipole moment</em> <span class="math inline">\(\mathbf{p}\)</span>, <span class="math display">\[
\mathbf{p} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' \ .
\]</span> In its current form the third integral doesn’t depend solely on the sources. We’ll deal with that later. For now, just note that we can express this third term in the form <span class="math display">\[
\frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} = \frac{x_i x_j Q_{ij}}{2r^5} \ ,
\]</span> where <span class="math inline">\(\mathbf{Q}\)</span> is a rank-2 tensor called the <em>quadrupole moment</em> whose components are given by <span class="math display">\[
Q_{ij} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') [3 x_i' x_j' - r'^2 \delta_{ij}] \ .
\]</span> All of these moments are called <em>multipole moments</em>. We’ll explain the physical meaning behind each of these in more detail in the following sections. For now, just note that using these multipole moments we can re-write the potential expansion in the form <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \frac{q}{r} + \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} + \frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} + \cdots
} \ .
\]</span> This is the Cartesian <em>multipole expansion</em>. Let’s now look more deeply at each of these expansion terms one by one.</p>
</section>
<section id="monopole-moment" class="level3">
<h3 class="anchored" data-anchor-id="monopole-moment">Monopole Moment</h3>
<p>Substituting in the monopole moment <span class="math inline">\(q\)</span>, we can write the first term in the multipole expansion simply as <span class="math display">\[
\boxed{
\phi^{(0)}(\mathbf{x}) = \frac{q}{r}
} \ .
\]</span> This is called the <em>monopole potential</em>. Clearly it falls off like <span class="math inline">\(1/r\)</span>. Recall the monopole moment <span class="math inline">\(q\)</span> is given by <span class="math display">\[
\boxed{
q \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') }
\ .
\]</span> Evidently, the monopole moment represents the <em>total net charge</em> of the distribution.</p>
<p>Since the electric field is <span class="math inline">\(\mathbf{E}^{(0)} = -\nabla \phi^{(0)}\)</span>, the <em>monopole field</em> <span class="math inline">\(\mathbf{E}^{(0)}\)</span>will be given by Coulomb’s Law, with <span class="math display">\[
\mathbf{E}^{(0)}(\mathbf{x}) \equiv \frac{q}{r^2} \mathbf{x} \ .
\]</span> The field lines for the monopole look exactly as we’d expect. We show a plot of these field lines below to compare with the field lines of the higher order multipole terms in the next few sections. As usual, the field lines are assume to point outward for a positive point charge, and inward for a negative point charge.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241108234730808.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Naturally, the best physical model of the monopole moment is just a point charge <span class="math inline">\(q\)</span> centered at the origin, which exactly reproduces the field lines shown above.</p>
<p>Since this is the first term in the multipole expansion, we should expect that very far away from the charge distribution, the potential should approximate the of a point charge with total net charge <span class="math inline">\(q\)</span>. Of course, this is only true if <span class="math inline">\(q \neq 0\)</span>. If <span class="math inline">\(q=0\)</span>, we have to proceed to the next term in the multipole expansion for a good approximation, the dipole potential.</p>
</section>
<section id="dipole-moment" class="level3">
<h3 class="anchored" data-anchor-id="dipole-moment">Dipole Moment</h3>
<p>Substituting in the definition for the second multipole moment <span class="math inline">\(\mathbf{p}\)</span>, we can write the second term in the multipole expansion as <span class="math display">\[
\boxed{
\phi^{(1)}(\mathbf{x}) \equiv \frac{\mathbf{p} \cdot \mathbf{x}}{r^3}
} \ .
\]</span> We call this expansion term the <em>dipole potential</em>. This potential falls off like <span class="math inline">\(1/r^2\)</span>. The dipole moment <span class="math inline">\(\mathbf{p}\)</span> is a <em>vector</em> given by</p>
<p><span class="math display">\[
\mathbf{p} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' \ .
\]</span> Notice that the dipole moment, like all multipole moments, depends <em>only</em> on the source charges. It does not depend at all on the field point. Thus, the dipole moment captures all relevant information about the source charges in this expansion term. As defined, the dipole moment evidently has dimensions of charge times distance. In particular, this means we should always expect the components of the dipole moment to go like <span class="math inline">\(qd\)</span>, where <span class="math inline">\(d\)</span> is some characteristic length scale.</p>
<p>By writing <span class="math inline">\(\mathbf{E}^{(1)} = -\nabla \phi^{(1)}\)</span> in index notation and plugging in the dipole potential above, while keeping in mind that <span class="math inline">\(\mathbf{p}\)</span> doesn’t depend on <span class="math inline">\(\mathbf{x}\)</span>, one can show that the <em>dipole field</em> <span class="math inline">\(\mathbf{E}^{(1)}\)</span> can be written as <span class="math display">\[
\boxed{
\mathbf{E}^{(1)}(\mathbf{x}) \equiv \frac{3(\mathbf{p} \cdot \mathbf{x}) \mathbf{x} - r^2 \mathbf{p}}{r^5}
} \ .
\]</span> Notice that, while the dipole potential falls off like <span class="math inline">\(1/r^2\)</span> that, the dipole field falls off like <span class="math inline">\(1/r^3\)</span>, as we’d expect.</p>
<p>The field lines of the dipole field are those of a <em>pure dipole</em>, shown below. Unlike the field lines of the monopole field, the field lines of the dipole field never terminate at infinity except along the axis of the dipole moment <span class="math inline">\(\mathbf{p}\)</span>. The other field lines instead wrap back around on the source in the opposite direction.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103011630525.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<section id="example-physical-dipole" class="level5">
<h5 class="anchored" data-anchor-id="example-physical-dipole">Example: Physical dipole</h5>
<p>We want to now try to get an idea of what the dipole physically says about a charge distribution. To that end let’s consider the following simple problem. Suppose we have two opposite point charges <span class="math inline">\(+q\)</span> and <span class="math inline">\(-q\)</span> separated from each other by a distance <span class="math inline">\(d\)</span> along some axis, say the <span class="math inline">\(z\)</span>-axis to keep things simple. We’ll suppose the <span class="math inline">\(+q\)</span> charge is at the point <span class="math inline">\(\mathbf{x}_+ = d/2 \mathbf{e}_z\)</span> and the <span class="math inline">\(-q\)</span> charge is at the point <span class="math inline">\(\mathbf{x}_- = -d/2 \mathbf{e}_z\)</span>. We call this the <em>physical dipole</em>.</p>
<p>By the superposition principle, the <em>exact</em> potential of the physical dipole is given by <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q}{|\mathbf{x} - \mathbf{x}_+|} - \frac{q}{|\mathbf{x} - \mathbf{x}_-|} \\
&amp;= q\bigg[\frac{1}{\sqrt{x^2 + y^2 + (z-d/2)^2}} - \frac{1}{\sqrt{x^2 + y^2 + (z+d/2)^2}}\bigg] \ ,
\end{align*}
\]</span> and the <em>exact</em> E-field of the physical dipole is given by <span class="math display">\[
\begin{align*}
\mathbf{E}(\mathbf{x}) &amp;= q\frac{\mathbf{x} - \mathbf{x}_+}{|\mathbf{x} - \mathbf{x}_+|^3} - q\frac{\mathbf{x} - \mathbf{x}_-}{|\mathbf{x} - \mathbf{x}_-|^3} \\
&amp;= q \bigg[\frac{\mathbf{x} - d/2 \ \mathbf{e}_z}{[x^2 + y^2 + (z-d/2)^2]^{3/2}} - \frac{\mathbf{x} + d/2 \ \mathbf{e}_z}{[x^2 + y^2 + (z+d/2)^2]^{3/2}}\bigg] \ .
\end{align*}
\]</span> As formidable as this look, we can still plot the field lines numerically. Below is a plot of these field lines for the physical dipole, with the <span class="math inline">\(+q\)</span> charge shown in red and the <span class="math inline">\(-q\)</span> charge shown in blue. As always, the field lines go from positive charges to negative charges, and the equipotential curves are tangent to the field lines.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103010905701.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Compare these field lines for the physical dipole to those of the <em>pure dipole</em> field <span class="math inline">\(\mathbf{E}^{(1)}\)</span> given before. Notice that near the source charges they two fields look nothing alike, but far away from the point charges the field lines look basically the same.</p>
<p>To connect the two, let’s calculate the monopole and dipole potentials for the physical dipole. First, notice that there is no net charge since <span class="math inline">\(q-q = 0\)</span>. This means there won’t be a monopole potential contribution. We’ll thus proceed to the dipole term.</p>
<p>To find the dipole moment <span class="math inline">\(\mathbf{p}\)</span>, notice that <span class="math inline">\(\rho(\mathbf{x}') = q \delta(\mathbf{x}' - \mathbf{x}_+) - q \delta(\mathbf{x}' - \mathbf{x}_-)\)</span>, which means we have <span class="math display">\[
\mathbf{p} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' = q(\mathbf{x}_+ - \mathbf{x}_-) = qd \mathbf{e}_z \ .
\]</span> This means the dipole potential is <span class="math display">\[
\phi^{(1)}(\mathbf{x}) = \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} = \frac{qd}{r^2} \cos\theta \ .
\]</span> In the far field limit <span class="math inline">\(r \gg d\)</span> we expect that <span class="math inline">\(\phi(\mathbf{x}) \approx \phi^{(1)}(\mathbf{x})\)</span>. This can be confirmed through more effort by doing a binomial expansion of <span class="math inline">\(\phi(\mathbf{x})\)</span> in powers of <span class="math inline">\(d/r\)</span> and confirming we get the same result to leading order.</p>
<p>Is it possible to create a physical dipole whose potential is <em>exactly</em> that of the pure dipole, where <span class="math inline">\(\phi(\mathbf{x}) = \phi^{(1)}(\mathbf{x})\)</span> exactly? Sort of. Informally, we could achieve this by essentially placing the two charges right on top of each other. That is, we let <span class="math inline">\(d \to 0\)</span> while keeping the dipole moment <span class="math inline">\(|\mathbf{p}| = qd\)</span> fixed. While we can imagine doing this mathematically, physically it’s a bit non-sensical, since to let <span class="math inline">\(d \to 0\)</span> we’d also have to let <span class="math inline">\(q \to \infty\)</span> just as quickly.</p>
<p>Note that there’s nothing special about the <span class="math inline">\(z\)</span>-axis in this problem. We can orient the dipole along any axis we like. If the two opposite charges are separated by some vector <span class="math inline">\(\mathbf{d}\)</span>, their dipole moment will be <span class="math display">\[
\mathbf{p} = q \mathbf{d} \ .
\]</span> This means the dipole moment will always point along the axis of the charges, in the direction of the positive charge.</p>
<hr>
<p>In fact, we can model the dipole moment of an arbitrary charge distribution in a similar way. Suppose <span class="math inline">\(\rho(\mathbf{x}')\)</span> is some arbitrary charge distribution. If we imagine the distribution consists of a bunch of discrete point charges, each positively or negatively charged, we can decompose <span class="math inline">\(\rho(\mathbf{x}')\)</span> into a positively charge distribution <span class="math inline">\(\rho_+(\mathbf{x}')\)</span> and negatively charge distribution <span class="math inline">\(\rho_-(\mathbf{x}')\)</span> as <span class="math display">\[
\rho(\mathbf{x}') = \rho_+(\mathbf{x}') + \rho_-(\mathbf{x}') \ ,
\]</span> where <span class="math inline">\(\rho_\pm(\mathbf{x}')\)</span> is a sum over <span class="math inline">\(N_\pm\)</span> positive or negative charges <span class="math inline">\(q_i^{\pm}\)</span> located at positions <span class="math inline">\(\mathbf{x}_i^\pm\)</span>, <span class="math display">\[
\rho_\pm(\mathbf{x}') = \sum_{i=1}^{N_\pm} q_i^\pm \delta(\mathbf{x}' - \mathbf{x}_i^\pm) \ .
\]</span> We can now do an averaging process over these two distributions. The average charge <span class="math inline">\(q_\pm\)</span> of each distribution will be <span class="math display">\[
q_\pm \equiv \frac{1}{N_\pm} \sum_{i=1}^{N_\pm} q_i^\pm
\]</span> The average position of these charges will be their <em>center of charges</em> <span class="math inline">\(\mathbf{x}_\pm\)</span>, given by <span class="math display">\[
\mathbf{x}_\pm \equiv \frac{1}{N_\pm} \sum_{i=1}^{N_\pm} q_i^+ \mathbf{x}_i^\pm \ .
\]</span> This means the total net charge is <span class="math inline">\(q_+ - q_-\)</span>, and the average separation between the <span class="math inline">\(q_+\)</span> and <span class="math inline">\(q_-\)</span> is <span class="math display">\[
\mathbf{d} \equiv \mathbf{x}_+ - \mathbf{x}_- \ .
\]</span> The dipole moment of <span class="math inline">\(\rho(\mathbf{x}')\)</span> can thus also be written as <span class="math display">\[
\mathbf{p} = q_+ \mathbf{x}_+ - q_- \mathbf{x}_- \ .
\]</span> In the special case that the total net charge is zero, then <span class="math inline">\(q \equiv q_+ = -q_-\)</span>, in which case we get <span class="math inline">\(\mathbf{p} = q \mathbf{d}\)</span>, which is exactly what we derived above for the physical dipole in the far field limit. In this sense then, we can think of the dipole moment as representing the average charge polarization of a given charge distribution.</p>
</section>
<section id="example-dipole-moment-of-an-azimuthally-symmetric-hollow-sphere-of-charge" class="level5">
<h5 class="anchored" data-anchor-id="example-dipole-moment-of-an-azimuthally-symmetric-hollow-sphere-of-charge">Example: Dipole moment of an azimuthally symmetric hollow sphere of charge</h5>
<p>Consider a hollow spherical shell of radius <span class="math inline">\(R\)</span> with a polar-dependent surface charge density of the form <span class="math inline">\(\sigma' = k \cos\theta'\)</span>. We’d like to find the dipole moment and potential associated with this distribution.</p>
<p>First, notice that this distribution has no net charge, since the monopole moment is <span class="math display">\[
q = \int da' \ \sigma' = 2\pi R^2 k \int_0^\pi d\theta' \ \cos\theta' = 0 \ .
\]</span> This means the first term in the multipole expansion <em>must</em> be at least a dipole potential. Let’s now calculate the dipole moment. Notice first that the charge density is azimuthally symmetric about the <span class="math inline">\(z\)</span>-axis. This means the dipole potential must point along the <span class="math inline">\(z\)</span>-direction, with <span class="math inline">\(\mathbf{p} = p_z \mathbf{e}_z\)</span>. It thus suffices to calculate only the <span class="math inline">\(p_z\)</span> component of the dipole moment. We have <span class="math display">\[
p_z = \int da' \ \sigma' z' = \int_0^\pi R^2 \sin\theta' d\theta' \ k R \cos^2\theta' = \frac{4\pi}{3} k R^3 \ .
\]</span> With the dipole moment in hand we can now calculate the dipole potential. Evidently, we have <span class="math display">\[
\phi^{(1)}(\mathbf{x}) = \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} = \frac{p_z \cos\theta}{r^2} = \frac{4\pi}{3} kR \cos\theta \bigg(\frac{R}{r}\bigg)^2 \ .
\]</span> Since there is no monopole moment, this means in the far field limit the full potential can be approximated by <span class="math display">\[
\phi(\mathbf{x}) \approx \frac{4\pi}{3} kR \cos\theta \bigg(\frac{R}{r}\bigg)^2 \ .
\]</span> In fact, this is the <em>exact</em> potential for this charge distribution. We calculated the exact potential for this distribution in the previous chapter and got the exact same result.</p>
<p>We can calculate the associated electric field as well, which is <span class="math display">\[
\mathbf{E}(\mathbf{x}) = \mathbf{E}^{(1)}(\mathbf{x}) =  \frac{3(\mathbf{p} \cdot \mathbf{e}_r) \mathbf{e}_r}{r^3} - \frac{\mathbf{p}} {r^3} = \frac{4\pi}{3} k \bigg(\frac{R}{r}\bigg)^3 \bigg(3\cos\theta \mathbf{e}_r - \mathbf{e}_z\bigg) \ .
\]</span> As expected, the electric field falls off like <span class="math inline">\(1/r^3\)</span>, with field lines coming out from the top of the sphere (which we can think of as a <span class="math inline">\(+q\)</span> charge, and going into the bottom of the sphere (which we can think of as a <span class="math inline">\(-q\)</span> charge).</p>
<p>FIGURE (sketch the field lines of this sphere, showing it looks like a dipole)</p>
<hr>
<p>We’ll finish this section by asking how the dipole moment changes if the charge distribution is no longer centered at the origin, but instead some point <span class="math inline">\(\mathbf{a}\)</span>. This means each source point shifts by <span class="math inline">\(\mathbf{x}' \to \mathbf{x}' - \mathbf{a}\)</span>, which means the dipole moment shifts from <span class="math inline">\(\mathbf{p} \to \mathbf{p}'\)</span>, where <span class="math display">\[
\mathbf{p}' = \int d^3(\mathbf{x}' - \mathbf{a}) \ \rho(\mathbf{x}' - \mathbf{a}) (\mathbf{x}' - \mathbf{a}) \ .
\]</span> Now, it’s easy to see the volume element <span class="math inline">\(\rho(\mathbf{x}') d^3 \mathbf{x}'\)</span> is independent to shifts by a constant vector. This means we can write <span class="math display">\[
\mathbf{p}' = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') (\mathbf{x}' - \mathbf{a}) = \mathbf{p} - q\mathbf{a} \ ,
\]</span> where <span class="math inline">\(q\)</span> is the monopole moment. Thus, under a shift of origin, <span class="math inline">\(\mathbf{p}\)</span> shifts by a constant amount <span class="math inline">\(q\mathbf{a}\)</span>. Evidently in the special case where the net charge is zero, <span class="math inline">\(q=0\)</span>, which means <span class="math inline">\(\mathbf{p}\)</span> remains the same. This is a special case of a more general fact which we won’t prove: The lowest <em>non-vanishing</em> Cartesian multipole moment is always independent of the choice of origin.</p>
</section>
</section>
<section id="quadrupole-moment" class="level3">
<h3 class="anchored" data-anchor-id="quadrupole-moment">Quadrupole Moment</h3>
<p>Finally, let’s look at the quadratic term in the multipole expansion, which we had last written in the form <span class="math display">\[
\phi^{(2)}(\mathbf{x}) \equiv \frac{1}{2r^5} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') [3 (\mathbf{x} \cdot \mathbf{x}')^2 - r^2 r'^2] \ .
\]</span> This is called the <em>quadrupole potential</em>. Recall that we also defined the quadrupole moment <span class="math inline">\(\mathbf{Q}\)</span>, whose components are <span class="math display">\[
Q_{ij} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Notice that <span class="math inline">\(x_i' x_j'\)</span> is just the components of the outer product <span class="math inline">\(\mathbf{x}' \otimes \mathbf{x}'\)</span>, <span class="math inline">\(\delta_{ij}\)</span> is just the components of the identity tensor <span class="math inline">\(\mathbf{1}\)</span>. This means we can also write the quadrupole moment in abstract notation as <span class="math display">\[
\mathbf{Q} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 \mathbf{x}' \otimes \mathbf{x}' - r'^2 \mathbf{1}\bigg] \ .
\]</span> Since the outer product and the identity tensor are both valid rank-2 tensors, the quadrupole moment, or <em>quadrupole tensor</em>, is clearly a rank-2 tensor as well by the superposition principle. Its components have dimensions of charge times distance squared, or charge times area. This means we should always expect the components of the quadrupole moment to go like <span class="math inline">\(qd^2\)</span>, where <span class="math inline">\(d\)</span> is some characteristic length scale.</p>
<p>Notice from the definition that the quadrupole tensor is clearly symmetric since both the outer product and the identity tensor are symmetric. That is, <span class="math inline">\(Q_{ij} = Q_{ji}\)</span>. Moreover, the quadrupole tensor is also <em>traceless</em>. That is, its <em>trace</em> <span class="math inline">\(Q_{ii} = 0\)</span>. To see why, observe that <span class="math display">\[
Q_{ii} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_i' - r'^2 \delta_{ii}\bigg] = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 r'^2 - 3 r'^2\bigg] = 0 \ .
\]</span> Here, we used the fact that <span class="math inline">\(r'^2 = x_i' x_i'\)</span> and the trace of the <span class="math inline">\(3 \times 3\)</span> identity tensor is <span class="math inline">\(\delta_{ii} = 3\)</span>.</p>
<p>We’ve thus shown that the quadrupole tensor is a symmetric, traceless tensor of rank-2. Such a tensor is usually called an <em>irreducible tensor</em>. These conditions together imply that, while the quadrupole tensor has <span class="math inline">\(3^2 = 9\)</span> total components, it only has <span class="math inline">\(3^2 - 3 - 1 = 5\)</span> independent components. This is due to the fact that the symmetric condition makes three of the off-diagonal components redundant, while the tracelessness condition makes one of the diagonal components redundant.</p>
<p>We’ll now show that we can express the quadrupole potential explicitly in terms of the quadrupole moment as <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{x_i x_j Q_{ij}}{2r^5} \ .
\]</span> First, let’s take the expression for the quadrupole potential we had before and re-express it in index notation, <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{1}{2r^5} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 (x_i x'_i) (x_j x_j') - r^2 r'^2\bigg] \ .
\]</span> We want the pull all dependence on <span class="math inline">\(\mathbf{x}\)</span> out of the integrand. We can do this be factoring <span class="math inline">\(x_i x_j\)</span> out of the first term, but if we do that we need to insert a <span class="math inline">\(\delta_{ij}\)</span> into the second term. We then have <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{x_i x_j}{2r^5} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Notice now that the remaining integral is just the <span class="math inline">\(Q_{ij}\)</span> component of the quadrupole tensor. We thus have <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{Q_{ij} x_i x_j}{2r^5} \ .
\]</span> This is precisely what we wanted to show. We can express this in abstract notation by noticing that <span class="math inline">\(Q_{ij} x_i x_j\)</span> is just the index notation representation of the quadratic form <span class="math inline">\(\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}\)</span>, which is just the scalar <span class="math inline">\(\mathbf{x} \cdot (\mathbf{Q} \cdot \mathbf{x})\)</span>. The dipole potential thus becomes <span class="math display">\[
\boxed{
\phi^{(2)}(\mathbf{x}) =\frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5}
} \ .
\]</span> We’ve thus completed our derivation of the Cartesian multipole expansion we wrote above, <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{r} + \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} + \frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} + \cdots \ .
\]</span> To find the associated quadrupole field <span class="math inline">\(\mathbf{E}^{(2)}(\mathbf{x})\)</span> we again need only use the relation <span class="math inline">\(\mathbf{E}^{(2)} = -\nabla \phi^{(2)}\)</span>. After a bit of algebraic manipulation, one can show that the quadrupole field can be expressed in abstract notation as <span class="math display">\[
\boxed{
\mathbf{E}^{(2)}(\mathbf{x}) = \frac{5 (\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}) \mathbf{x} - 2r^2(\mathbf{Q} \cdot \mathbf{x})}{2r^7}
} \ .
\]</span> As expected, the quadrupole field falls off like <span class="math inline">\(1/r^4\)</span>. A plot of the field lines is shown below. Notice that, like the dipole field, most of the field lines begin and end at the source, with the exception of the field lines along the diagonal.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103010154876.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<section id="example-physical-quadrupole" class="level5">
<h5 class="anchored" data-anchor-id="example-physical-quadrupole">Example: Physical Quadrupole</h5>
<p>To get a handle as to what the quadrupole is saying about a charge distribution we’ll do the same thing we did with the dipole, consider a toy problem involving a simple configuration of point charges. Suppose four point charges of the same magnitude <span class="math inline">\(q\)</span> are laid out in a square whose sides have a length <span class="math inline">\(d\)</span>. Suppose the square is centered at the origin of the <span class="math inline">\(yz\)</span>-plane, with the charges laid out as follows:</p>
<ul>
<li>A charge <span class="math inline">\(q_1=q\)</span> located at position <span class="math inline">\(\mathbf{x}_1 = (0, d/2, d/2)\)</span>,</li>
<li>A charge <span class="math inline">\(q_2 = -q\)</span> located at position <span class="math inline">\(\mathbf{x}_2 = (0, d/2, -d/2)\)</span>,</li>
<li>A charge <span class="math inline">\(q_3 = q\)</span> located at position <span class="math inline">\(\mathbf{x}_3 = (0, -d/2, -d/2)\)</span>,</li>
<li>A charge <span class="math inline">\(q_4 = -q\)</span> located at position <span class="math inline">\(\mathbf{x}_4 = (0, -d/2, d/2)\)</span>.</li>
</ul>
<p>We call a charge configuration of this kind a <em>physical quadrupole</em>. By the principal of superposition, the exact potential of this charge configuration is evidently <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q_1}{|\mathbf{x} - \mathbf{x}_1|} + \frac{q_2}{|\mathbf{x} - \mathbf{x}_2|} + \frac{q_3}{|\mathbf{x} - \mathbf{x}_3|} + \frac{q_4}{|\mathbf{x} - \mathbf{x}_4|} \\
&amp;= q\bigg[\frac{1}{\sqrt{x^2 + (y-d/2)^2 + (z-d/2)^2}} - \frac{1}{\sqrt{x^2 + (y-d/2)^2 + (z+d/2)^2}} \\
&amp;- \frac{1}{\sqrt{x^2 + (y+d/2)^2 + (z-d/2)^2}} + \frac{1}{\sqrt{x^2 + (y+d/2)^2 + (z+d/2)^2}}\bigg] \ ,
\end{align*}
\]</span> and the exact E-field is <span class="math display">\[
\begin{align*}
\mathbf{E}(\mathbf{x}) &amp;= q_1 \frac{\mathbf{x} - \mathbf{x}_1}{|\mathbf{x} - \mathbf{x}_1|^3} + q_2 \frac{\mathbf{x} - \mathbf{x}_2}{|\mathbf{x} - \mathbf{x}_2|^3} + q_3 \frac{\mathbf{x} - \mathbf{x}_3}{|\mathbf{x} - \mathbf{x}_3|^3} + q_4 \frac{\mathbf{x} - \mathbf{x}_4}{|\mathbf{x} - \mathbf{x}_4|^3} \\
&amp;= q\bigg[\frac{\mathbf{x} - d/2 (\mathbf{e}_y + \mathbf{e}_z)}{\sqrt{x^2 + (y-d/2)^2 + (z-d/2)^2}} - \frac{\mathbf{x} - d/2 (\mathbf{e}_y - \mathbf{e}_z)}{\sqrt{x^2 + (y-d/2)^2 + (z+d/2)^2}} \\
&amp;- \frac{\mathbf{x} + d/2 (\mathbf{e}_y + \mathbf{e}_z)}{\sqrt{x^2 + (y+d/2)^2 + (z-d/2)^2}} + \frac{\mathbf{x} + d/2 (\mathbf{e}_y - \mathbf{e}_z)}{\sqrt{x^2 + (y+d/2)^2 + (z+d/2)^2}}\bigg] \ .
\end{align*}
\]</span> As complicated as this looks, we can still plot the field lines numerically. Below is a plot of these field lines, with the positive charges are shown in red and the negative charges in blue. As usual, the equipotentials curves are tangential to the field lines.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103012027269.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Now, compare this plot to the ones shown for the <em>pure quadrupole</em> previously. Close to the charges the field lines look nothing alike, while far away from the point charges they look practically identical, exactly like we saw with the physical dipole before. This suggests that the physical quadrupole may provide a good approximation to the pure quadrupole in the far field limit <span class="math inline">\(r \gg d\)</span>.</p>
<p>We can confirm this by showing that this charge configuration has no monopole or dipole moment. Since the charges all sum to zero, there’s clearly no monopole moment. The dipole moment also vanishes, since $$ <span class="math display">\[\begin{align*}
\mathbf{p} &amp;= q \mathbf{x}_1 - q \mathbf{x}_2 + q \mathbf{x}_3 - q \mathbf{x}_4 \\
&amp;= q \big[[\mathbf{x} - d/2 (\mathbf{e}_y + \mathbf{e}_z)] - [\mathbf{x} - d/2 (\mathbf{e}_y - \mathbf{e}_z)] + [\mathbf{x} + d/2 (\mathbf{e}_y + \mathbf{e}_z)] - [\mathbf{x} + d/2 (\mathbf{e}_y - \mathbf{e}_z)]\big] \\

&amp;= \mathbf{0} \ .

\end{align*}\]</span> <span class="math display">\[
This means when $r \gg d$ the exact potential $\phi(\mathbf{x})$ must fall off *at least* like $1/r^3$. In fact in this limit it falls off *exactly* like $1/r^3$. We can confirm this by calculating its quadrupole moment and confirm it's non-vanishing. It's not hard to see that each component of the quadrupole moment will be given by the sum
\]</span> Q_{ij} = _{k=1}^4 q_k &nbsp;, $$ where <span class="math inline">\(x_i^{(k)}\)</span> is the <span class="math inline">\(i\)</span><sup>th</sup> component of <span class="math inline">\(\mathbf{x}_k\)</span> and <span class="math inline">\(r_k^2 = \mathbf{x}_k \cdot \mathbf{x}_k\)</span>.</p>
<p>First, notice that the diagonal components of the quadrupole tensor all vanish, since each <span class="math inline">\(+q\)</span> contribution in the sum cancels exactly one <span class="math inline">\(-q\)</span> contribution in the sum, which means the total sum vanishes. For example, since <span class="math inline">\(\delta_{yy} = 1\)</span> and <span class="math inline">\(r_k^2 = 2(d/2)^2\)</span>, for the <span class="math inline">\(Q_{yy}\)</span> component we have <span class="math display">\[
\begin{align*}
Q_{yy} &amp;= \sum_{k=1}^4 q_k \bigg[3 y^{(k)} y^{(k)} - r_k^2 \delta_{yy}\bigg] \\
&amp;= q\bigg[3\bigg(\frac{d}{2}\bigg) \bigg(\frac{d}{2}\bigg) - 2\bigg(\frac{d}{2}\bigg)^2 \bigg] - q\bigg[3\bigg(\frac{d}{2}\bigg) \bigg(\frac{d}{2}\bigg) - 2\bigg(\frac{d}{2}\bigg)^2\bigg] \\
&amp;+ q\bigg[3\bigg(-\frac{d}{2}\bigg)\bigg(-\frac{d}{2}\bigg) - 2\bigg(\frac{d}{2}\bigg)^2\bigg] - q\bigg[3\bigg(-\frac{d}{2}\bigg)\bigg(-\frac{d}{2}\bigg) - 2\bigg(\frac{d}{2}\bigg)^2\bigg] \\
&amp;= 0 \ .
\end{align*}
\]</span> Next, notice that if <span class="math inline">\(i=x\)</span> each <span class="math inline">\(Q_{xj}\)</span> component also vanishes. On the off diagonals this is obvious, since both <span class="math inline">\(\delta_{xj} = 0\)</span> and <span class="math inline">\(x_i^{(k)} x_j^{(k)} = 0\)</span>. But it’s true for <span class="math inline">\(Q_{xx}\)</span> as well since <span class="math inline">\(\delta_{xx} = 1\)</span> and <span class="math inline">\(r_k^2 = 2(d/2)^2\)</span>, which again means each term pairwise cancels, <span class="math display">\[
Q_{xx} = q \bigg[-2\bigg(\frac{d}{2}\bigg)^2\bigg] - q \bigg[-2\bigg(\frac{d}{2}\bigg)^2\bigg] + q \bigg[-2\bigg(\frac{d}{2}\bigg)^2\bigg] - q \bigg[-2\bigg(\frac{d}{2}\bigg)^2\bigg] = 0 \ .
\]</span> All that remains then are the two off diagonals <span class="math inline">\(Q_{yz} = Q_{zy}\)</span>. We have <span class="math display">\[
Q_{yz} = 3q\bigg(\frac{d}{2}\bigg)^2 + 3q\bigg(\frac{d}{2}\bigg)^2 + 3q \bigg(\frac{d}{2}\bigg)^2 + 3q \bigg(\frac{d}{2}\bigg)^2 = 12q \bigg(\frac{d}{2}\bigg)^2 = 3 q d^2 \ .
\]</span> If we put all of these components into a matrix, the full quadrupole tensor <span class="math inline">\(\mathbf{Q}\)</span> then looks like <span class="math display">\[
\mathbf{Q} = 3 qd^2\begin{pmatrix}
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0
\end{pmatrix} \ .
\]</span> Plugging this result into the quadrupole potential, we get <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{Q_{ij} x_i x_j}{2r^5} = \frac{Q_{yz} yz}{2r^5} + \frac{Q_{zy} zy}{2r^5} = 3qd^2 \frac{yz}{r^5} \ .
\]</span> One can check that this is correct by taking the exact potential <span class="math inline">\(\phi(\mathbf{x})\)</span> for the physical quadrupole above and do a binomial expansion in the limit <span class="math inline">\(r \gg d\)</span> to show that to first order we get the same result. Thus, in the far field limit the physical quadrupole behaves as a pure quadrupole, falling off like <span class="math inline">\(1/r^3\)</span>. In this sense, we can think of the physical quadrupole as a simple model of the pure quadrupole by letting <span class="math inline">\(d \to 0\)</span> while keeping the product <span class="math inline">\(q d^2\)</span> fixed.</p>
<hr>
<p>The previous example provides us some intuition as to what the quadrupole moment is. For example, since the quadrupole moment goes like <span class="math inline">\(q d^2\)</span>, in some sense it represents the <em>spread</em> of the charge distribution. The more spread out the distribution is, the higher the quadrupole moment will be. But it’s more subtle than that. For example, consider again the uniformly charged sphere with charge <span class="math inline">\(q\)</span> and radius <span class="math inline">\(R\)</span>, centered at the origin. Outside the sphere, we already know its potential is exactly <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{r} \ .
\]</span> This means the uniformly charged sphere <em>only</em> has a monopole moment, since its potential falls off exactly like <span class="math inline">\(1/r\)</span>. This of course means both the dipole moment and the quadrupole moment must be zero. But this means the quadrupole moment can’t <em>only</em> represent the spread of the distribution, since clearly if it’s zero it doesn’t go like <span class="math inline">\(q R^2\)</span>. So what’s going on? A better way to think about the quadrupole moment is that it characterizes the <em>anisotropy</em> of the charge distribution. That is, it’s a measure of both the spread of the charge distribution as well as how non-spherical it is.</p>
</section>
<section id="example-uniformly-charged-ring" class="level5">
<h5 class="anchored" data-anchor-id="example-uniformly-charged-ring">Example: Uniformly charged ring</h5>
<p>Suppose we have a uniformly charged circular ring with radius <span class="math inline">\(a\)</span> and line charge density <span class="math inline">\(\lambda\)</span>. We’ll assume that the ring is centered at the origin in the <span class="math inline">\(xy\)</span>-plane. Clearly the ring has a net charge given by <span class="math inline">\(q = 2\pi a \lambda\)</span>, which means its potential must have a monopole contribution. It does not, however, have a dipole moment. This can be seen from symmetry. The ring clearly has no preferred direction in the <span class="math inline">\(xy\)</span>-plane since it’s circular and uniformly charged, which means it can’t have a dipole moment.</p>
<p>But does it have a quadrupole moment? This isn’t so clear from symmetry alone, so let’s calculate it explicitly. To do so we need to keep in mind we’re working with a one-dimensional distribution, which means <span class="math inline">\(dq = \lambda d\ell'\)</span>. Each component of the quadrupole moment will thus be given by an integral of the form <span class="math display">\[
Q_{ij} = \int d\ell' \ \lambda(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Along the ring, <span class="math inline">\(\lambda\)</span> is constant, <span class="math inline">\(r' = a\)</span> is constant, and the line element is just <span class="math inline">\(d\ell' = a d\varphi'\)</span>. We’re thus left to evaluate <span class="math display">\[
Q_{ij} = 3a\lambda \int_0^{2\pi} d\varphi' \ x_i' x_j' - a^3 \lambda \delta_{ij} \int_0^{2\pi} d\varphi' \ .
\]</span> The second integral is clearly just <span class="math inline">\(2\pi a^3 \lambda \delta_{ij}\)</span>, or equivalently <span class="math inline">\(qa^2 \delta_{ij}\)</span>. To evaluate the first integral we need to switch to polar coordinates, which means we’ll need to be explicit about which components we’re calculating.</p>
<p>Let’s calculate <span class="math inline">\(Q_{xx}\)</span> first. Since <span class="math inline">\(x' = a \cos\varphi'\)</span> and <span class="math inline">\(\delta_{xx} = 1\)</span>, we have <span class="math display">\[
Q_{xx} = 3a\lambda \int_0^{2\pi} d\varphi' \ a^2 \cos^2\varphi' - 2\pi a^3 \lambda = 3\pi a^3 \lambda - 2\pi a^3 \lambda = \frac{1}{2} qa^2 \ .
\]</span> Similarly, it’s easy to see we must get <span class="math inline">\(Q_{yy} = qa^2 / 2\)</span> as well. The tracelessness property of the quadrupole tensor then implies we must have <span class="math inline">\(Q_{zz} = -Q_{xx} - Q_{yy} = -qa^2\)</span> for the remaining diagonal component.</p>
<p>Next, we need to find <span class="math inline">\(Q_{xy}\)</span>. Since <span class="math inline">\(y' = a\sin\varphi'\)</span> and <span class="math inline">\(\delta_{xy} = 0\)</span>, we have <span class="math display">\[
Q_{xy} = 3a\lambda \int_0^{2\pi} d\varphi' \ a^2 \cos\varphi' \sin\varphi' = 0 \ .
\]</span> This immediately implies <span class="math inline">\(Q_{yx} = 0\)</span> as well since the quadrupole tensor is symmetric. Last, observe <span class="math inline">\(Q_{xz} = Q_{yz} = 0\)</span> since for these components both the first and second integrals must vanish.</p>
<p>We thus have a quadrupole tensor <span class="math inline">\(\mathbf{Q}\)</span> with non-vanishing terms only along the diagonal, <span class="math display">\[
\mathbf{Q} = \frac{1}{2} qa^2\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; -2
\end{pmatrix} \ .
\]</span> With these moments in hand, we can now calculate the multipole expansion for the charged ring, which is evidently <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q}{r} + \frac{Q_{xx} x^2 + Q_{yy} y^2 + Q_{zz} z^2}{2r^5} + \cdots \\
&amp;= \frac{q}{r} + \frac{qa^2(x^2 + y^2 - 2z^2)}{4r^5} + \cdots \ .
\end{align*}
\]</span> So how do we know this expansion is correct? One way to check is to calculate the exact potential in some simple direction. In this case, the clear choice is to choose the axis of symmetry, the <span class="math inline">\(z\)</span>-axis. We can calculate the exact potential along the <span class="math inline">\(z\)</span>-axis very easily from the integral formula. In fact we did that in the previous chapter, where we got <span class="math display">\[
\phi(z) = \frac{q}{\sqrt{a^2 + z^2}} = \frac{q}{z} - \frac{qa^2}{2z^3} + \cdots \ .
\]</span> Clearly this agrees with the expansion derived above when <span class="math inline">\(x = y = 0\)</span>. However, the expansion derived above works for <em>any</em> field point, not just those along the <span class="math inline">\(z\)</span>-axis. Indeed, we already have a good approximation to the potential for the ring when <span class="math inline">\(r \gg z\)</span>. So long as we’re far enough away from the ring the higher order moments are negligible. It’s really in this sense that the multipole expansion is most useful in practice.</p>
<hr>
<p>The ring of charge is an example of a general fact: If a charge distribution is azimuthally symmetric, its quadrupole moment can be completely characterized by a single scalar <span class="math inline">\(Q\)</span>, the <em>scalar quadrupole moment</em>. In the previous example, this single scalar was <span class="math inline">\(Q_{zz} = -q a^2\)</span>. If we know <span class="math inline">\(Q_{zz}\)</span> along with the fact that the ring of charge is azimuthally symmetric, we automatically know the entire quadrupole tensor. We’ll prove this fact more generally in a later section.</p>
</section>
</section>
<section id="higher-order-moments" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-moments">Higher-Order Moments</h3>
<p>In deriving the Cartesian multipole expansion we only focused on the first few moments, namely the monopole, dipole, and quadrupole moments. Of course, as the expansion continues there will be higher-order moments as well. To that end, let’s re-express the Green’s function expansion derived above, but this time in index notation, <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} (\mathbf{x}' \cdot \nabla)^\ell \frac{1}{r} = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} x'_{i_1} x'_{i_2} \cdots x'_{i_\ell} \partial_{i_1} \partial_{i_2} \cdots \partial_{i_\ell} \frac{1}{r} \ .
\]</span> Plugging this expansion back into the potential, we then get <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} \bigg(\partial_{i_1} \partial_{i_2} \cdots \partial_{i_\ell} \frac{1}{r}\bigg) \int d^3\mathbf{x}' \ \rho(\mathbf{x}') x'_{i_1} x'_{i_2} \cdots x'_{i_\ell} \ .
\]</span> Now, notice that the mixed partial derivative will go like <span class="math inline">\(1/r^{\ell+1}\)</span>. By manipulating terms in a clever way, one can show that the general Cartesian multipole expansion can be written in the form <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{1}{\ell! r^{\ell+1}} Q_{i_1 i_2 \cdots i_\ell} x_{i_1} x_{i_2} \cdots x_{i_\ell} \ ,
\]</span> where each <span class="math inline">\(Q_{i_1 i_2 \cdots i_\ell}\)</span> is a rank-<span class="math inline">\(\ell\)</span> irreducible tensor, called the <span class="math inline">\(\ell\)</span><sup>th</sup> <em>Cartesian multipole moment</em>. By matching this expansion with the Cartesian expansion derived before, it’s easy to see that the <span class="math inline">\(\ell=0\)</span> moment is the monopole moment <span class="math inline">\(q\)</span>, the <span class="math inline">\(\ell=1\)</span> moment is the usual dipole moment <span class="math inline">\(\mathbf{p}\)</span>, and the <span class="math inline">\(\ell=2\)</span> moment is the usual quadrupole moment <span class="math inline">\(\mathbf{Q}\)</span>.</p>
<p>By <em>irreducible tensor</em>, we mean that the tensor is <em>symmetric</em> and <em>traceless</em>, meaning we can permute the indices without changing the tensor, and when contracted over all indices the tensor vanishes. Together, these conditions reduce a rank-<span class="math inline">\(\ell\)</span> tensor from having <span class="math inline">\(3^\ell\)</span> total components down to only <span class="math inline">\(2\ell+1\)</span> independent components. This is why the quadrupole tensor contains <span class="math inline">\(3^2=9\)</span> total components, but only <span class="math inline">\(2 \cdot 2 +1 = 5\)</span> of those components are independent. There is a whole rich theory to irreducible tensors that ties into group theory, which we will not go into here.</p>
<p>For what it’s worth, the <span class="math inline">\(\ell=3\)</span> term will be proportional to a rank-3 irreducible tensor <span class="math inline">\(Q_{ijk}\)</span> known as the <em>octupole moment</em>. The octupole potential is then given by <span class="math display">\[
\phi^{(3)}(\mathbf{x}) = \frac{x_i x_j x_k Q_{ijk}}{6r^7} \ .
\]</span> One can study the octupole moment or any higher moment just as we did above with the lower-order moments. For instance, it’s clear the octupole potential will fall off like <span class="math inline">\(1/r^4\)</span>, and the octupole moment will go like <span class="math inline">\(qd^3\)</span> for some characteristic length <span class="math inline">\(d\)</span>. This is rarely done though, since in practice we’re only interested in the first few terms of the multipole expansion, since those give the best approximation when far away from the source charge distribution.</p>
</section>
<section id="charges-in-external-fields" class="level3">
<h3 class="anchored" data-anchor-id="charges-in-external-fields">Charges in External Fields</h3>
<p>Thus far, we’ve derived the multipole expansion for a localized charge distribution in free space, with no other external fields present. We’d now like to introduce an external E-field and examine the potential energy of a localized charge distribution in the presence of this field in terms of its multipole moments. We’ll assume the external field is strong enough that we can neglect any self fields produced by the charge distribution itself.</p>
<p>To that end, suppose we have a charge distribution <span class="math inline">\(\rho(\mathbf{x})\)</span> localized around the origin. In the background we assume there’s an external E-field <span class="math inline">\(\mathbf{E}_{\text{ext}}(\mathbf{x})\)</span> whose potential is <span class="math inline">\(\phi_{\text{ext}}(\mathbf{x})\)</span>. Clearly the external field will itself be generated by some other charge distribution <span class="math inline">\(\rho_{\text{ext}}(\mathbf{x})\)</span>, but we’ll assume it’s far enough away from <span class="math inline">\(\rho(\mathbf{x})\)</span> that we can ignore it.</p>
<p>We assume the external charge distribution is unknown. To that end, it doesn’t make sense to do a multipole expansion of <span class="math inline">\(\phi_{\text{ext}}(\mathbf{x})\)</span>, but we can still do a Taylor expansion about the origin, <span class="math display">\[
\begin{align*}
\phi_{\text{ext}}(\mathbf{x}) &amp;= \sum_{n=0}^\infty \frac{1}{n!} (\mathbf{x} \cdot \nabla)^n \phi_{\text{ext}}(\mathbf{0}) \\
&amp;= \phi_{\text{ext}}(\mathbf{0}) + \mathbf{x} \cdot \nabla \phi_{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} + \frac{1}{2} x_i x_j \partial_i \partial_j \phi_{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} + \cdots \\
&amp;= \phi_{\text{ext}}(\mathbf{0}) - \mathbf{x} \cdot \mathbf{E}_{\text{ext}}(\mathbf{0}) - \frac{1}{2} x_i x_j \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} + \cdots \ .
\end{align*}
\]</span> Note in the last line we used the relation <span class="math inline">\(\mathbf{E}_{\text{ext}}(\mathbf{x}) = -\nabla \phi_{\text{ext}}(\mathbf{x})\)</span> to simplify the expansion somewhat. Now, recall the potential energy <span class="math inline">\(U\)</span> on a charge distribution due to an external E-field is given by <span class="math display">\[
U = \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) \phi_{\text{ext}}(\mathbf{x}) \ ,
\]</span> where the region <span class="math inline">\(\mathcal{V}\)</span> is the enclosed volume of the charge distribution <span class="math inline">\(\rho(\mathbf{x})\)</span>. If we plug in the Taylor expansion for the external potential into this integral and group terms, we get <span class="math display">\[
\begin{align*}
U &amp;= \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) \phi_{\text{ext}}(\mathbf{x}) \\
&amp;= \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) \bigg[\phi_{\text{ext}}(\mathbf{0}) - \mathbf{x} \cdot \mathbf{E}_{\text{ext}}(\mathbf{0}) - \frac{1}{2} x_i x_j \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} + \cdots\bigg] \\
&amp;= \phi_{\text{ext}}(\mathbf{0}) \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) - \mathbf{E}_{\text{ext}}(\mathbf{0}) \cdot \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) \mathbf{x} - \frac{1}{2} \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) x_i x_j + \cdots \ .
\end{align*}
\]</span> Note we pulled all field-dependent terms outside the integral since they don’t depend on <span class="math inline">\(\mathbf{x}\)</span>. Now, notice the first integral is just the monopole moment <span class="math inline">\(q\)</span> of the charge distribution, and the second integral is its dipole moment <span class="math inline">\(\mathbf{p}\)</span>. Clearly the final integral should somehow be related to the quadrupole moment <span class="math inline">\(Q_{ij}\)</span>. Indeed, observe if we contract <span class="math inline">\(Q_{ij}\)</span> with <span class="math inline">\(\partial_i E_j^{\text{ext}}(\mathbf{x}) \big|_{\mathbf{x} = \mathbf{0}}\)</span> we get <span class="math display">\[
\begin{align*}
Q_{ij} \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} &amp;= \partial_i E_j^{\text{ext}}(\mathbf{x}) \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) [3 x_i x_j + \delta_{ij} r^2] \\
&amp;= 3 \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) x_i x_j + \delta_{ij} \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) r^2 \\
&amp;= 3 \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) x_i x_j + (\nabla \cdot \mathbf{E}_{\text{ext}}) \bigg|_{\mathbf{x} = \mathbf{0}} \int_\mathcal{V} d^3\mathbf{x} \ \rho(\mathbf{x}) r^2 \ .
\end{align*}
\]</span> Now, by Gauss’s law we know <span class="math inline">\(\nabla \cdot \mathbf{E}_{\text{ext}} = 4\pi \rho_{\text{ext}}\)</span>. Since we’re only interested inside <span class="math inline">\(\mathcal{V}\)</span> though we have <span class="math inline">\(\nabla \cdot \mathbf{E}_{\text{ext}} = 0\)</span>. Thus, we get <span class="math display">\[
\partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} \int d^3\mathbf{x} \ \rho(\mathbf{x}) x_i x_j = \frac{1}{3} Q_{ij} \partial_i E_j^{\text{ext}}(\mathbf{x}) \ .
\]</span> Putting this all together now, we finally have the potential energy expansion of a charge distribution in an external E-field, <span class="math display">\[
\boxed{
U = q \phi_{\text{ext}}(\mathbf{0}) - \mathbf{p} \cdot \mathbf{E}_{\text{ext}}(\mathbf{0}) - \frac{1}{6} Q_{ij} \partial_i E_j^{\text{ext}}(\mathbf{x}) \bigg|_{\mathbf{x} = \mathbf{0}} + \cdots
} \ .
\]</span> In particular, notice that if the E-field is <em>uniform</em> inside <span class="math inline">\(\mathcal{V}\)</span> with constant value <span class="math inline">\(\mathbf{E}_0\)</span>, we can write <span class="math display">\[
U = q \phi_0 - \mathbf{p} \cdot \mathbf{E}_0 \ ,
\]</span> where <span class="math inline">\(\phi_0\)</span> is some chosen ground potential.</p>
</section>
</section>
<section id="spherical-multipole-expansion" class="level2">
<h2 class="anchored" data-anchor-id="spherical-multipole-expansion">Spherical Multipole Expansion</h2>
<p>Now that we’ve studied the Cartesian multipole expansion in some depth, we’ll now turn our attention to the multipole expansion in spherical coordinates. Rather than just focus on the first few terms, we’ll go ahead and derive the full spherical expansion outright, and show how the spherical harmonics show up, and their relation to the irreducible components of the Cartesian multipole moments.</p>
<section id="greens-function-expansion" class="level3">
<h3 class="anchored" data-anchor-id="greens-function-expansion">Green’s Function Expansion</h3>
<p>Previously we derived the Cartesian expansion of the Green’s function, <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \sum_{\ell=0}^\infty \frac{(-1)^\ell}{\ell!} (\mathbf{x}' \cdot \nabla)^\ell \frac{1}{r} \ .
\]</span> We’d now like to get a similar expansion of the Green’s function, but this time in spherical coordinates. Rather than try to rewrite the above expansion in spherical coordinates it’ll be much easier to take a different approach. Namely, we’ll show that the Green’s function can be thought of as a <em>generating function</em> of the Legendre polynomials, and then relate these polynomials to spherical harmonics via the addition theorem.</p>
<p>To that end, let’s first write the squared norm <span class="math inline">\(|\mathbf{x} - \mathbf{x}'|^2\)</span> as <span class="math display">\[
(\mathbf{x} - \mathbf{x}') \cdot (\mathbf{x} - \mathbf{x}') = \mathbf{x} \cdot \mathbf{x} + \mathbf{x}' \cdot \mathbf{x}' - 2 \mathbf{x} \cdot \mathbf{x}' = r^2 + r'^2 - 2rr' \cos\alpha \ ,
\]</span> where as usual <span class="math inline">\(\alpha\)</span> is the angle between the vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}'\)</span>. The Green’s function can then be written as <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \frac{1}{\sqrt{1 + (r'/r)^2 - 2 (r'/r) \cos\alpha}} \ .
\]</span> Now, recall from the appendix that we <em>defined</em> the Legendre polynomials <span class="math inline">\(P_\ell(\cos\alpha)\)</span> as the expansion coefficients of a certain generating function, namely <span class="math display">\[
\frac{1}{\sqrt{1 + t^2 - 2t\cos\alpha}} \equiv \sum_{\ell=0}^\infty P_\ell(\cos\alpha) t^\ell \ .
\]</span> Now, notice if we substitute <span class="math inline">\(t = r'/r\)</span> this expansion looks exactly like the Green’s function above, up to a factor of <span class="math inline">\(1/r\)</span>. This means if we expand the Green’s function in powers of <span class="math inline">\(r'/r\)</span> its expansion coefficients are the Legendre polynomials, with <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \sum_{\ell=0}^\infty P_\ell(\cos\alpha) \bigg(\frac{r'}{r}\bigg)^\ell \ .
\]</span> Note this series expansion is valid so long as <span class="math inline">\(r &gt; r'\)</span>, which ensures the series decays rapidly enough to converge.</p>
<p>We now want to eliminate the explicit dependence on <span class="math inline">\(\cos\alpha\)</span>. We can do that by recalling the <em>addition theorem</em> of spherical harmonics. We proved in the appendix that <span class="math inline">\(P_\ell(\cos\alpha)\)</span> can be expanded in a linear superposition of spherical harmonics as <span class="math display">\[
P_\ell(\cos\alpha) = \frac{4\pi}{2\ell+1} \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> If we plug this back into the Green’s function we finally get its expansion in spherical coordinates, <span class="math display">\[
\boxed{
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r'}{r}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi')
} \ .
\]</span> Notice this expansion is now a double sum over two indices, <span class="math inline">\(\ell\)</span> and <span class="math inline">\(m\)</span>. For each fixed <span class="math inline">\(\ell\)</span> there will be <span class="math inline">\(2\ell+1\)</span> terms indexed by <span class="math inline">\(m\)</span>.</p>
<p>It’s worth mentioning that this derivation was completely symmetric in <span class="math inline">\(r\)</span> and <span class="math inline">\(r'\)</span>. Indeed, if we instead let <span class="math inline">\(t = r/r'\)</span> in the generating function, we instead get an <em>interior</em> expansion of the Green’s function when <span class="math inline">\(r &lt; r'\)</span>, <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r'} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r}{r'}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> The exterior and interior expansions are often combined by letting <span class="math inline">\(r_&lt; \equiv \min(r,r')\)</span> and <span class="math inline">\(r_&gt; \equiv \max(r,r')\)</span>, and writing <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r_&gt;} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r_&lt;}{r_&gt;}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Though we won’t need the interior expansion to derive the multipole expansion in spherical coordinates, it can sometimes be useful as a means of solving various boundary value problems in electrostatics.</p>
<section id="example-average-electric-field-on-the-surface-of-a-sphere" class="level5">
<h5 class="anchored" data-anchor-id="example-average-electric-field-on-the-surface-of-a-sphere">Example: Average electric field on the surface of a sphere</h5>
<ul>
<li>Average value of electric field over a sphere with a charge distribution inside or out</li>
<li>Can this even be done without the multipole expansion of the potential first? May need to move to next section.</li>
</ul>
</section>
</section>
<section id="spherical-expansion" class="level3">
<h3 class="anchored" data-anchor-id="spherical-expansion">Spherical Expansion</h3>
<p>If we plug the exterior Green’s function expansion back into the integral formula for the potential, we get <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \ \frac{\rho(\mathbf{x}')}{r} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r'}{r}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Notice that only the product <span class="math inline">\(r'^\ell Y_{\ell m}^*(\theta',\varphi')\)</span> depends on the source point <span class="math inline">\(\mathbf{x}'\)</span>. We can thus immediately define the <em>spherical multipole moments</em> <span class="math inline">\(q_{\ell m}\)</span> as the volume integral over this product, <span class="math display">\[
q_{\ell m} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Notice that the spherical multipole moments are <em>always</em> scalars, and in general complex-valued since <span class="math inline">\(Y_{\ell m}^*(\theta',\varphi')\)</span> will usually not be real-valued. For each <span class="math inline">\(\ell\)</span> there will be <span class="math inline">\(2\ell+1\)</span> corresponding spherical multipole moments.</p>
<p>Note that for each fixed <span class="math inline">\(\ell\)</span> the spherical harmonics are related by <span class="math display">\[
Y_{\ell,-m}(\theta,\varphi) = (-1)^m Y_{\ell m}^*(\theta,\varphi) \ .
\]</span> This immediately implies that <span class="math inline">\(q_{\ell,-m} = (-1)^m q_{\ell m}^*\)</span> as well, which means when calculating spherical multipole moments we only need to focus on finding the <span class="math inline">\(m = 0, 1, \cdots, \ell\)</span> components for a given fixed <span class="math inline">\(\ell\)</span>, from which the remaining components follow.</p>
<p>At any rate, if we substitute these moments back into the potential, we finally get the <em>spherical multipole expansion</em>, <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \frac{1}{r^{\ell+1}} \sum_{m=-\ell}^\ell q_{\ell m} Y_{\ell m}(\theta,\varphi)
} \ .
\]</span> As written, this is the most general form of the multipole expansion. We usually call the multipole expansion in this form the <em>spherical multipole expansion</em> since it involves an expansion in spherical coordinates.</p>
<p>Let’s take a closer look at each of the expansion terms. For a given <span class="math inline">\((\ell,m)\)</span> pair we have a multipole potential of the form <span class="math display">\[
\phi^{(\ell,m)}(\mathbf{x}) \equiv \frac{4\pi}{2\ell+1} \frac{q_{\ell m}}{r^{\ell+1}} Y_{\ell m}(\theta,\varphi) \ .
\]</span> Notice that the shape of each equipotential surface of <span class="math inline">\(\phi^{(\ell,m)}(\mathbf{x})\)</span> is determined mainly by the spherical harmonic <span class="math inline">\(Y_{\ell m}(\theta,\varphi)\)</span>. To that end, we can immediately visualize the equipotential surfaces of each multipole potential by plotting the spherical harmonics. Below is a plot of the spherical harmonics for <span class="math inline">\(\ell = 0, 1, 2, 3\)</span>, shown top to bottom with <span class="math inline">\(m\)</span> running left to right from <span class="math inline">\(-\ell\)</span> to <span class="math inline">\(\ell\)</span>. The positive equipotential surfaces are shown in blue, and the negative equipotential surfaces are shown in yellow.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/2560px-Spherical_Harmonics.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<p>Notice that the lone <span class="math inline">\(\ell = 0\)</span> equipotentials are spheres, which are the equipotentials of the monopole potential <span class="math inline">\(q/r\)</span>. In fact the <span class="math inline">\(\ell = 0\)</span> term corresponds <em>exactly</em> to the monopole potential, as we’ll show below. Similarly, the <span class="math inline">\(\ell=1\)</span> equipotentials correspond to the equipotentials of a dipole oriented along one of the axial directions. The <span class="math inline">\(\ell = 2\)</span> terms start to look more complicated, but they look basically like the equipotentials of a quadrupole. The <span class="math inline">\(\ell = 3\)</span> terms are more complicated still. Those represent the equipotentials of an octupole. In this sense, the spherical harmonics provide the best way to visualize the multipole potentials.</p>
</section>
<section id="relation-to-cartesian-expansion" class="level3">
<h3 class="anchored" data-anchor-id="relation-to-cartesian-expansion">Relation to Cartesian Expansion</h3>
<p>We now want to show that the spherical multipole expansion agrees with the Cartesian multipole expansion. Specifically, we’ll show that the <span class="math inline">\(\ell = 0, 1, 2\)</span> terms agree with the monopole, dipole, and quadrupole terms explicitly. To that end, we’ll list explicitly the spherical harmonics for <span class="math inline">\(\ell = 0, 1, 2\)</span> below, $$ <span class="math display">\[\begin{align*}
Y_{00}(\theta,\varphi) &amp;= \sqrt{\frac{1}{4\pi}} \ , \quad

\begin{cases}
Y_{10}(\theta,\varphi)&amp; = \sqrt{\frac{3}{4\pi}} \cos\theta \\
Y_{1,\pm 1}(\theta,\varphi) &amp;= \mp \sqrt{\frac{3}{8\pi}} \sin\theta e^{\pm i\varphi} \\
\end{cases} \ , \quad

\begin{cases}
Y_{20}(\theta,\varphi) &amp;= \sqrt{\frac{5}{16\pi}} (3\cos^2 \theta - 1) \\
Y_{2,\pm 1}(\theta,\varphi) &amp;= \mp \sqrt{\frac{15}{8\pi}} \sin\theta \cos\theta e^{\pm i\varphi} \\
Y_{2,\pm 2}(\theta,\varphi) &amp;= \sqrt{\frac{15}{32\pi}} \sin^2 \theta e^{\pm 2i\varphi} \\
\end{cases} \ .
\end{align*}\]</span> <span class="math display">\[
First, notice when $\ell = 0$ we only have one spherical harmonic $Y_{00}(\theta,\varphi)$, with corresponding spherical multipole moment
\]</span> q_{00} = d^3’ &nbsp;(’) Y_{00}^*(‘,’) = d^3’ &nbsp;(’) = &nbsp;. <span class="math display">\[
Here $q$ is just the usual monopole moment. The $\ell=0$ expansion term is thus just the usual monopole potential, since
\]</span> ^{(0)}() = q_{00} Y_{0 0}(,) = = &nbsp;. <span class="math display">\[
Next, when $\ell = 1$ we have $m=-1,0,1$. The associated multipole moments are evidently
\]</span> <span class="math display">\[\begin{align*}
q_{10} &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' Y_{10}^*(\theta',\varphi') = \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \cos\theta \ , \\
q_{1,\pm1} &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' Y_{1,\pm 1}^*(\theta',\varphi') = \mp \sqrt{\frac{3}{8\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \sin\theta e^{\mp i\varphi} \ .
\end{align*}\]</span> <span class="math display">\[
Writing $e^{\pm i\varphi} = \cos\varphi \pm i \sin\varphi$, and converting the spherical coordinates $(r',\theta',\varphi')$ to Cartesian coordinates $(x',y',z')$, we get
\]</span> <span class="math display">\[\begin{align*}
q_{10} &amp;= \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \cos\theta = \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') z' \ , \\
q_{1,\pm 1} &amp;= \mp \sqrt{\frac{3}{8\pi}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \sin\theta (\cos\varphi \mp i \sin\varphi) = \mp \sqrt{\frac{3}{8\pi}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') (x' \mp iy') \ .
\end{align*}\]</span> <span class="math display">\[
Now, notice each of these moments is proportional to some component of the dipole moment $\mathbf{p}$, with
\]</span> q_{10} = p_z , q_{1,} = (p_x i p_y) &nbsp;. <span class="math display">\[
If we plug these into the potential with $\ell = 1$ and simplify, we thus have
\]</span> <span class="math display">\[\begin{align*}
\phi^{(1)}(\mathbf{x}) &amp;= \frac{4\pi}{3r^2} \big[q_{1,-1} Y_{1,-1}(\theta,\varphi) + q_{10} Y_{10}(\theta,\varphi) + q_{11} Y_{11}(\theta,\varphi)\big] \\
&amp;= \frac{4\pi}{3r^2} \bigg[\frac{3}{8\pi} \sin\theta e^{-i\varphi} (p_x + i p_y) + \frac{3}{4\pi} \cos\theta p_z + \frac{3}{8\pi} \sin\theta e^{i\varphi} (p_x - i p_y) \bigg] \\
&amp;= \frac{1}{r^2} \bigg[\frac{1}{2} \sin\theta (\cos\varphi - i\sin\varphi) (p_x + i p_y) + \cos\theta p_z + \frac{1}{2} \sin\theta (\cos\varphi + i\sin\varphi) (p_x - i p_y)\bigg] \\
&amp;= \frac{1}{r^2} \big[x p_x + y p_y + z p_z \big] \ .
\end{align*}\]</span> <span class="math display">\[
Notice that the imaginary parts all vanished from this potential. What we're left with is just the usual dipole potential,
\]</span> ^{(1)}() = &nbsp;. <span class="math display">\[
Finally, let's look at the $\ell=2$ expansion terms. In this case $m=-2,-1,0,1,2$, which means there will be five terms,
\]</span> ^{(2)}() = &nbsp;. <span class="math display">\[
Using the same logic as we did before with the dipole term, one can show that these spherical moments can be written in terms of the usual quadrupole tensor components $Q_{ij}$ as
\]</span> <span class="math display">\[\begin{align*}
q_{20} &amp;= \frac{1}{2} \sqrt{\frac{5}{4\pi}} Q_{zz} \ , \\
q_{2,\pm 1} &amp;= \mp \frac{1}{3} \sqrt{\frac{15}{8\pi}} (Q_{xz} \mp 2i Q_{yz}) \ , \\
q_{2,\pm 2} &amp;= \frac{1}{12} \sqrt{\frac{15}{2\pi}} (Q_{xx} - Q_{yy} \mp 2i Q_{xy}) \ ,
\end{align*}\]</span> <span class="math display">\[
Plugging these into the $\ell=2$ potential and simplifying, we'll eventually end up with the usual quadrupole potential,
\]</span> ^{(2)}() = = &nbsp;. $$ This suggests the spherical multipole expansion agrees with the Cartesian expansion, with each fixed <span class="math inline">\(\ell\)</span> corresponding to the <span class="math inline">\(\ell\)</span><sup>th</sup> Cartesian multipole potential. Moreover, each spherical multipole moment corresponds to the <span class="math inline">\(2\ell+1\)</span> irreducible components of the corresponding <span class="math inline">\(\ell\)</span><sup>th</sup> Cartesian multipole moment. In this sense, the spherical multipole expansion is more natural than the Cartesian multipole expansion, since the irreducible components of each moment are already transparent in the formula.</p>
</section>
<section id="azimuthally-symmetric-distributions" class="level3">
<h3 class="anchored" data-anchor-id="azimuthally-symmetric-distributions">Azimuthally Symmetric Distributions</h3>
<p>It turns out that if a charge distribution is azimuthally symmetric, then all the Cartesian multipole moments reduce to scalars. We can prove this pretty easily using the spherical multipole expansion. If a charge distribution is azimuthally symmetric we can orient it normal to the <span class="math inline">\(z\)</span>-axis and write <span class="math inline">\(\rho(\mathbf{x}') = \rho(r',\theta')\)</span>. This means we can write spherical multipole moments in the form <span class="math display">\[
q_{\ell m} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell Y_{\ell m}^*(\theta',\varphi') = \int r'^2 \sin\theta' dr' d\theta' \ \rho(r', \theta') r'^\ell \int_0^{2\pi} d\varphi' \ Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Now, by definition <span class="math inline">\(Y_{\ell m}(\theta',\varphi') \propto P_\ell^m(\cos\theta') e^{im\varphi'}\)</span>, where <span class="math inline">\(P_\ell^m(\cos\theta')\)</span> is an associated Legendre polynomial. This means <span class="math display">\[
\int_0^{2\pi} d\varphi' \ Y_{\ell m}^*(\theta',\varphi') \propto \int_0^{2\pi} d\varphi' \ e^{-im\varphi'} = 2\pi \delta_{m0} \ .
\]</span> Thus, all <span class="math inline">\(q_{\ell m}\)</span> will vanish except those when <span class="math inline">\(m=0\)</span>. To handle the <span class="math inline">\(m=0\)</span> case, recall from the appendix that <span class="math display">\[
Y_{\ell 0}(\theta',\varphi') = Y_{\ell 0}^*(\theta',\varphi') = \sqrt{\frac{2\ell+1}{4\pi}} P_\ell(\cos\theta') \ .
\]</span> Plugging this in, the only non-vanishing spherical multipole moments are thus <span class="math display">\[
q_{\ell 0} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell Y_{\ell 0}^*(\theta',\varphi') = \sqrt{\frac{2\ell+1}{4\pi}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell P_\ell(\cos\theta') \ .
\]</span> Plugging these moments back into the spherical multipole expansion and writing <span class="math inline">\(Y_{\ell 0}(\theta,\varphi)\)</span> in terms of the Legendre polynomial <span class="math inline">\(P_\ell(\cos\theta)\)</span> the same way we did above, we thus have <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \frac{1}{r^{\ell+1}} q_{\ell 0} Y_{\ell 0}(\theta,\varphi) = \sum_{\ell=0}^\infty \frac{1}{r^{\ell+1}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell P_\ell(\cos\theta') \ .
\]</span></p>
<p>Now, notice that each integral is a scalar depending only on the source points. We can thus define <em>scalar multipole moments</em> by <span class="math display">\[
Q_\ell \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell P_\ell(\cos\theta') \ .
\]</span> Then for an azimuthally symmetric charge distribution, we have a simple multipole expansion of the form <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{Q_\ell}{r^{\ell+1}} P_\ell(\cos\theta) \ .
\]</span> It’s worth comparing this to the Cartesian expansion we derived before. The <span class="math inline">\(\ell = 0\)</span> moment <span class="math inline">\(Q_0\)</span> evidently corresponds exactly to the monopole moment <span class="math inline">\(q\)</span>. The <span class="math inline">\(\ell = 1\)</span> moment can be related to the dipole moment by noting <span class="math inline">\(P_1(\cos\theta) = \cos\theta\)</span>, which means <span class="math display">\[
Q_1 = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \cos\theta' = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') z' = p_z \ .
\]</span> Thus, <span class="math inline">\(Q_1\)</span> is just the <span class="math inline">\(z\)</span>-component of the dipole moment. Plugging this into the <span class="math inline">\(\ell=1\)</span> potential and simplifying, we have <span class="math display">\[
\phi^{(1)}(\mathbf{x}) = \frac{Q_1}{r^2} P_1(\cos\theta) = \frac{p_z}{r^2} \cos\theta = \frac{z p_z}{r^2} \ .
\]</span> Evidently the dipole moment <span class="math inline">\(\mathbf{p}\)</span> reduces to <span class="math inline">\(\mathbf{p} = p_z \mathbf{e}_z\)</span> for an azimuthally symmetric potential oriented normal to the <span class="math inline">\(z\)</span>-axis.</p>
<p>In a similar manner, the <span class="math inline">\(\ell=2\)</span> scalar multipole moment can be related to the quadrupole moment. Plugging in the <span class="math inline">\(\ell=2\)</span> Legendre polynomial and rewriting in Cartesian coordinates, we have <span class="math display">\[
\begin{align*}
Q_2 &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^2 P_2(\cos\theta') \\
&amp;= \frac{1}{2} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^2 (3\cos^2\theta' - 1) \\
&amp;= \frac{1}{2} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') (3z'^2 - r'^2) \\
&amp;= \frac{1}{2} Q_{zz} \ .
\end{align*}
\]</span> Plugging this into the <span class="math inline">\(\ell=2\)</span> potential and simplifying, we have <span class="math display">\[
\phi^{(2)}(\mathbf{x}) = \frac{Q_2}{r^3} P_2(\cos\theta) = \frac{Q_{zz}}{2r^3} \frac{3\cos^2\theta - 1}{2} = \frac{Q_{zz}}{2r^5} \bigg(z^2 - \frac{x^2 + y^2}{2}\bigg) \ .
\]</span> This evidently implies that the off-diagonal terms of the quadrupole tensor all vanish, and <span class="math inline">\(Q_{zz} = -2 Q_{xx} = -2 Q_{yy}\)</span>. That is, for an azimuthally symmetric distribution the quadrupole tensor reduces to a single independent component, namely <span class="math inline">\(Q_{zz}\)</span> when oriented along the <span class="math inline">\(z\)</span>-axis. We saw this before with the ring of charge example.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../electrodynamics/bvps-2.html" class="pagination-link" aria-label="Boundary Value Problems II">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Boundary Value Problems II</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../electrodynamics/magnetostatics.html" class="pagination-link" aria-label="Magnetostatics">
        <span class="nav-page-text"><span class="chapter-title">Magnetostatics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>