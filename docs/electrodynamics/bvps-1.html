<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personal Notes - Boundary Value Problems I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../electrodynamics/bvps-2.html" rel="next">
<link href="../electrodynamics/electrostatics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-1.html"><span class="chapter-title">Boundary Value Problems I</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Classical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/newtonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Newtonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/simple-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Simple Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/reference-frames.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Reference Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/lagrangian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lagrangian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/hamiltonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Hamiltonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/central-forces.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Central Forces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/coupled-oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Coupled Oscillations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/rigid-bodies.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rigid Bodies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/canonical-transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Canonical Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/integrability-and-chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Integrability and Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/continuum-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Continuum Mechanics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Electromagnetism</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/preliminaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/electrostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Electrostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Boundary Value Problems I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/multipole-expansion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Multipole Expansion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/magnetostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Magnetostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/maxwell-equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Maxwell’s Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/orthogonal-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix I: Orthogonal Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/complex-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix II: Complex Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Circuit Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/circuit-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Lumped Circuit Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Analyzing Circuits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/nonlinear-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nonlinear Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/digital-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Digital Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/amplifiers.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/first-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">First-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/second-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/ac-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">AC Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/op-amps.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Operational Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/energy-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Energy and Power</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Quantum Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/identical-particles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Identical Particles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/second-quantization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second Quantization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/thermodynamics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Thermodynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/kinetic-theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Kinetic Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Gases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Gases</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#poissons-equation" id="toc-poissons-equation" class="nav-link active" data-scroll-target="#poissons-equation">Poisson’s Equation</a></li>
  <li><a href="#greens-functions" id="toc-greens-functions" class="nav-link" data-scroll-target="#greens-functions">Green’s Functions</a>
  <ul class="collapse">
  <li><a href="#greens-function-solution-via-the-fourier-transform" id="toc-greens-function-solution-via-the-fourier-transform" class="nav-link" data-scroll-target="#greens-function-solution-via-the-fourier-transform">Green’s Function Solution via the Fourier Transform</a></li>
  <li><a href="#formal-solution-to-poissons-equation" id="toc-formal-solution-to-poissons-equation" class="nav-link" data-scroll-target="#formal-solution-to-poissons-equation">Formal Solution to Poisson’s Equation</a></li>
  <li><a href="#uniqueness-theorem" id="toc-uniqueness-theorem" class="nav-link" data-scroll-target="#uniqueness-theorem">Uniqueness Theorem</a></li>
  <li><a href="#greens-function-with-boundary-conditions" id="toc-greens-function-with-boundary-conditions" class="nav-link" data-scroll-target="#greens-function-with-boundary-conditions">Green’s Function with Boundary Conditions</a></li>
  <li><a href="#greens-functions-in-other-dimensions" id="toc-greens-functions-in-other-dimensions" class="nav-link" data-scroll-target="#greens-functions-in-other-dimensions">Green’s Functions in Other Dimensions</a></li>
  </ul></li>
  <li><a href="#method-of-images" id="toc-method-of-images" class="nav-link" data-scroll-target="#method-of-images">Method of Images</a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#greens-function-for-a-sphere" id="toc-greens-function-for-a-sphere" class="nav-link" data-scroll-target="#greens-function-for-a-sphere">Green’s Function for a Sphere</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-1.html"><span class="chapter-title">Boundary Value Problems I</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Boundary Value Problems I</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p>In this chapter and the next, we will continue on with the subject of electrostatics by solving electrostatics problems in the presence of boundary conditions. These are called <em>boundary value problems</em>, or BVPs. Many of the things we cover in these two chapters will also apply to other areas of electromagnetism as well, like magnetostatics and electrodynamics, with minor modifications here and there that we’ll touch on in future chapters.</p>
<p>In this chapter, we will derive the formal solution for Poisson’s equation using the theory of Green’s functions. Once we’ve done that, we will introduce the closely-related method of images, a technique that can be used to solve electrostatics problems when there are certain symmetries present.</p>
<section id="poissons-equation" class="level2">
<h2 class="anchored" data-anchor-id="poissons-equation">Poisson’s Equation</h2>
<p>We saw in the previous chapter that we can in principle calculate the scalar potential <span class="math inline">\(\phi\)</span> due to the presence of a localized charge distribution <span class="math inline">\(\rho\)</span> by evaluating the following integral, <span class="math display">\[
\phi(\mathbf{x}) = \int d^3 \mathbf{x}' \ \frac{\rho(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> In principle, this integral formula will work as long as the charge distribution is localized, there are no other sources of charge, and we’ve already specified in advance what the charge density <span class="math inline">\(\rho(\mathbf{x}')\)</span> actually is. Unfortunately, in practice there are often other sources of charge present, and we often don’t know what the charge density is for those. For example, there may be background conductors or other charged materials present that are too difficult to model, but we know the potential on those surfaces. We can model situations like this by incorporating them into the problem as <em>boundary conditions</em>.</p>
<p>Recall from the previous chapter that we can express the solution for the potential in an equivalent way to the integral given above via a partial differential equation (PDE) known as <em>Poisson’s Equation</em>, <span class="math display">\[
\nabla^2 \phi = -4\pi\rho \ .
\]</span> As we can clearly see, Poisson’s equation is a linear, second-order PDE that depends only on spatial coordinates. Note that in the absence of source charges, Poisson’s equation reduces to another important equation we’ll study known as <em>Laplace’s Equation</em>, <span class="math display">\[
\nabla^2 \phi = 0 \ .
\]</span> To solve Poisson’s equation, it’s sufficient to specify some set of <em>boundary conditions</em>, or conditions that the solution must satisfy on some given boundary surface <span class="math inline">\(\mathcal{S}\)</span>. We imagine the charge distribution <span class="math inline">\(\rho\)</span> lies inside the surface <span class="math inline">\(\mathcal{S}\)</span>, which may or may not be closed. On the surface, we know before-hand that some condition is satisfied, for example the value of the potential or the electric field on <span class="math inline">\(\mathcal{S}\)</span>.</p>
<p>A problem of this kind is known as a <em>boundary value problem</em> or BVP. The entire goal of this chapter and the next will be devoted to solving BVPs of this type in various ways. The first way we will do so is via Green’s function methods.</p>
</section>
<section id="greens-functions" class="level2">
<h2 class="anchored" data-anchor-id="greens-functions">Green’s Functions</h2>
<p>We will now introduce the idea of a <em>Green’s Function</em>, which is a very useful and important concept in electromagnetism and many other field theories, as well as the theory of partial differential equations. We’ll see that the Green’s function provides a general method for solving Poisson’s equation, and indeed for solving any linear differential equation.</p>
<p>We already know that for a localized charge distribution in the absense of boundary conditions that the potential can be found by <span class="math display">\[
\phi(\mathbf{x}) = \int d^3 \mathbf{x}' \ \frac{\rho(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> If we look at this integral more closely we can see that it’s really just a convolution of two functions, <span class="math inline">\(\rho(\mathbf{x}')\)</span> and another function <span class="math display">\[
\boxed{
G(\mathbf{x} - \mathbf{x}') \equiv \frac{1}{|\mathbf{x} - \mathbf{x}'|}
}\ .
\]</span> This function <span class="math inline">\(G(\mathbf{x} - \mathbf{x}')\)</span> is called a <em>Green’s Function</em>. This function is evidently a property of the PDE itself, and doesn’t depend on any charge distributions or boundary conditions. So where does this function come from?</p>
<p>Suppose we wanted to solve Poisson’s equation for a single unit point charge located at a source point <span class="math inline">\(\mathbf{x}'\)</span>. Since <span class="math inline">\(q=1\)</span> this means that <span class="math inline">\(\rho(\mathbf{x}) = \delta(\mathbf{x} - \mathbf{x}')\)</span>. The potential <span class="math inline">\(G(\mathbf{x} - \mathbf{x}')\)</span> that solves this Poisson’s equation in the absence of any boundary conditions is known as a <em>Green’s function</em>, <span class="math display">\[
\nabla^2 G(\mathbf{x} - \mathbf{x}') = -4\pi \delta(\mathbf{x} - \mathbf{x}') \ .
\]</span> Now, suppose as suggested above that we could recover the potential <span class="math inline">\(\phi\)</span> from the Green’s function by convolution with the charge density <span class="math inline">\(\rho\)</span>, <span class="math display">\[
\phi(\mathbf{x}) = \int d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') \ .
\]</span> If we take the Laplacian of <span class="math inline">\(\phi(\mathbf{x})\)</span>, we then have <span class="math display">\[
\begin{align*}
\nabla^2 \phi(\mathbf{x}) &amp;= \nabla^2 \int d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') \\
&amp;= \int d^3 \mathbf{x}' \ \rho(\mathbf{x}') \nabla^2 G(\mathbf{x} - \mathbf{x}') \\
&amp;= -4\pi \int d^3 \mathbf{x}' \ \rho(\mathbf{x}') \delta(\mathbf{x} - \mathbf{x}') \\
&amp;= -4\pi \rho(\mathbf{x}) \ .
\end{align*}
\]</span> This proves that given the Green’s function, we can use it to find the potential for any given charge distribution by convolution.</p>
<section id="greens-function-solution-via-the-fourier-transform" class="level3">
<h3 class="anchored" data-anchor-id="greens-function-solution-via-the-fourier-transform">Green’s Function Solution via the Fourier Transform</h3>
<p>Since we already know that the Green’s function for Poisson’s equation must be given by <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \frac{1}{|\mathbf{x} - \mathbf{x}'|} \ ,
\]</span> we could just skip ahead to the next section. However, we want to derive the Green’s function yet another way that’s more broadly applicable, namely via the Fourier transform. We cover the mathematical details of the Fourier transform in the appendix, so feel free to stop and read over that first before proceeding.</p>
<p>Let’s suppose that we wished to solve Poisson’s equation for a unit point charge placed at the origin, <span class="math display">\[
\nabla^2 G(\mathbf{x}) = -4\pi \delta(\mathbf{x}) \ ,
\]</span> We’ll assume that both <span class="math inline">\(G(\mathbf{x})\)</span> and its normal derivative go to zero as <span class="math inline">\(|\mathbf{x}| \rightarrow \infty\)</span>, a physically realistic assumption.</p>
<p>Now, we take the Fourier transform of both sides to get the Green’s function as a function of the wavevector <span class="math inline">\(\mathbf{k}\)</span>. That is, we multiply both sides by <span class="math inline">\(e^{-i \mathbf{k} \cdot \mathbf{x}}\)</span> and integrate with respect to <span class="math inline">\(\mathbf{x}\)</span> over all space, <span class="math display">\[
\int d^3\mathbf{x} \ \nabla^2 G(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x}} = -4\pi \int d^3\mathbf{x} \ \delta(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x}} \ .
\]</span> Now, the right-hand side is easy to work out. By definition of the delta function we get <span class="math inline">\(-4\pi e^{-i \mathbf{k} \cdot \mathbf{0}} = -4\pi\)</span>. The left-hand side is more interesting. Those familiar with the Fourier transform will immediately see it must be <span class="math inline">\(-|\mathbf{k}|^2 G(\mathbf{k})\)</span>, where <span class="math inline">\(G(\mathbf{k})\)</span> is the Fourier transform of <span class="math inline">\(G(\mathbf{x})\)</span> defined by <span class="math display">\[
G(\mathbf{k}) = \int d^3\mathbf{x} \ G(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x}} \ .
\]</span> Let’s prove this real quick. If we apply Green’s second identity to the left-hand side above and require that <span class="math inline">\(G(\mathbf{x})\)</span> go to zero as <span class="math inline">\(|\mathbf{x}| \rightarrow \pm \infty\)</span>, then the boundary terms vanish, leaving us with <span class="math display">\[
\begin{align*}
\int d^3\mathbf{x} \ \nabla^2 G(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x}} &amp;=
\int d^3\mathbf{x} \ G(\mathbf{x}) \nabla^2 e^{-i \mathbf{k} \cdot \mathbf{x}} +
\oint_\mathcal{S} da \ \bigg[e^{-i \mathbf{k} \cdot \mathbf{x}} \frac{\partial G}{\partial n} - G \frac{\partial}{\partial n} e^{-i \mathbf{k} \cdot \mathbf{x}} \bigg] \\
&amp;= -|\mathbf{k}|^2 \int d^3\mathbf{x} \ G(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x}} \\
&amp;= -|\mathbf{k}|^2 G(\mathbf{k}) \ .
\end{align*}
\]</span> Putting both sides together, we end up with an algebraic equation in <span class="math inline">\(k\)</span>-space that’s easily solved for <span class="math inline">\(G(\mathbf{k})\)</span>,</p>
<p><span class="math display">\[
-|\mathbf{k}|^2 G(\mathbf{k}) = -4\pi \quad \Longrightarrow \quad G(\mathbf{k}) = \frac{4\pi}{|\mathbf{k}|^2} \ .
\]</span> Now, we want the Green’s function in terms of <span class="math inline">\(\mathbf{x}\)</span>, not in terms of <span class="math inline">\(\mathbf{k}\)</span>. We can get that by now taking the inverse Fourier transform. That is, we multiply <span class="math inline">\(G(\mathbf{k})\)</span> by <span class="math inline">\(\frac{1}{(2\pi)^3} e^{i \mathbf{k} \cdot \mathbf{x}}\)</span> and integrate with respect to <span class="math inline">\(\mathbf{k}\)</span> over all <span class="math inline">\(k\)</span>-space to get <span class="math display">\[
G(\mathbf{x}) = \int \frac{d^3\mathbf{k}}{(2\pi)^3} \ G(\mathbf{k}) e^{-i \mathbf{k} \cdot \mathbf{x}}
= 4\pi \int \frac{d^3\mathbf{k}}{(2\pi)^3} \ \frac{e^{-i \mathbf{k} \cdot \mathbf{x}}}{|\mathbf{k}|^2} \ .
\]</span> We’re now left with an integral to evaluate that’s quite non-trivial. First, we observe that the integrand depends on two things, the squared norm <span class="math inline">\(|\mathbf{k}|^2\)</span> and the dot product <span class="math inline">\(\mathbf{k} \cdot \mathbf{x}\)</span>. Now, we’re free to orient <span class="math inline">\(\mathbf{x}\)</span> along any direction of <span class="math inline">\(k\)</span>-space we like. Without loss of generality then, let’s suppose <span class="math inline">\(\mathbf{x}\)</span> is oriented along the <span class="math inline">\(k_z\)</span>-axis, so that <span class="math inline">\(\mathbf{x} = r \mathbf{e}_{k_z}\)</span>. Then <span class="math inline">\(\mathbf{k} \cdot \mathbf{x} = kr\cos\theta_k\)</span>, where <span class="math inline">\(k = |\mathbf{k}|\)</span> and <span class="math inline">\(\theta_k\)</span> is the usual polar angle of spherical coordinates in <span class="math inline">\(k\)</span>-space. This strongly suggests we should do the integration in <span class="math inline">\(k\)</span>-space spherical coordinates <span class="math inline">\((k, \theta_k, \varphi_k)\)</span>. This means the volume element <span class="math inline">\(d^3\mathbf{k}\)</span> becomes <span class="math display">\[
d^3 \mathbf{k} = k^2 \sin\theta_k dk d\theta_k d\phi_k \ .
\]</span> Plugging this all into the integral and evaluating the trivial integral over <span class="math inline">\(\varphi_k\)</span>, we thus have <span class="math display">\[
G(\mathbf{x}) = 4\pi \int_0^\infty dk \int_0^\pi d\theta_k \int_0^{2\pi} d\varphi_k \ \frac{k^2 \sin\theta_k}{(2\pi)^3} \frac{e^{-i kr \cos\theta_k}}{k^2} = \frac{1}{\pi} \int_0^\infty dk \int_0^\pi d\theta_k \ \sin\theta_k \ e^{-i kr \cos\theta_k} \ .
\]</span> Next, we need to evaluate the integral over <span class="math inline">\(\theta_k\)</span>. This is most easily done by making the useful substitution <span class="math inline">\(\mu = \cos\theta_k\)</span> to get <span class="math display">\[
G(\mathbf{x}) = \frac{1}{\pi} \int_0^\infty dk \int_{-1}^1 d\mu \ e^{-i kr \mu} = \frac{1}{\pi} \int_0^\infty dk \ \frac{e^{-ikr} - e^{ikr}}{-ikr} = \frac{2}{\pi} \int_0^\infty dk \ \frac{\sin kr}{kr} \ .
\]</span> All that remains now is the integral over <span class="math inline">\(k\)</span>. We’ll simplify this remaining integral slightly by substituting <span class="math inline">\(u=kr\)</span> to write <span class="math display">\[
G(\mathbf{x}) = \frac{2}{\pi r} \int_0^\infty du \ \frac{\sin u}{u} \ .
\]</span> The remaining integral in <span class="math inline">\(u\)</span> is a well-known integral, known as a <em>Dirichlet integral</em>. Dirichlet integrals can be evaluated any number of ways. In the appendix we showed that we can evaluate this integral using the residue theorem to get <span class="math display">\[
\int_0^\infty du \ \frac{\sin u}{u} = \frac{\pi}{2} \ .
\]</span> Plugging this back into the Green’s function, we finally get <span class="math display">\[
G(\mathbf{x}) = \frac{2}{\pi r} \cdot \frac{\pi}{2} = \frac{1}{r} = \frac{1}{|\mathbf{x}|} \ .
\]</span> This is the Green’s function that solves the equation posed above. Finally, if we shift the source point from the origin to some other source point <span class="math inline">\(\mathbf{x}'\)</span> we recover the general Green’s function derived above, <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \frac{1}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span></p>
<p>This perhaps seemed like a pointless exercise, but we’ll see later that this method for solving PDEs is broadly useful. For example, in a later chapter we’ll need to find the Green’s function for the Helmholtz equation, and for that we’ll need this method.</p>
</section>
<section id="formal-solution-to-poissons-equation" class="level3">
<h3 class="anchored" data-anchor-id="formal-solution-to-poissons-equation">Formal Solution to Poisson’s Equation</h3>
<p>We’ll now derive a formal solution to Poisson’s equation in the presence of boundary conditions. To do so we’ll again make use of Green’s second identity. Recall that Green’s second identity says that for two scalar fields <span class="math inline">\(\psi(\mathbf{x}')\)</span> and <span class="math inline">\(\phi(\mathbf{x}')\)</span>, we have</p>
<p><span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ (\phi \nabla'^2 \psi - \psi \nabla'^2 \phi) = \oint_\mathcal{S} da' \ \bigg[\phi \frac{\partial \psi}{\partial n'} - \psi \frac{\partial \phi}{\partial n'} \bigg] \ .
\]</span> Here <span class="math inline">\(\mathcal{S}\)</span> is some closed surface enclosing a volume <span class="math inline">\(\mathcal{V}\)</span>, and <span class="math inline">\(\frac{\partial \phi}{\partial n'} = \nabla' \phi \cdot \mathbf{n}'\)</span> is the normal derivative of <span class="math inline">\(\phi\)</span> across the surface. We write the identity in terms of the source point <span class="math inline">\(\mathbf{x}'\)</span> since that’s what will be useful for us here.</p>
<p>Now, what we’ll do is set <span class="math inline">\(\psi(\mathbf{x}') = G(\mathbf{x} - \mathbf{x}')\)</span> and <span class="math inline">\(\phi(\mathbf{x}')\)</span> equal to the potential to get <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ (\phi \nabla'^2 G - G \nabla'^2 \phi) = \oint_\mathcal{S} da' \ \bigg[\phi \frac{\partial G}{\partial n'} - G \frac{\partial \phi}{\partial n'} \bigg] \ .
\]</span> Next, we’ll simplify the left-hand side by using Poisson’s equation to write <span class="math inline">\(\nabla'^2 \phi = -4\pi\rho\)</span> and the property of the Green’s function derived above to write <span class="math inline">\(\nabla'^2 G = -4\pi\delta(\mathbf{x}-\mathbf{x}')\)</span>. Plugging these in and rearranging terms, we have <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ \phi(\mathbf{x}') \delta(\mathbf{x}-\mathbf{x}') = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G}{\partial n'} \bigg] \ .
\]</span> Now, we can evaluate the left-hand side of this integral. If <span class="math inline">\(\mathbf{x}\)</span> is outside the surface the left-hand side is zero and we get nowhere. However, if <span class="math inline">\(\mathbf{x}\)</span> is inside the surface we can use the definition of the delta function to write <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G}{\partial n'} \bigg]
}\ .
\]</span> Provided we interpret <span class="math inline">\(\mathcal{S}\)</span> as the <em>boundary surface</em> we have exactly what we seek, a formal solution for the potential in the presence of boundary conditions acting along the boundary surface. The surface integral term encodes all the information contained in the boundary conditions. Indeed, if we send the boundary surface to infinity the surface integral goes to zero like <span class="math inline">\(r'^{-3}\)</span>, and we recover our original integral formula for the potential.</p>
<p>So what exactly is the surface integral encoding? Notice that it contains two terms, one proportional to the <em>value</em> of the potential along the boundary surface, and another proportional to the <em>normal derivative</em> of the potential along the boundary surface. Since we can write the normal derivative in terms of the electric field via <span class="math display">\[
\frac{\partial \phi}{\partial n'} = \nabla' \phi \cdot \mathbf{n}' = -\mathbf{E} \cdot \mathbf{n}' \ ,
\]</span> the normal derivative term is just encoding information about the value of the <em>electric field</em> along the boundary surface.</p>
<p>We can also see that if there are no source charges present inside the boundary surface we can still find an expression for the potential. It’s just the surface integral term. This means we need not have a source charge distribution present at all. We can just specify everything in terms of boundary conditions if we like. If there are no source charges present, Poisson’s equation reduces to a simpler PDE known as <em>Laplace’s Equation</em>, <span class="math display">\[
\nabla^2 \phi = 0 \ .
\]</span> We can solve many electrostatics problems just by solving Laplace’s equation subject to boundary conditions, allowing us to avoid having to specify ahead what the charge distributions are. We’ll return to this idea later.</p>
</section>
<section id="uniqueness-theorem" class="level3">
<h3 class="anchored" data-anchor-id="uniqueness-theorem">Uniqueness Theorem</h3>
<p>In fact, the formal solution we derived above is redundant. We don’t need all of the information encoded in the surface integral to solve Poisson’s equation. It turns out we only need one of the two terms, either the value term or the normal derivative term. In fact, including both terms as boundary conditions can result in the problem having no solution at all.</p>
<p>When we solve Poisson’s equation with only the <em>value</em> of the potential specified on the boundary surface, we say we are using <em>Dirichlet boundary conditions</em>. In a Dirichlet problem, we seek to solve the <em>boundary value problem</em> (BVP) <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi = -4\pi\rho \ , \\
\text{where} \ \phi = \phi_0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> On the other hand, when we solve Poisson’s equation with only the <em>normal derivative</em> specified on the boundary surface, we say we are using <em>Neumann boundary conditions</em>. In a Neumann problem, we seek to solve the BVP <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi = -4\pi\rho \ , \\
\text{where} \ \frac{\partial \phi}{\partial n'} = -E_0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> Here <span class="math inline">\(E_0\)</span> is used to denote the value of the electric field normal to the boundary surface, i.e.&nbsp;<span class="math inline">\(E_0 = \mathbf{E} \cdot \mathbf{n}'\)</span>.</p>
<p>We will now show that provided either Cauchy or Neumann boundary conditions are used, the Poisson equation with boundary conditions will yield a unique solution for the potential. Suppose we have two solutions <span class="math inline">\(\phi_1\)</span> and <span class="math inline">\(\phi_2\)</span> to Poisson’s equation subject to either Cauchy or Neumann boundary conditions, but not both. That is, we have <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi_1 = \nabla^2 \phi_2 = -4\pi\rho \ , \\
\text{where} \ \phi_1 = \phi_2 = \phi_0 \ \text{on} \ \mathcal{S} \ , \\
\text{or} \ \frac{\partial \phi_1}{\partial n'} = \frac{\partial \phi_1}{\partial n'} = -E_0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> Now, let <span class="math inline">\(u = \phi_2 - \phi_1\)</span>. Then <span class="math inline">\(\nabla^2 u = 0\)</span> by linearity and either <span class="math inline">\(u\)</span> or <span class="math inline">\(\frac{\partial u}{\partial n'}\)</span> equal zero along the boundary surface, so we have <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 u = 0 \ , \\
\text{where} \ u = 0 \ \text{on} \ \mathcal{S} \ , \\
\text{or} \ \frac{\partial u}{\partial n'} = 0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> This means the BVP for <span class="math inline">\(u\)</span> involves only solving Laplace’s equation subject to the condition that either <span class="math inline">\(u\)</span> vanishes along the boundary or its normal derivative does.</p>
<p>Next we’ll employ Green’s first identity. Recall from the first chapter that this identity says <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ (\nabla' \psi \cdot \nabla' \phi + \psi \nabla'^2 \phi) = \oint_\mathcal{S} da' \ \psi \frac{\partial \phi}{\partial n'} \ .
\]</span> Again we interpret this identity as <span class="math inline">\(\mathcal{S}\)</span> being a closed boundary surface enclosing a volume <span class="math inline">\(\mathcal{V}\)</span>, and each scalar field being a function of the source position <span class="math inline">\(\mathbf{x}'\)</span>. What we’ll do this time is let <span class="math inline">\(u = \psi = \phi\)</span> in this equation to get <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ \big((\nabla' u)^2 + u \nabla'^2 u\big) = \oint_\mathcal{S} da' \ u \frac{\partial u}{\partial n'} \ .
\]</span> Now, according to Laplace’s equation <span class="math inline">\(\nabla'^2 u = 0\)</span>. Also, according to the boundary conditions, either <span class="math inline">\(u\)</span> or <span class="math inline">\(\frac{\partial u}{\partial n'}\)</span> must vanish on the boundary surface, which means the surface integral on the right-hand side must also vanish. We’re thus left with <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x}' \ |\nabla' u|^2 = 0 \ .
\]</span> Finally, since <span class="math inline">\(|\nabla' u|^2\)</span> is strictly non-negative, the integral can only vanish if its integrand does. This means we must have <span class="math display">\[
\nabla' u = 0 \ .
\]</span> The only way the gradient can vanish is if <span class="math inline">\(u\)</span> is constant, meaning <span class="math inline">\(u = \phi_2 - \phi_1 + \text{const}\)</span>. Under Dirichlet boundary conditions, this additive constant must in fact be zero since if <span class="math inline">\(\nabla' u = 0\)</span> and <span class="math inline">\(u = 0\)</span> on the boundary, then <span class="math inline">\(u=0\)</span> everywhere. Under Neumann boundary conditions, however, this additive constant can be anything.</p>
<p>In either case it’s physically immaterial what the additive constant is. Since the physical quantity of interest is the electric field, the additions of an additive constant to the potential doesn’t physically matter. All together, this means that the solution to Poisson’s equation subject to either Cauchy or Neumann boundary conditions must be unique up to an unimportant constant, which is what we wanted to show.</p>
<p>Note that the same proof holds if the problem has <em>mixed boundary conditions</em>, where on some parts of the boundary surface the potential is specified, and on other parts the normal derivative is specified. In this case, we only need to break the boundary up into these two pieces and argue the proof for each part.</p>
</section>
<section id="greens-function-with-boundary-conditions" class="level3">
<h3 class="anchored" data-anchor-id="greens-function-with-boundary-conditions">Green’s Function with Boundary Conditions</h3>
<p>We derived the Green’s function above under the assumption that no boundary conditions were present, and then later imposed boundary conditions when deriving the formal solution. But we can also define the Green’s function so that the boundary conditions are already backed in. The idea is to generalize the definition of the Green’s function somewhat by supposing <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \frac{1}{|\mathbf{x} - \mathbf{x}'|} + F(\mathbf{x} - \mathbf{x}') \ ,
\]</span> where <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span> is some function that satisfies Laplace’s equation subject to the boundary conditions, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 F(\mathbf{x} - \mathbf{x}') = 0 \ , \\
\text{where} \ F(\mathbf{x} - \mathbf{x}') = 0 \ \text{on} \ \mathcal{S} \ , \\
\text{or} \ \frac{\partial F}{\partial n'} = 0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> We’ll call <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span> the <em>homogeneous part</em> of the Green’s function. Intuitively, we can think of the homogeneous part as the potential of any charge distributions lying beyond the boundary surface. Our goal in this section however isn’t to find <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span>, but to formally show that this generalization of the Green’s function gives formal solutions that aren’t overdetermined.</p>
<p>Consider first the case of a Poisson BVP with Dirichlet boundary conditions. We’ll suppose there exists a Green’s function <span class="math inline">\(G_D(\mathbf{x} - \mathbf{x}')\)</span> that satisfies the BVP <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 G_D(\mathbf{x} - \mathbf{x}') = -4\pi\delta(\mathbf{x} - \mathbf{x}') \ , \\
\text{where} \ G_D(\mathbf{x} - \mathbf{x}') = 0 \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> Now, if we plug this Green’s function into the formal solution for the potential, we get <span class="math display">\[
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_D(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G_D \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G_D}{\partial n'} \bigg] \ .
\]</span> Since <span class="math inline">\(G_D(\mathbf{x} - \mathbf{x}')\)</span> will vanish on the surface <span class="math inline">\(\mathcal{S}\)</span> by assumption, the first term in the surface integral vanishes and we’re left with <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_D(\mathbf{x} - \mathbf{x}') - \frac{1}{4\pi} \oint_\mathcal{S} da' \ \phi \frac{\partial G_D}{\partial n'}
}\ .
\]</span> We’ve thus used this generalized Green’s function to eliminate the boundary term we don’t care about from the formal solution. What remains is the formal solution for a potential under Dirichlet boundary conditions.</p>
<p>We can do something similar for a Poisson BVP with Neumann boundary conditions, except we have to be slightly more careful. Suppose there exists a Green’s function <span class="math inline">\(G_N\)</span> that satisfies the BVP <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 G_N(\mathbf{x} - \mathbf{x}') = -4\pi\delta(\mathbf{x} - \mathbf{x}') \ , \\
\text{where} \ \frac{\partial G_N}{\partial n'} = C \ \text{on} \ \mathcal{S} \ .
\end{cases}
\end{align*}
\]</span> Notice that we let <span class="math inline">\(\frac{\partial G_N}{\partial n'}\)</span> equal some arbitrary constant <span class="math inline">\(C\)</span> along the boundary instead of setting it to zero. To understand why we did this, recall that the normal derivative of a potential <span class="math inline">\(\phi\)</span> is proportional to the component of the electric field normal to the surface, with <span class="math inline">\(\frac{\partial \phi}{\partial n'} = -\mathbf{E} \cdot \mathbf{n}'\)</span>. Since the electric field must satisfy Gauss’s Law, this means if we integrate over <span class="math inline">\(\mathcal{S}\)</span> we must have <span class="math display">\[
\oint_\mathcal{S} da' \ \frac{\partial \phi}{\partial n'} = -\oint_\mathcal{S} \mathbf{E} \cdot \mathbf{n}' \ da' = -4\pi Q_{\text{enc}} \ .
\]</span> Now, we can think of the Green’s function as the potential of a unit point charge. This means if we substitute <span class="math inline">\(\phi\)</span> for <span class="math inline">\(G_N\)</span> and set <span class="math inline">\(Q_{\text{enc}} = 1\)</span>, we’re left with <span class="math display">\[
\oint_\mathcal{S} da' \ \frac{\partial G_N}{\partial n'} = -4\pi \ .
\]</span> This implies that whatever the normal derivative is doing along the boundary surface, it must have the form <span class="math display">\[
\frac{\partial G_N}{\partial n'} = -\frac{4\pi}{S} \ \text{on} \ \mathcal{S} \ .
\]</span> We’ll thus choose this as our boundary condition for the Neumann BVP, setting the constant <span class="math inline">\(C = -\frac{4\pi}{S}\)</span>.</p>
<p>Plugging this form of <span class="math inline">\(G_N\)</span> into the formal solution and substituting in the above boundary condition, we have <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_N(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G_N \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G_N}{\partial n'} \bigg] \\
&amp;= \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_N(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ G_N \frac{\partial \phi}{\partial n'} + \frac{1}{S} \oint_\mathcal{S} da' \phi \ .
\end{align*}
\]</span> Notice the last term is just the average value of the potential along the boundary surface, a constant. We’ll let <span class="math display">\[
\langle \phi \rangle_\mathcal{S} \equiv \frac{1}{S} \oint_\mathcal{S} da' \phi
\]</span> denote this constant term. Like all additive constants, this term is irrelevant to the physics and can be absorbed into the potential if we like. We thus finally have the correct formal solution for a potential under Neumann boundary conditions, <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \langle \phi \rangle_\mathcal{S} + \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_N(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ G_N \frac{\partial \phi}{\partial n'}
} \ .
\]</span> Of course, while having these formal solutions is nice, we still haven’t shown how to find these generalized Green’s functions. In fact, it usually isn’t that helpful to find the generalized Green’s function directly when solving a given problem. Its primary use is theoretical, to show that a formal solution for the potential will always exist under certain types of boundary conditions.</p>
</section>
<section id="greens-functions-in-other-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="greens-functions-in-other-dimensions">Green’s Functions in Other Dimensions</h3>
<p>For the special case of the Laplacian operator, there’s an easier way to find the (unbounded) Green’s function that also happens to work just as easily for any number of dimensions. Let’s again consider Poisson’s equation for the Green’s function free from boundary conditions, but this time we’ll assume <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}'\)</span> are vectors in some arbitrary <span class="math inline">\(n\)</span>-dimensional space. If we ignore the factor of <span class="math inline">\(4\pi\)</span> from before, we can write <span class="math display">\[
\nabla^2 G(|\mathbf{x} - \mathbf{x}'|) = -\delta(\mathbf{x} - \mathbf{x}') \ .
\]</span> Here the Laplacian operator is assumed to be defined in <span class="math inline">\(n\)</span> dimensions as well, i.e.&nbsp;<span class="math inline">\(\nabla^2 = \partial_i \partial_i\)</span> in summation notation.</p>
<p>Let’s now recall the divergence theorem in 3-dimensions, which says for any vector field <span class="math inline">\(\mathbf{F}(\mathbf{x})\)</span> we have <span class="math display">\[
\int_\mathcal{V} d^3 \mathbf{x} \ \nabla \cdot \mathbf{F} = \oint_\mathcal{S} da \ \mathbf{F} \cdot \mathbf{n} \ .
\]</span> This theorem can be written in any number of dimensions if we think of <span class="math inline">\(\mathcal{V}_n\)</span> as an <span class="math inline">\(n\)</span>-dimensional volume and <span class="math inline">\(\mathcal{S}_{n-1}\)</span> as the closed boundary containing that volume in <span class="math inline">\(n\)</span>-dimensional space. Then we have <span class="math display">\[
\int_{\mathcal{V}_n} d^n \mathbf{x} \ \nabla \cdot \mathbf{F} = \oint_{\mathcal{S}_{n-1}} da^{n-1} \ \mathbf{F} \cdot \mathbf{n} \ .
\]</span> Now, let <span class="math inline">\(\mathbf{F} = \nabla G(|\mathbf{x} - \mathbf{x}'|)\)</span>. If we plug this in and integrate with respect to the field point <span class="math inline">\(\mathbf{x}\)</span>. If we do that, the left-hand side becomes an <span class="math inline">\(n\)</span>-dimensional Laplacian <span class="math inline">\(\nabla^2 G\)</span>, while the right-hand side becomes the normal derivative <span class="math inline">\(\frac{\partial G}{\partial n}\)</span> through the <span class="math inline">\((n-1)\)</span>-dimensional surface <span class="math inline">\(\mathcal{S}_{n-1}\)</span>, <span class="math display">\[
\int_{\mathcal{V}_n} d^n \mathbf{x} \ \nabla^2 G = \oint_{\mathcal{S}_{n-1}} da^{n-1} \ \frac{\partial G}{\partial n} \ .
\]</span> Now we’ll apply this divergence theorem to the Poisson’s equation above. If we suppose <span class="math inline">\(\mathcal{V}_n\)</span> is a volume centered at <span class="math inline">\(\mathbf{x}'\)</span> and use the divergence theorem to replace the volume integral with a surface integral, we have <span class="math display">\[
\oint_{\mathcal{S}_{n-1}} da^{n-1} \ \frac{\partial G}{\partial n} = -1 \ .
\]</span> Now, we can pick any Gaussian surface we like so long as its volume includes <span class="math inline">\(\mathbf{x}'\)</span>. Let’s suppose <span class="math inline">\(\mathcal{S}_{n-1}\)</span> is an <span class="math inline">\((n-1)\)</span>-dimensional sphere centered at <span class="math inline">\(\mathbf{x}'\)</span>. If this sphere has a radius <span class="math inline">\(r\)</span>, we can write the area element as <span class="math display">\[
da^{n-1} = r^{n-1} d\Omega^{n-1} \ ,
\]</span> where <span class="math inline">\(d\Omega^{n-1}\)</span> is the <span class="math inline">\((n-1)\)</span>-dimensional solid angle. Since <span class="math inline">\(G(|\mathbf{x}|)\)</span> is radial by assumption, its normal derivative with the sphere will just be its derivative with respect to <span class="math inline">\(r\)</span> and we can pull it out of the integral to write <span class="math display">\[
\oint_{\mathcal{S}_{n-1}} da^{n-1}  \ \frac{\partial G}{\partial n} = r^{n-1}  \frac{\partial G}{\partial r}\oint_{\mathcal{S}_{n-1}} d\Omega^{n-1} = r^{n-1} \frac{\partial G}{\partial r} \Omega_{n-1} \ ,
\]</span> where <span class="math inline">\(\Omega_{n-1}\)</span> is the area of an <span class="math inline">\((n-1)\)</span>-dimensional unit sphere. Putting this all together, we have <span class="math display">\[
\frac{\partial G}{\partial r} = -\frac{1}{\Omega_{n-1} r^{n-1}} \ .
\]</span> This can then be integrated to find the <span class="math inline">\(n\)</span>-dimensional Green’s function <span class="math inline">\(G_n(|\mathbf{x} - \mathbf{x}'|) = G(r)\)</span>. For <span class="math inline">\(n \geq 3\)</span> we have <span class="math display">\[
G_n(|\mathbf{x} - \mathbf{x}'|) = \frac{(-1)^{n+1}}{(n-2) \Omega_{n-1}} \frac{1}{|\mathbf{x} - \mathbf{x}'|^{n-2}} \ .
\]</span> It’s easy to see that when <span class="math inline">\(n=3\)</span> we get exactly what we’d derived before aside from the factor of <span class="math inline">\(4\pi\)</span>. Indeed, since <span class="math inline">\(\Omega_2 = 4\pi\)</span> is the surface area of a unit sphere, we get <span class="math display">\[
G_3(|\mathbf{x} - \mathbf{x}'|) = \frac{1}{4\pi} \frac{1}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> When <span class="math inline">\(n=2\)</span> we do get a proper function, but it looks different than the rest. In this case <span class="math inline">\(\Omega_1 = 2\pi\)</span> is the circumference of a unit sphere, so we get <span class="math display">\[
G_2(|\mathbf{x} - \mathbf{x}'|) = -\frac{1}{2\pi} \log |\mathbf{x} - \mathbf{x}'| \ .
\]</span> Finally, when <span class="math inline">\(n=1\)</span>, <span class="math inline">\(\Omega_0\)</span> is just the size of a point, which is zero. This means that <span class="math inline">\(G_1(|\mathbf{x} - \mathbf{x}'|) = \infty\)</span>, hence the Green’s function isn’t well-defined in 1-dimension.</p>
<p>In practice, aside from the 3-dimensional Green’s function we already studied in depth, it’s the 2-dimensional Green’s function that’s likely to be of most use to use in electromagnetism. It can be useful, for instance, in solving electrostatics problems where we’re only interested in the fields and potentials along some flat 2-dimensional surface.</p>
</section>
</section>
<section id="method-of-images" class="level2">
<h2 class="anchored" data-anchor-id="method-of-images">Method of Images</h2>
<p>Thus far, we’ve yet to show any practical ways to find the potential in a given boundary value problem. In this section we’ll introduce the first method, the powerful <em>method of images</em>. This method exploits the uniqueness theorem and the geometry of a problem to quickly find the potential. It doesn’t always work, but when it does it can be quite useful.</p>
<p>From the previous section, we know we can express the Green’s function satisfying the boundary conditions by letting <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \frac{1}{|\mathbf{x} - \mathbf{x}'|} + F(\mathbf{x} - \mathbf{x}') \ ,
\]</span> where the homogeneous part <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span> is any function that satisfies Laplace’s equation subject to the boundary conditions. By the uniqueness theorem, we know that if we can find such a function <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span>, it will be unique up to an unimportant additive constant to the potential, provided Dirichlet or Neumann (or mixed) boundary conditions are used.</p>
<p>The method of images exploits this property of uniqueness by converting the original boundary value problem into an equivalent unbounded problem that still just happens to satisfy the same boundary conditions. Suppose we have one or more point charges in the presence of some set of boundary conditions, for example a set of conductors held at some fixed potentials. In many cases, we can exploit the geometry of the problem to convert this problem into an equivalent unbounded problem by introducing pseudo-charges outside the boundary surface, called <em>image charges</em>, such that when added to the problem the combination of original and image charges together happens to satisfy the original boundary conditions. By the uniqueness theorem, we know that if we find such a solution, it must be the unique solution, even for the original BVP.</p>
<section id="examples" class="level3">
<h3 class="anchored" data-anchor-id="examples">Examples</h3>
<p>For example, suppose we wanted to find the potential for a point charge <span class="math inline">\(q\)</span> located at a distance <span class="math inline">\(z=d\)</span> above an infinite grounded sheet, meaning <span class="math inline">\(\phi = 0\)</span> at <span class="math inline">\(z=0\)</span>. What we can do is pretend the grounded sheet wasn’t there, and instead introduce an image charge <span class="math inline">\(-q\)</span> below the sheet at <span class="math inline">\(z = -d\)</span>, which is outside the boundary surface. The potential of this new image problem is just <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - d \mathbf{e}_z|} - \frac{q}{|\mathbf{x} + d \mathbf{e}_z|} = \frac{q}{\sqrt{x^2 + y^2 + (z-d)^2}} - \frac{q}{\sqrt{x^2 + y^2 + (z+d)^2}} \ .
\]</span> The potential of this image problem just happens to solve the original boundary conditions, since <span class="math inline">\(\phi(x,y,0) = 0\)</span>. By the uniqueness theorem, then, this same potential must <em>also</em> be the solution to the original BVP. See the figure below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20240811130344134.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>From this potential we can also easily find the Green’s function satisfying the boundary conditions. For a point charge <span class="math inline">\(q\)</span> located at a position <span class="math inline">\(\mathbf{x}_0\)</span>, we have <span class="math inline">\(\rho(\mathbf{x}') = q \delta(\mathbf{x}' - \mathbf{x}_0)\)</span>, meaning <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') \\
&amp;= \int d^3\mathbf{x}' \ q \delta(\mathbf{x}' - \mathbf{x}_0) G(\mathbf{x} - \mathbf{x}') \\
&amp;= q G(\mathbf{x} - \mathbf{x}_0) \ .
\end{align*}
\]</span> This means that to get the Green’s function all we need to do is divide the potential by <span class="math inline">\(q\)</span> to get <span class="math display">\[
G_D(\mathbf{x} - d\mathbf{e}_z) = \frac{q}{\sqrt{x^2 + y^2 + (z-d)^2}} - \frac{q}{\sqrt{x^2 + y^2 + (z+d)^2}} \ .
\]</span> Notice that the first term is just the unbounded Green’s function. The second term is the homogeneous part <span class="math display">\[
F(\mathbf{x} - d \mathbf{e}_z) = -\frac{q}{\sqrt{x^2 + y^2 + (z+d)^2}} \ .
\]</span> It’s important to note that the potential and Green’s function we found is <em>only</em> valid above the sheet, where <span class="math inline">\(z &gt; 0\)</span>. Below the sheet these formulas will <em>not</em> hold. The method of images only guarantees a solution <em>inside</em> the boundary surface. If we wanted to know what the potential was beyond the boundary surface as well we’d need to use some other approach.</p>
<p>This in a nutshell is how we use the method of images. Given some problem involving a set of point charges subject to some set of boundary conditions, we convert the problem into an unbounded problem by introducing image charges, find the image charges needed to satisfy the boundary conditions, write down the potential for this image problem and if desired the Green’s function. Note that for the method of images to work, it’s important that the images charges be <em>outside</em> the boundary surface. If we can’t find image charges outside the surface that satisfy the boundary conditions, we can’t proceed.</p>
<p>Before moving on, it’s insightful to calculate the total induced charge on the boundary surface, in this case on the sheet. Using the relation between the surface charge density <span class="math inline">\(\sigma\)</span> and the normal derivative of <span class="math inline">\(\phi\)</span> from the previous chapter, we can find the total charge <em>induced</em> on the sheet due to the presence of the point charge <span class="math inline">\(q\)</span>. Recall that near the surface the normal derivative must satisfy the condition <span class="math display">\[
\frac{\partial \phi}{\partial n} = -4\pi\sigma \ .
\]</span> Since the normal vector for the sheet is <span class="math inline">\(\mathbf{n} = z \mathbf{e}_z\)</span>, the induced surface charge density is given by <span class="math display">\[
\begin{align*}
\sigma &amp;= -\frac{1}{4\pi} \frac{\partial \phi}{\partial z} \\
&amp;= -\frac{1}{4\pi} \frac{\partial}{\partial z} \bigg(\frac{q}{\sqrt{x^2 + y^2 + (z-d)^2}} - \frac{q}{\sqrt{x^2 + y^2 + (z+d)^2}}\bigg) \\
&amp;= -\frac{1}{4\pi} \bigg(\frac{q(z-d)}{(x^2 + y^2 + (z-d)^2)^{3/2}} - \frac{q(z+d)}{(x^2 + y^2 + (z+d)^2)^{3/2}}\bigg) \\
&amp;= -\frac{qd}{2\pi}\frac{1}{(x^2 + y^2 + d^2)^{3/2}} \ .
\end{align*}
\]</span> Using this information we can then find the total induced charge <span class="math inline">\(Q\)</span> on the sheet by integrating <span class="math inline">\(\sigma\)</span> along the surface of the sheet. Since the surface is just the entire <span class="math inline">\(xy\)</span>-plane. We’ll use polar coordinates for the integration since it’s slightly easier. Writing <span class="math inline">\(da = r dr d\varphi\)</span> and <span class="math inline">\(r^2 = x^2 + y^2\)</span>, we have <span class="math display">\[
\begin{align*}
Q &amp;= \oint_\mathcal{S} da \ \sigma \\
&amp;= -\frac{qd}{2\pi} \int_0^{2\pi} d\varphi \int_0^\infty r dr \ \frac{1}{(r^2 + d^2)^{3/2}} \\
&amp;= \frac{qd}{\sqrt{r^2 + d^2}} \bigg |_{r=0}^\infty \\
&amp;= -q \ .
\end{align*}
\]</span> Notice that the induced charge on the surface is just the image charge, with <span class="math inline">\(Q = -q\)</span>. This will be generally true in method of images problems. In fact it <em>must</em> be this way, since the image charges are just a reformulation of the boundary conditions. The net charge in the original BVP should be the same as the net charge in the corresponding image problem.</p>
<p>We’ll now work through a few more complicated examples to help solidify these ideas.</p>
<section id="example-point-charge-near-a-grounded-conducting-sphere" class="level5">
<h5 class="anchored" data-anchor-id="example-point-charge-near-a-grounded-conducting-sphere">Example: Point charge near a grounded conducting sphere</h5>
<p>Suppose we have a point charge <span class="math inline">\(q\)</span> located at some distance <span class="math inline">\(d\)</span> outside a grounded conducting sphere of radius <span class="math inline">\(R\)</span>. This means that the boundary surface is just the surface of the sphere, where we must have <span class="math inline">\(\phi = 0\)</span>. To find the potential of this BVP, we’ll suppose there is a single image charge <span class="math inline">\(q'\)</span> located inside the sphere at some distance <span class="math inline">\(d' \leq R\)</span> from the center.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20240811130410188.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>If we ignore the presence of the sphere and focus on these two charges alone, the potential will be <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - \mathbf{d}|} + \frac{q'}{|\mathbf{x} - \mathbf{d}'|} \ ,
\]</span> where <span class="math inline">\(\mathbf{d} = d\mathbf{n}\)</span> is the distance vector of <span class="math inline">\(q\)</span> and <span class="math inline">\(\mathbf{d}' = d'\mathbf{n}'\)</span> is the distance vector of <span class="math inline">\(q'\)</span>, with <span class="math inline">\(\mathbf{n}\)</span> and <span class="math inline">\(\mathbf{n}'\)</span> their respective normal vectors relative to the surface of the sphere. To satisfy the boundary conditions, we require that <span class="math inline">\(\phi(R\mathbf{e}_r) = 0\)</span>. This means we need to find a <span class="math inline">\(q'\)</span> and <span class="math inline">\(d'\)</span> for the image charge that satisfies the condition <span class="math display">\[
0 = \frac{q}{|R\mathbf{e}_r - d \mathbf{n}|} + \frac{q'}{|R\mathbf{e}_r - d' \mathbf{n}'|} =
\frac{q/R}{|\mathbf{e}_r - \frac{d}{R}\mathbf{n}|} + \frac{q'/d'}{|\frac{R}{d'}\mathbf{e}_r - \mathbf{n}'|} \ .
\]</span> The only way this equation can evidently be satisfied with a nontrivial solution is if <span class="math display">\[
\frac{q}{R} = -\frac{q'}{d'} \quad , \quad \frac{d}{R} = \frac{R}{d'} \ .
\]</span> This means we means for the image problem to satisfy the boundary conditions, the image charge must satisfy <span class="math display">\[
q' = -\frac{R}{d} q \quad , \quad \mathbf{d}' = \frac{R^2}{d} \mathbf{n} \ .
\]</span> Plugging these expressions back into the potential, we thus have <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - d \mathbf{n}|} - \frac{\frac{R}{d} q}{|\mathbf{x} - \frac{R^2}{d} \mathbf{n}|} \ .
\]</span> We can rewrite this expression in a somewhat more useful form by using the law of cosines. If we let <span class="math inline">\(\alpha\)</span> denote the angle between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{d}\)</span>, we can write <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{\sqrt{r^2 + d^2 - 2rd\cos\alpha}} - \frac{\frac{R}{d} q}{\sqrt{R^2 + \frac{r^2 d^2}{R^2} - 2rd\cos\alpha}} \ .
\]</span> By the uniqueness theorem, this must be the solution to the original BVP as well. Let’s check that the limits make sense. As <span class="math inline">\(d \rightarrow \infty\)</span>, we have <span class="math inline">\(d' \rightarrow 0\)</span>, meaning the image charge moves closer towards the origin as the main charge moves farther away. Moreover, the image charge itself goes to zero, since <span class="math inline">\(q' \rightarrow 0\)</span>. On the other hand, as <span class="math inline">\(d \rightarrow R\)</span>, we have <span class="math inline">\(d' \rightarrow R\)</span> as well, meaning the image charge moves toward the surface as the main charge does. The image charge itself goes to <span class="math inline">\(q' \rightarrow q\)</span> in this limit. This also makes sense, since near the surface we expect the problem to approximate that of the charge above an infinite sheet.</p>
<p>If we like we can also write down the Green’s function by again dividing both sides of the potential by <span class="math inline">\(q\)</span> to get <span class="math display">\[
G_D(\mathbf{x} - \mathbf{d}) = \frac{1}{\sqrt{r^2 + d^2 - 2rd\cos\alpha}} - \frac{\frac{R}{d}}{\sqrt{R^2 + \frac{r^2 d^2}{R^2} - 2rd\cos\alpha}} \ .
\]</span> Again, the first term is just the unbounded Green’s function. The second term is the homogeneous part <span class="math display">\[
F(\mathbf{x} - \mathbf{d}) = -\frac{\frac{R}{d}}{\sqrt{R^2 + \frac{r^2 d^2}{R^2} - 2rd\cos\alpha}} \ .
\]</span> One can check that <span class="math inline">\(F\)</span> also satisfies Laplace’s equation subject to the boundary condition <span class="math inline">\(F(R\mathbf{e}_r - \mathbf{d}) = 0\)</span>.</p>
<p>Again, it’s important to note that the potential and Green’s function we found is <em>only</em> valid outside the sphere. These formulas do not hold inside the sphere, which is outside the boundary surface.</p>
<p>We can find the charge induced on the surface of the conductor as well. Letting <span class="math inline">\(\mathbf{n} = r \mathbf{e}_r\)</span>, the surface charge density <span class="math inline">\(\sigma\)</span> turns out to be given by <span class="math display">\[
\sigma = -\frac{1}{4\pi} \frac{\partial \phi}{\partial r} = -\frac{1}{4\pi R^2} \frac{R}{d} \frac{1-\frac{R^2}{d^2}}{\big(1 + \frac{R^2}{d^2} - 2 \frac{R}{d} \cos\alpha \big)^{3/2}} \ .
\]</span> Notice that <span class="math inline">\(\sigma\)</span> now depends on the location of the field point as well due to the presence of the <span class="math inline">\(\cos\alpha\)</span> term. The density is evidently highest when <span class="math inline">\(\alpha = 0\)</span>, which is the area on the sphere closest to the point charge, and lowest when <span class="math inline">\(\alpha = \pi\)</span>, which is the area on the sphere farthest from the point charge. As the point charge moves farther away the density decreases.</p>
<p>By evaluating the surface integral, one can again show that the induced charge is given by the induced charge, with <span class="math display">\[
Q = \oint_{\mathcal{S}} da \ \sigma = q' = -\frac{R}{d} q \ .
\]</span> We can also calculate the force between the point charge and the conducting sphere if we like. Since the image charge problem is equivalent, we can just use Coulomb’s Law between the charge <span class="math inline">\(q\)</span> and its image charge <span class="math inline">\(q'\)</span> to get <span class="math display">\[
\mathbf{F} = \frac{qq'}{|\mathbf{d} - \mathbf{d}'|^2} \mathbf{e}_r = -\frac{q^2 R}{d^3\big(1 - \frac{R^2}{d^2}\big)^2} \mathbf{e}_r \ .
\]</span> Evidently the force between the conductor and the point charge is always attractive. When the charge is near the conductor, the force goes like <span class="math inline">\(F \sim (d-R)^{-2}\)</span> similar to a monopole field, but as the charge moves farther away the force goes like <span class="math inline">\(F \sim d^{-3}\)</span>, more similar to a dipole field.</p>
</section>
<section id="example-point-charge-near-an-ungrounded-conducting-sphere" class="level5">
<h5 class="anchored" data-anchor-id="example-point-charge-near-an-ungrounded-conducting-sphere">Example: Point charge near an ungrounded conducting sphere</h5>
<p>In the previous example we considered the problem of a point charge in the presence of a grounded conducting sphere. In fact, there’s no necessary reason that the conductor to be grounded. We can hold it at any fixed potential we like, but to do so we need to modify the potential somewhat to account for this.</p>
<p>Suppose the sphere is held at a constant potential <span class="math inline">\(\phi=V\)</span>. We’ll again place an image charge <span class="math inline">\(q' = -\frac{R}{d} q\)</span> at a distance <span class="math inline">\(d' = \frac{R^2}{d}\)</span>. However, we need to cancel the potential on the surface of the sphere as well. To address this, we can place another image charge at the origin with charge <span class="math inline">\(q'' = VR\)</span>, to ensure that when <span class="math inline">\(|\mathbf{x}| = R\)</span> we have <span class="math inline">\(\phi = V\)</span> as expected.</p>
<p>FIGURE</p>
<p>Then we have <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - d\mathbf{n}|} - \frac{\frac{R}{d}q}{|\mathbf{x} - \frac{R^2}{d^2}\mathbf{n}|} + \frac{VR}{|\mathbf{x}|} \ .
\]</span> We can use this to get the Green’s function in the usual way by dividing by <span class="math inline">\(q\)</span>. In this case, the function <span class="math display">\[
F(\mathbf{x} - \mathbf{d}) = -\frac{\frac{R}{d}q}{|\mathbf{x} - \frac{R^2}{d^2}\mathbf{n}|} + \frac{VR}{|\mathbf{x}|}
\]</span> will satisfy Laplace’s equation. In fact, each term satisfies Laplace’s equation separately, as one can check.</p>
<p>One can check that the charge <span class="math inline">\(Q\)</span> on the surface of the sphere is given by <span class="math inline">\(Q = q' + q'' = VR - \frac{R}{d} q\)</span>. The force between the ungrounded sphere and the point charge is evidently given by <span class="math display">\[
\mathbf{F} = q\bigg(\frac{q'}{|\mathbf{d} - \mathbf{d}'|^2} + \frac{VR}{|\mathbf{d}|^2}\bigg)\mathbf{e}_r = \frac{q}{d^2} \bigg(VR - \frac{qRd^3}{\big(d^2 - R^2\big)^2}\bigg) \mathbf{e}_r \ .
\]</span> Now, the force includes both the dipole contribution from before, as well as a new monopole contribution due to the presence of the fixed potential <span class="math inline">\(V\)</span>. This means in the far field limit <span class="math inline">\(d \gg R\)</span> the force reduces to Coulomb’s Law between point charges <span class="math inline">\(Q\)</span> and <span class="math inline">\(q\)</span>.</p>
<p>In the opposite limit where <span class="math inline">\(d \approx R\)</span> things are somewhat more interesting. Suppose that <span class="math inline">\(d = R + \delta\)</span>, where <span class="math inline">\(\delta \ll r\)</span>. After working out the math, we find that very close to the surface <span class="math inline">\(\mathbf{F} \sim -\frac{q^2}{4\delta^2} \mathbf{e}_r\)</span>. That is, no matter what the force becomes infinitely attractive near the surface, even if <span class="math inline">\(q\)</span> and <span class="math inline">\(Q\)</span> have the same sign.</p>
<p>The point where this attraction happens is usually very close to the sphere. One can show that when <span class="math inline">\(Q \approx VR \gg q\)</span>, the force has an unstable equilibrium at <span class="math inline">\(d \approx R\big(1 + \frac{1}{2}\sqrt{\frac{q}{VR}}\big)\)</span>. For example, an electron near the surface of a conductor with radius <span class="math inline">\(R = 30 \ \text{cm}\)</span> and <span class="math inline">\(V = 1 \ \text{V}\)</span> will experience this attraction only when <span class="math inline">\(d-R \lesssim 10 \ \mu\text{m}\)</span>.</p>
<p>We can use this fact to interpret why charges almost never leave the surface of a conductor in the presence of an external field. If they tried to, they’d always be pulled back to the surface by this very powerful attractive force.</p>
</section>
<section id="example-point-charge-near-two-grounded-conducting-perpendicular-sheets" class="level5">
<h5 class="anchored" data-anchor-id="example-point-charge-near-two-grounded-conducting-perpendicular-sheets">Example: Point charge near two grounded conducting perpendicular sheets</h5>
<p>Suppose we have a point charge <span class="math inline">\(q\)</span> located at point <span class="math inline">\(\mathbf{d} = (a,b)\)</span> above two perpendicular grounded conducting sheets in the <span class="math inline">\(xy\)</span>-plane. It’s not too hard to see that using a single image charge for this problem won’t work, no matter what its charge or position is. We’ll need multiple. But how many? It turns out we’ll need 3 image charges.</p>
<p>Consider an equivalent problem where we have 3 image charges <span class="math inline">\(q',q'',q'''\)</span> located at positions <span class="math inline">\(\mathbf{d}'\)</span>, <span class="math inline">\(\mathbf{d}''\)</span>, and <span class="math inline">\(\mathbf{d}'''\)</span> respectively. The potential of this configuration is evidently given by <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x}-\mathbf{d}|} + \frac{q'}{|\mathbf{x}-\mathbf{d}'|} + \frac{q''}{|\mathbf{x}-\mathbf{d}''|} + \frac{q'''}{|\mathbf{x}-\mathbf{d}'''|} \ .
\]</span> To arrange these image charges in a way that satisfies the boundary condition <span class="math inline">\(\phi(0,y)=\phi(x,0)=0\)</span>, we’ll choose <span class="math display">\[
\begin{align*}
q' = -q \quad &amp;, \quad \mathbf{d}' = (-a,b) \ , \\
q'' = -q \quad &amp;, \quad \mathbf{d}'' = (a,-b) \ , \\
q''' = q \quad &amp;, \quad \mathbf{d}''' = (-a,-b) \ . \\
\end{align*}
\]</span> This configuration of charges is called the <em>simple quadrupole</em>, a concept we’ll return to in more generality later.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20240811130516105.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Now, observe if we plug these values back into the potential we get <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{\sqrt{(x-a)^2+(y-b)^2}} - \frac{q}{\sqrt{(x+a)^2+(y-b)^2}} - \frac{q}{\sqrt{(x-a)^2+(y+b)^2}} + \frac{q}{\sqrt{(x+a)^2+(y+b)^2}} \ .
\]</span> Observe now that if we set <span class="math inline">\(\mathbf{x}=(x,0)\)</span> or <span class="math inline">\(\mathbf{x}=(0,y)\)</span> the potential vanishes, meaning this potential satisfies the boundary conditions, and hence by uniqueness must also be the correct potential for the original BVP. Dividing by <span class="math inline">\(q\)</span> will again give us the Green’s function as usual.</p>
<p>The force between the point charge and the two sheets is given in the usual way. We end up with <span class="math display">\[
\mathbf{F} = q^2 \bigg(\frac{a}{(a^2+b^2)^{3/2}} - \frac{1}{a^2}\bigg)\mathbf{e}_x + q^2 \bigg(\frac{b}{(a^2+b^2)^{3/2}} - \frac{1}{b^2}\bigg)\mathbf{e}_y \ .
\]</span> Interestingly, this exact same problem can attempt to be carried out for two conducting sheets separated by an angle <span class="math inline">\(\theta\)</span>. One can be convinced that in this general case, the method of images will only work for angles <span class="math inline">\(\theta = \frac{\pi}{4}, \frac{\pi}{3}, \frac{\pi}{2}, \pi\)</span>. The lower the angle, the more image charges will be needed to match the problem configuration. If any other angles are tried, one is forced to place image charges inside the boundary surface, which of course is not allowed for the method of images are work.</p>
</section>
<section id="example-conducting-sphere-in-a-uniform-electric-field" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-sphere-in-a-uniform-electric-field">Example: Conducting sphere in a uniform electric field</h5>
<p>We’ll consider now a problem that involves no point charges at all. Suppose a uniform conducting sphere of radius <span class="math inline">\(R\)</span> lies in the presence of a uniform electric field <span class="math inline">\(\mathbf{E}_0\)</span>. Though not at all obvious, we can solve this problem using the method of images as well.</p>
<p>We’ll suppose the sphere is centered at the origin, and that <span class="math inline">\(\mathbf{E}_0 = E_0 \mathbf{e}_z\)</span> points along the <span class="math inline">\(z\)</span>-axis of the sphere. To turn this into an image problem, we can think of the electric field as being generated by two opposite charges <span class="math inline">\(q_\pm = \pm q\)</span> each located a distance <span class="math inline">\(d \gg R\)</span> from the origin with positions <span class="math inline">\(\mathbf{d}_\pm = \pm R\mathbf{e}_z\)</span>. Then the electric field will be approximately constant near the sphere, with <span class="math display">\[
E_0 \approx \frac{2q}{d^2} \ .
\]</span> If we send <span class="math inline">\(q, d\)</span> to infinity in a way such that this ratio stays constant, <span class="math inline">\(E_0\)</span> will become exactly uniform at every point.</p>
<p>FIGURE</p>
<p>Now, we know how to solve the problem of point charges in the presence of a conducting sphere. Each charge <span class="math inline">\(q_+\)</span> and <span class="math inline">\(q_-\)</span> will have associated image charges inside the sphere with charges and positions given by <span class="math display">\[
q_\pm' = \mp q \frac{R}{d} \quad , \quad \mathbf{d}_\pm' = \frac{R^2}{d} \mathbf{e}_z \ .
\]</span> Then the potential near the <span class="math inline">\(\phi(\mathbf{x})\)</span> near the sphere will be given by <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q_+}{|\mathbf{x} - \mathbf{d}_+|} + \frac{q_-}{|\mathbf{x} - \mathbf{d}_-|} + \frac{q_+'}{|\mathbf{x} - \mathbf{d}_+'|} + \frac{q_-'}{|\mathbf{x} - \mathbf{d}_-'|} \\
&amp;= q \bigg[\frac{1}{\sqrt{r^2 + d^2 + 2rd\cos\theta}} - \frac{1}{\sqrt{r^2 + d^2 - 2rd\cos\theta}} - \frac{R/d}{\sqrt{r^2 + (R^2/d)^2 + 2r(R^2/d)\cos\theta}} \\
&amp;\quad + \frac{R/d}{\sqrt{r^2 + (R^2/d)^2 - 2r(R^2/d)\cos\theta}}\bigg] \ .
\end{align*}
\]</span> Again, the term in brackets is the Green’s function under Dirichlet boundary conditions.</p>
<p>Now, to make this exact for a uniform field we need to send <span class="math inline">\(d \rightarrow \infty\)</span>. In this limit, we can assume that <span class="math inline">\(r \ll d\)</span>, meaning we can factor out <span class="math inline">\(d^2\)</span> from the roots and use the binomial approximation on each term to write <span class="math display">\[
\phi(\mathbf{x}) = -\frac{2q}{d^2} r \cos\theta + \frac{2q}{d^2} \frac{R^3}{r^2} \cos\theta + O\bigg(\frac{r}{d}\bigg) \ .
\]</span> The higher-order terms will vanish as <span class="math inline">\(d \rightarrow \infty\)</span>. What remains are terms proportional to the uniform electric field <span class="math inline">\(E_0 = \frac{2q}{d^2}\)</span>, <span class="math display">\[
\phi(\mathbf{x}) = -E_0\bigg(r - \frac{R^3}{r^2}\bigg) \cos\theta \ .
\]</span> Notice the first term is just <span class="math inline">\(-E_0 z = -E_0 r\cos\theta\)</span>, which is what we’d expect for the potential of a uniform electric field in the absence of any conductors. The second term then is evidently the potential of the induced charge density on the sphere, which is equivalent of course to the potential of the image charges. The induced charge density is given in the usual way, <span class="math display">\[
\sigma = -\frac{1}{4\pi} \frac{\partial \phi}{\partial r} \bigg|_{r=R} = \frac{3}{4\pi} E_0 \cos\theta \ .
\]</span> Evidently, the surface integral of <span class="math inline">\(\sigma\)</span> in this case will vanish, meaning no net induced charge will accumulate on the sphere, <span class="math display">\[
Q = \oint_\mathcal{S} da \ \sigma = \frac{3}{2} E_0 R^2 \int_0^\pi d\theta \sin\theta \cos\theta = 0 \ .
\]</span> This can also be seen, of course, by noticing that the image charges <span class="math inline">\(q'_+\)</span> and <span class="math inline">\(q_-'\)</span> are equal and opposite, so their sum will vanish. This doesn’t mean, of course, that there’s no charge on the sphere. Indeed, we’d expect that in the direction of the field, positive charges will concentrate at one pole and negative charges on the other. What this result says is the net charge will be zero.</p>
</section>
</section>
<section id="greens-function-for-a-sphere" class="level3">
<h3 class="anchored" data-anchor-id="greens-function-for-a-sphere">Green’s Function for a Sphere</h3>
<p>Let’s consider again the example of a point charge <span class="math inline">\(q\)</span> in the presence of a grounded conducting sphere of radius <span class="math inline">\(R\)</span>. If we let <span class="math inline">\(r'\)</span> denote the distance of the point charge from the origin, we saw that we could write the Green’s function for this problem by <span class="math display">\[
G_D(\mathbf{x} - \mathbf{x}') = \frac{1}{\sqrt{r^2 + r'^2 - 2rr'\cos\alpha}} - \frac{R/r'}{\sqrt{R^2 + \frac{r^2 r'^2}{R^2} - 2rr'\cos\alpha}} \ ,
\]</span> where <span class="math inline">\(\alpha\)</span> is the angle between the field point <span class="math inline">\(\mathbf{x}\)</span> and the source point <span class="math inline">\(\mathbf{x}'\)</span>.</p>
<p>We can use this Green’s function as a building block to find solutions to any problem whose potential is specified on the surface of a sphere. Recall from a few sections back that we saw we could express the potential in the presence of Dirichlet boundary conditions by the formal solution <span class="math display">\[
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G_D(\mathbf{x} - \mathbf{x}') - \frac{1}{4\pi} \oint_\mathcal{S} da' \ \phi \frac{\partial G_D}{\partial n'} \ .
\]</span> Provided we can find the Green’s function and we know the value of the potential on some given boundary surface, we have a unique solution of this form for the potential everywhere in space.</p>
<p>Now, suppose we have some charge distribution <span class="math inline">\(\rho(\mathbf{x})\)</span> located some distance away from a sphere of radius <span class="math inline">\(R\)</span> whose surface is held at some known potential <span class="math inline">\(\phi_0 = \phi(R,\theta',\varphi')\)</span>. Since <span class="math inline">\(\mathcal{S}\)</span> is a sphere and the charge distribution lies outside the sphere, its surface normal <span class="math inline">\(\mathbf{n}'\)</span> will point inward toward the sphere with <span class="math inline">\(\mathbf{n}' = -\mathbf{e}_{r'}\)</span>. This means the normal derivative of <span class="math inline">\(G_D\)</span> at the surface of the sphere will be <span class="math display">\[
\frac{\partial G_D}{\partial n'} = -\frac{\partial G_D}{\partial r'} \bigg|_{r'=R} = -\frac{(r^2 - R^2)/R}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} \ .
\]</span> Plugging this in and using the fact that the area element is <span class="math inline">\(da' = R^2 d\Omega'\)</span> on the surface of the sphere, we can express the potential for <em>any</em> charge distribution <span class="math inline">\(\rho(\mathbf{x})\)</span> outside a sphere of known potential by the integral <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) = &amp;\int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') \bigg[\frac{1}{\sqrt{r^2 + r'^2 - 2rr'\cos\alpha}} - \frac{R/r'}{\sqrt{R^2 + \frac{r^2 r'^2}{R^2} - 2rr'\cos\alpha}}\bigg] \\
&amp;+ \frac{1}{4\pi} \oint_\mathcal{S} d\Omega' \ \phi(R,\theta',\varphi') \frac{R(r^2 - R^2)}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} \ ,
\end{align*}
\]</span> where <span class="math inline">\(\cos\alpha\)</span> can be expressed in terms of the trig relation <span class="math display">\[
\cos\alpha = \cos\theta \cos\theta' + \sin\theta \sin\theta' \cos(\varphi-\varphi') \ .
\]</span> This is an imposing set of integrals to solve though, so it’s perhaps worth looking at a simplifying scenario. Suppose there are no other charges present other than the sphere. Then we can neglect the volume integral and express the potential by <span class="math display">\[
\phi(\mathbf{x}) = \frac{1}{4\pi} \oint_\mathcal{S} d\Omega' \ \phi(R,\theta',\varphi') \frac{R(r^2 - R^2)}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} \ .
\]</span> Note that we can easily write down the potential inside the sphere as well. All we need to do is flip the sign on the normal derivative, which is equivalent to replacing <span class="math inline">\(r^2 - R^2 \rightarrow R^2 - r^2\)</span> in the integral above. Everything else is the same.</p>
<section id="example-conducting-sphere-with-hemispheres-of-opposite-potentials" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-sphere-with-hemispheres-of-opposite-potentials">Example: Conducting sphere with hemispheres of opposite potentials</h5>
<p>Suppose we have a hollow sphere of radius <span class="math inline">\(R\)</span> consisting of two hemispheres held at opposite fixed potentials <span class="math inline">\(\pm V\)</span> that are separated by a thin insulating ring at the equator. We want to find the potential that matches these boundary conditions on the surface of the sphere.</p>
<p>FIGURE</p>
<p>Since there are no other source charges present, we can express the potential in terms of the integral given above, <span class="math display">\[
\phi(\mathbf{x}) = \frac{1}{4\pi} \oint_\mathcal{S} d\Omega' \ \phi(R,\theta',\varphi') \frac{R(r^2 - R^2)}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} \ .
\]</span> We require that <span class="math inline">\(\phi(R,\theta',\varphi') = +V\)</span> when <span class="math inline">\(0 \leq \theta' &lt; \frac{\pi}{2}\)</span> and <span class="math inline">\(\phi(R,\theta',\varphi') = -V\)</span> when <span class="math inline">\(\frac{\pi}{2} &lt; \theta' \leq \pi\)</span>. Plugging this in, we get <span class="math display">\[
\phi(\mathbf{x}) = \frac{VR(r^2 - R^2)}{4\pi} \int_0^{2\pi} d\varphi' \bigg[\int_0^{\pi/2} \sin\theta' d\theta' - \int_{\pi/2}^\pi \sin\theta' d\theta'\bigg] \frac{1}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} \ .
\]</span> We can simplify this expression somewhat by making the change of variables <span class="math inline">\(\theta' \rightarrow \pi - \theta', \varphi' \rightarrow \pi + \varphi'\)</span> on the second <span class="math inline">\(\theta'\)</span> integral, combining terms, and making a change of variable <span class="math inline">\(\mu' = \cos\theta'\)</span> to write <span class="math display">\[
\phi(\mathbf{x}) = \frac{VR(r^2 - R^2)}{4\pi} \int_0^{2\pi} d\varphi' \int_0^1 d\mu' \bigg[\frac{1}{(r^2 + R^2 - 2Rr \cos\alpha)^{3/2}} - \frac{1}{(r^2 + R^2 + 2Rr \cos\alpha)^{3/2}}\bigg] \ .
\]</span> Unfortunately though, the presence of the term <span class="math inline">\(\cos\alpha = \cos\theta \cos\theta' + \sin\theta \sin\theta' \cos(\varphi-\varphi')\)</span> still makes this integral impossible to easily solve. But we can solve it in one simplifying case, when the field point is located on the positive <span class="math inline">\(z\)</span>-axis, so <span class="math inline">\(r=z\)</span>. In that case, we can simply write <span class="math inline">\(\cos\alpha = \cos\theta' = \mu'\)</span>. Then the <span class="math inline">\(\varphi'\)</span> integral becomes trivial, and we have <span class="math display">\[
\phi(z\mathbf{e}_z) = \frac{VR(z^2 - R^2)}{2} \int_0^1 d\mu' \bigg[\frac{1}{(z^2 + R^2 - 2Rz \mu')^{3/2}} - \frac{1}{(z^2 + R^2 + 2Rz \mu')^{3/2}}\bigg] \ .
\]</span> Both integrals can be easily solved using substitutions of the form <span class="math inline">\(u = r^2 + R^2 \mp 2Rr \mu'\)</span>. We finally get <span class="math display">\[
\phi(z\mathbf{e}_z) = V \bigg[1 - \frac{(z^2 - R^2)/z}{\sqrt{z^2 + R^2}}\bigg] \ .
\]</span> Let’s check that this solution makes sense. When <span class="math inline">\(z=R\)</span> we get <span class="math inline">\(\phi = V\)</span>, which is what we expect when <span class="math inline">\(z &gt; 0\)</span>, which we assumed. When <span class="math inline">\(z \gg R\)</span> we get <span class="math inline">\(\phi \sim \frac{3VR^2}{2z^2}\)</span>, which means the potential falls off <em>faster</em> than it would for a point charge. In fact, it falls off like a <em>dipole</em>. This should make sense, given that we have two identical hemispheres held at opposite potentials, which means they have a net charge of zero and effectively act as a sort of dipole.</p>
<p>While we can’t evaluate the general integral for this potential for arbitrary <span class="math inline">\(\mathbf{x}\)</span>, we can at least get a series solution. The idea here is to suppose we’re far away from the sphere, so that <span class="math inline">\(r \gg R\)</span>, and define <span class="math inline">\(\varepsilon \equiv (R/r)^2\)</span>. If we expand the integrand in powers of <span class="math inline">\(\varepsilon\)</span> and integrate term by term, it’s possible to show that the potential we end up with has the form <span class="math display">\[
\phi(\mathbf{x}) = \frac{3VR^2}{2r^2} \bigg(P_1(\cos\theta) - \frac{7R^2}{12r^2} P_3(\cos\theta) + \cdots\bigg) \ .
\]</span> Here each term <span class="math inline">\(P_\ell(\cos\theta)\)</span> is the <em>Legendre polynomial</em> of degree <span class="math inline">\(\ell\)</span>. Details on the Legendre polynomials can be found in the appendix. Evidently, the potential given only includes the odd degree polynomials. The even degree terms vanish due to the polar symmetry in the problem. The first two odd Legendre polynomials are given by <span class="math display">\[
P_1(\cos\theta) = \cos\theta \quad , \quad P_3(\cos\theta) = \frac{1}{2} (5\cos^3\theta - 3\cos\theta) \ .
\]</span> The further we are from the sphere, the better we can approximate this series solution by keeping only the first few terms. In fact, this is the entire idea behind the multipole expansion, something we’ll cover in great detail in a future chapter.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../electrodynamics/electrostatics.html" class="pagination-link" aria-label="Electrostatics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Electrostatics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../electrodynamics/bvps-2.html" class="pagination-link" aria-label="Boundary Value Problems II">
        <span class="nav-page-text"><span class="chapter-title">Boundary Value Problems II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>