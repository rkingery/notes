<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personal Notes - Boundary Value Problems III</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../electrodynamics/magnetostatics.html" rel="next">
<link href="../electrodynamics/bvps-2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-3.html"><span class="chapter-title">Boundary Value Problems III</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Classical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/newtonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Newtonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/simple-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Simple Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/reference-frames.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Reference Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/lagrangian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lagrangian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/hamiltonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Hamiltonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/central-forces.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Central Forces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/coupled-oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Coupled Oscillations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/rigid-bodies.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rigid Bodies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/canonical-transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Canonical Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/integrability-and-chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Integrability and Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/continuum-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Continuum Mechanics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Electromagnetism</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/preliminaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/electrostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Electrostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-3.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Boundary Value Problems III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/magnetostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Magnetostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/orthogonal-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix I: Orthogonal Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/complex-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix II: Complex Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Circuit Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/circuit-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Lumped Circuit Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Analyzing Circuits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/nonlinear-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nonlinear Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/digital-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Digital Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/amplifiers.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/first-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">First-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/second-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/ac-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">AC Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/op-amps.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Operational Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/energy-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Energy and Power</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Quantum Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/identical-particles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Identical Particles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/second-quantization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second Quantization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/thermodynamics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Thermodynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/kinetic-theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Kinetic Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Gases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Gases</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#complex-methods" id="toc-complex-methods" class="nav-link active" data-scroll-target="#complex-methods">Complex Methods</a>
  <ul class="collapse">
  <li><a href="#complex-potential" id="toc-complex-potential" class="nav-link" data-scroll-target="#complex-potential">Complex Potential</a></li>
  <li><a href="#conformal-mappings" id="toc-conformal-mappings" class="nav-link" data-scroll-target="#conformal-mappings">Conformal Mappings</a></li>
  <li><a href="#d-boundary-value-problems" id="toc-d-boundary-value-problems" class="nav-link" data-scroll-target="#d-boundary-value-problems">2D Boundary Value Problems</a></li>
  </ul></li>
  <li><a href="#multipole-moments" id="toc-multipole-moments" class="nav-link" data-scroll-target="#multipole-moments">Multipole Moments</a>
  <ul class="collapse">
  <li><a href="#cartesian-multipole-expansion" id="toc-cartesian-multipole-expansion" class="nav-link" data-scroll-target="#cartesian-multipole-expansion">Cartesian Multipole Expansion</a></li>
  <li><a href="#monopole-moment" id="toc-monopole-moment" class="nav-link" data-scroll-target="#monopole-moment">Monopole Moment</a></li>
  <li><a href="#dipole-moment" id="toc-dipole-moment" class="nav-link" data-scroll-target="#dipole-moment">Dipole Moment</a></li>
  <li><a href="#quadrupole-moment" id="toc-quadrupole-moment" class="nav-link" data-scroll-target="#quadrupole-moment">Quadrupole Moment</a></li>
  </ul></li>
  <li><a href="#general-multipole-expansion" id="toc-general-multipole-expansion" class="nav-link" data-scroll-target="#general-multipole-expansion">General Multipole Expansion</a>
  <ul class="collapse">
  <li><a href="#greens-function-expansion" id="toc-greens-function-expansion" class="nav-link" data-scroll-target="#greens-function-expansion">Green’s Function Expansion</a></li>
  <li><a href="#azimuthally-symmetric-expansion" id="toc-azimuthally-symmetric-expansion" class="nav-link" data-scroll-target="#azimuthally-symmetric-expansion">Azimuthally Symmetric Expansion</a></li>
  <li><a href="#spherical-expansion" id="toc-spherical-expansion" class="nav-link" data-scroll-target="#spherical-expansion">Spherical Expansion</a></li>
  </ul></li>
  <li><a href="#multipole-expansion-in-an-external-field" id="toc-multipole-expansion-in-an-external-field" class="nav-link" data-scroll-target="#multipole-expansion-in-an-external-field">Multipole Expansion in an External Field</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-3.html"><span class="chapter-title">Boundary Value Problems III</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Boundary Value Problems III</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p>In this last chapter on boundary value problems in electrostatics, we will conclude our discussion of boundary value problems by discussing briefly the applications of complex methods to solving Laplace’s equation in two dimensions. We will then move on to the discussion of the multipole expansion of electrostatics, a way to obtain approximate solutions to electrostatics problems. The idea of a multipole expansion turns out to be very useful not just in electrostatics, but in all of electromagnetism. We’ll see extensions of these ideas to other areas of electromagnetism in future chapters.</p>
<section id="complex-methods" class="level2">
<h2 class="anchored" data-anchor-id="complex-methods">Complex Methods</h2>
<p>In many cases we find ourselves interested in boundary value problems that can be reduced to two dimensions, that is, problems that can be reduced to two variables. For example, if the symmetry of a problem dictates that the potential cannot depend on the <span class="math inline">\(z\)</span>-coordinate, we can write <span class="math inline">\(\phi(\mathbf{x}) = \phi(x,y)\)</span>, which reduces the problem to a two dimensional problem in the <span class="math inline">\(xy\)</span>-plane.</p>
<p>While the techniques we’ve covered so far we’ll often work in this setting, there’s another technique that can be used to solve more difficult problems that employs the tools of complex analysis, particular the theory of analytic functions and conformal mappings. We covered the mathematical background of this subject in the appendix. It’s recommend that the reader read that material before proceeding further with this section.</p>
<section id="complex-potential" class="level3">
<h3 class="anchored" data-anchor-id="complex-potential">Complex Potential</h3>
<p>Suppose <span class="math inline">\(\phi(\mathbf{x}) = \phi(x,y)\)</span> is the 2-dimensional scalar potential for some boundary value problem free of source charges. Then we know that the potential must satisfy Laplace’s equation <span class="math inline">\(\nabla^2 \phi = 0\)</span> inside the boundary region. We know from the appendix that any harmonic function in two dimensions can be thought of as the real part of some analytic function in the complex plane.</p>
<p>We can thus use the potential <span class="math inline">\(\phi(x,y)\)</span> to define a complex-valued analytic function <span class="math inline">\(F(z)\)</span> of the form <span class="math display">\[
F(z) = \phi(x,y) + i \psi(x,y) \ ,
\]</span> where <span class="math inline">\(z = x + i y\)</span> is a complex variable whose real part is <span class="math inline">\(x\)</span> and whose imaginary part is <span class="math inline">\(y\)</span>, and <span class="math inline">\(\psi(x,y)\)</span> is the <em>harmonic conjugate</em> of the potential. We call <span class="math inline">\(F(z)\)</span> the <em>complex potential</em>, and <span class="math inline">\(\psi(x,y)\)</span> the <em>stream function</em>.</p>
<p>Since <span class="math inline">\(F(z)\)</span> is analytic inside the boundary region, we know that it must satisfy the Cauchy-Riemann equations in this region, <span class="math display">\[
\frac{\partial \phi}{\partial x} = \frac{\partial \psi}{\partial y} \quad , \quad
\frac{\partial \phi}{\partial y} = -\frac{\partial \psi}{\partial x} \ .
\]</span> Moreover, the potential <span class="math inline">\(\phi(x,y)\)</span> and the stream function <span class="math inline">\(\psi(x,y)\)</span> must each satisfy Laplace’s equation inside the boundary region, <span class="math display">\[
\nabla^2 \phi(x,y) = 0 \quad , \quad \nabla^2 \psi(x,y) = 0 \ .
\]</span> Since the stream function is the harmonic conjugate of the potential, we can express it formally as a function of the potential by <span class="math display">\[
\psi(x,y) = -\int dx \ \frac{\partial \phi}{\partial y} + \int dy \ \frac{\partial \phi}{\partial x} \ .
\]</span> Indeed, this relationship follows directly from the Cauchy-Riemann equations. This means that the stream function is completely determined by the potential, up to additive constants.</p>
<p>We also know that the level curves of <span class="math inline">\(\phi(x,y)\)</span>, i.e.&nbsp;the equipotentials, must be perpendicular to the level curves of <span class="math inline">\(\psi(x,y)\)</span> in this region, or equivalently <span class="math inline">\(\nabla \phi \cdot \nabla \psi = 0\)</span>. This lets us assign meaning to the stream function. The level curves of the stream function represent the direction of flow of electric field lines. To see why this is true, observe we can take the gradient of <span class="math inline">\(\psi(x,y)\)</span> and express it directly in terms of the electric field <span class="math inline">\(\mathbf{E} = -\nabla \phi\)</span> using the Cauchy-Riemann equations. We have <span class="math display">\[
\nabla \psi = \frac{\partial \psi}{\partial x} \mathbf{e}_x + \frac{\partial \psi}{\partial y} \mathbf{e}_y = -\frac{\partial \phi}{\partial y} \mathbf{e}_x + \frac{\partial \phi}{\partial x} \mathbf{e}_y = E_y \mathbf{e}_x - E_x \mathbf{e}_y \ .
\]</span> That is, we have <span class="math display">\[
\mathbf{E}(x,y) = \frac{\partial \psi}{\partial y} \mathbf{e}_x - \frac{\partial \psi}{\partial x} \mathbf{e}_y \ .
\]</span> Since <span class="math inline">\(\nabla \psi\)</span> is perpendicular to the level curves of <span class="math inline">\(\psi(x,y)\)</span>, and since <span class="math inline">\(\mathbf{E} \cdot \nabla \psi = 0\)</span>, it must be the case that the electric field lines point along the level curves of the stream function.</p>
<p>We can also express the electric field directly in terms of a the complex derivative of the complex potential <span class="math inline">\(F(z)\)</span>. Using the properties of complex derivatives, we can write <span class="math display">\[
\frac{dF}{dz} = \frac{\partial \phi}{\partial x} - i \frac{\partial \phi}{\partial y} = -E_x + i E_y \ .
\]</span> Notice if we then take the negative complex conjugate of this derivative, we get a function whose real and imaginary parts are the components of the electric field, <span class="math display">\[
-\bigg(\frac{dF}{dz}\bigg)^* = E_x + i E_y \ .
\]</span> This is just the complex equivalent of the statement that the electric field is the negative gradient of the potential.</p>
<section id="example-complex-potential-of-an-infinite-uniformly-charged-wire" class="level5">
<h5 class="anchored" data-anchor-id="example-complex-potential-of-an-infinite-uniformly-charged-wire">Example: Complex potential of an infinite uniformly charged wire</h5>
<p>Consider again an infinitely long wire of uniform charge line density <span class="math inline">\(\lambda\)</span> oriented along the <span class="math inline">\(z\)</span>-axis. We know the electric field is given in cylindrical coordinates by <span class="math display">\[
\mathbf{E}(\mathbf{x}) = \frac{2\lambda}{\varrho} \mathbf{e}_\varrho \ ,
\]</span> which implies that the potential is <span class="math display">\[
\phi(\mathbf{x}) = -2\lambda \log\varrho \ .
\]</span> We’d like to find the complex potential <span class="math inline">\(F(z)\)</span> for this wire in the <span class="math inline">\(xy\)</span>-plane. We can then write the ordinary potential in the form <span class="math display">\[
\phi(x,y) = -\lambda \log(x^2 + y^2) \ .
\]</span> Away from the wire, the potential must satisfy Laplace’s equation <span class="math inline">\(\nabla^2 \phi(x,y) = 0\)</span>. The associated stream function <span class="math inline">\(\psi(x,y)\)</span> can most easily be found by applying the Cauchy-Riemann equations to <span class="math inline">\(\phi(x,y)\)</span>. We have <span class="math display">\[
\begin{align*}
\frac{\partial \psi}{\partial y} &amp;= \frac{\partial \phi}{\partial x} = -2\lambda \frac{x}{x^2 + y^2} \ , \\
\frac{\partial \psi}{\partial x} &amp;= -\frac{\partial \phi}{\partial y} = 2\lambda \frac{y}{x^2 + y^2} \ .
\end{align*}
\]</span> Integrating both sides of these equations, we then get <span class="math display">\[
\begin{align*}
\psi(x,y) &amp;= -2\lambda \int dy \ \frac{x}{x^2 + y^2} = -2\lambda \tan^{-1} \frac{y}{x} + c_1(x)  \ , \\
\psi(x,y) &amp;= 2\lambda \int dx \ \frac{y}{x^2 + y^2} = 2\lambda \tan^{-1} \frac{x}{y} + c_2(y)  \ .
\end{align*}
\]</span> Now, observe that we can use a trig identity to write <span class="math display">\[
\tan^{-1} \frac{x}{y} = \frac{\pi}{2} - \tan^{-1} \frac{y}{x} \ .
\]</span> This means we must have <span class="math display">\[
\psi(x,y) = -2\lambda \tan^{-1} \frac{y}{x} + c_1(x) = 2\lambda \bigg(\frac{\pi}{2} - \tan^{-1} \frac{y}{x}\bigg) + c_2(y) \ .
\]</span> For these equations to be consistent, we require that <span class="math inline">\(c_1(x)\)</span> and <span class="math inline">\(c_2(y)\)</span> both be constant, with <span class="math inline">\(c_1 = \pi\lambda + c_2\)</span>. Any choice of constants will work so long as this equation is satisfied. We’ll choose <span class="math inline">\(c_1=0\)</span>, so that the stream function can be written <span class="math display">\[
\psi(x,y) = -2\lambda \tan^{-1} \frac{y}{x} \ .
\]</span> This means the complex potential is then <span class="math display">\[
F(z) = \phi(x,y) + i \psi(x,y) = -\lambda \log(x^2 + y^2) - i \ 2\lambda \tan^{-1} \frac{y}{x} \ .
\]</span> We can rewrite this as an explicit function of <span class="math inline">\(z = x+iy\)</span> by observing that in polar coordinates we have <span class="math display">\[
\log z = \log |z| e^{i\varphi} = \log(|z|) + i \varphi = \frac{1}{2} \log(x^2 + y^2) + i \tan^{-1} \frac{y}{x} \ .
\]</span> Plugging this into the complex potential and simplifying, we finally get <span class="math display">\[
F(z) = -2 \lambda \log z \ .
\]</span> Surprisingly, the complex potential looks almost identical to the ordinary potential, except with <span class="math inline">\(\varrho\)</span> replaced by <span class="math inline">\(z\)</span>.</p>
<p>It’s worth mentioning another interesting fact. Notice that in calculating the complex potential for the wire that we’re only looking at the projection of the wire onto the <span class="math inline">\(xy\)</span>-plane. Since the wire is oriented along the <span class="math inline">\(z\)</span>-axis, its projection must be a point charge. This means that the complex potential of a point charge in two dimensions is exactly the same as the complex potential of an infinitely long wire. Indeed, the 2-dimensional Green’s function for a point charge <span class="math inline">\(q\)</span> at the origin is <span class="math inline">\(G(\mathbf{x}) = -2 \log \varrho\)</span>, which means its potential is <span class="math inline">\(\phi(\mathbf{x}) = -2q \log\varrho\)</span>. If we thus set <span class="math inline">\(q = \lambda\)</span> then the two potentials are evidently identical.</p>
</section>
</section>
<section id="conformal-mappings" class="level3">
<h3 class="anchored" data-anchor-id="conformal-mappings">Conformal Mappings</h3>
<p>Now, recall that we can also think of any complex function as a geometric transformation acting on the complex plane. That is, any complex function <span class="math inline">\(w = T(z)\)</span> can be thought of as mapping points <span class="math inline">\(z = x + iy\)</span> in the <span class="math inline">\(z\)</span>-plane to points <span class="math inline">\(w = u+iv\)</span> in the <span class="math inline">\(w\)</span>-plane. When <span class="math inline">\(T(z)\)</span> is analytic in some region of the <span class="math inline">\(z\)</span>-plane, these transformations are called <em>conformal mappings</em>. Conformal mappings can be shown to preserve the angles between curves under mapping. Moreover, under a conformal mapping the area element <span class="math inline">\(da = dxdy\)</span> merely gets rescaled to a new area element <span class="math inline">\(da' = dudv\)</span> by <span class="math display">\[
du dv = \bigg|\frac{dw}{dz}\bigg|^2 dxdy \ .
\]</span> Most importantly for our purposes, conformal mappings preserve harmonic functions. That is, if <span class="math inline">\(\phi(u,v)\)</span> is some function that satisfies Laplace’s equation in the <span class="math inline">\(w\)</span>-plane, then <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span> satisfies Laplace’s equation in the original <span class="math inline">\(z\)</span>-plane, and the boundary conditions are preserved under the transformation <span class="math inline">\(w = T(z)\)</span>.</p>
<p>Let’s first prove the first part. Suppose <span class="math inline">\(\phi(u,v)\)</span> is harmonic in some region of the <span class="math inline">\(w\)</span>-plane, meaning inside this region it satisfies Laplace’s equation with respect to <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, <span class="math display">\[
\frac{\partial^2 \phi}{\partial u^2} + \frac{\partial^2 \phi}{\partial v^2} = 0 \ .
\]</span> Since <span class="math inline">\(\phi(u,v)\)</span> is harmonic, it must be the real part of some analytic function <span class="math inline">\(F(w) = \phi(u,v) + i\psi(u,v)\)</span> in the <span class="math inline">\(w\)</span>-plane. And since the composition of analytic functions is also analytic, then the function <span class="math display">\[
F(T(z)) = \phi\big(u(x,y), v(x,y)\big) + i \psi\big(u(x,y), v(x,y)\big)
\]</span> must also be analytic in some region of the <span class="math inline">\(z\)</span>-plane. In particular, this means the function <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span> must also be harmonic in this region of the <span class="math inline">\(z\)</span>-plane, hence satisfying Laplace’s equation with respect to <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, <span class="math display">\[
\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} = 0 \ .
\]</span> We’ll now prove the second part, namely that conformal mappings preserve the boundary conditions. We’ll focus on the usual cases where we have Dirichlet or Neumann boundary conditions. The mixed boundary condition case follows from these.</p>
<p>Suppose <span class="math inline">\(\mathcal{C}_z\)</span> is some smooth curve in the <span class="math inline">\(z\)</span>-plane that under the conformal mapping <span class="math inline">\(w=T(z)\)</span> maps to another smooth curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane. Suppose first that <span class="math inline">\(\phi(u,v) = \phi_0\)</span> is constant along the curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane. Clearly then, we have <span class="math display">\[
\phi(x,y) = \phi\big(u(x,y), v(x,y)\big) = \phi_0 \ .
\]</span> That is, <span class="math inline">\(\phi(x,y)\)</span> will also be constant along the curve <span class="math inline">\(\mathcal{C}_z\)</span> in the <span class="math inline">\(z\)</span>-plane. This proves that Dirichlet boundary conditions are preserved under a conformal mapping.</p>
<p>Suppose next that <span class="math inline">\(\partial \phi / \partial n_w = 0\)</span> along the curve <span class="math inline">\(\mathcal{C}_w\)</span> in the <span class="math inline">\(w\)</span>-plane, where <span class="math inline">\(\mathbf{n}_w\)</span> is the normal vector to this curve. Since <span class="math display">\[
\frac{\partial \phi}{\partial n_w} = \nabla \phi(u,v) \cdot \mathbf{n}_w = 0 \ ,
\]</span> this can only be true if the curve <span class="math inline">\(\mathcal{C}_w\)</span> is perpendicular to the level curves of <span class="math inline">\(\phi(u,v)\)</span> in the <span class="math inline">\(w\)</span>-plane. However, the level curves of <span class="math inline">\(\phi(u,v)\)</span> are the same as the level curves of <span class="math inline">\(\phi(x,y) = \phi\big(u(x,y), v(x,y)\big)\)</span>, since constants get mapped to constants under the conformal mapping. This means in the <span class="math inline">\(z\)</span>-plane that the level curves of <span class="math inline">\(\phi(x,y)\)</span> will again be perpendicular to the curve <span class="math inline">\(\mathcal{C}_z\)</span>. That is, if <span class="math inline">\(\mathbf{n}_z\)</span> is the normal vector to the curve <span class="math inline">\(\mathcal{C}_z\)</span> we must have <span class="math display">\[
\frac{\partial \phi}{\partial n_z} = \nabla \phi\big(u(x,y), v(x,y)\big) \cdot \mathbf{n}_z = 0 \ .
\]</span> This proves that Neumann boundary conditions are preserved under a conformal mapping. By combining these results together, it’s possible to show that mixed boundary conditions are also preserved under conformal mappings.</p>
</section>
<section id="d-boundary-value-problems" class="level3">
<h3 class="anchored" data-anchor-id="d-boundary-value-problems">2D Boundary Value Problems</h3>
<p>The results of the previous section mean that, given some conformal mapping, we essentially have a duality between BVPs in the <span class="math inline">\(xy\)</span>-plane and BVPs in the <span class="math inline">\(uv\)</span>-plane. If we can somehow find such a conformal mapping that simplifies the problem so that it’s much easier to solve in the new space using any of the techniques we’ve covered so far, we can map it back to get the potential that solves the original BVP.</p>
<p>Of course, the challenging part is finding a conformal mapping <span class="math inline">\(w = T(z)\)</span> that simplifies the given problem. There’s an art to this, involving looking at the geometry of the original problem and using that to identify a good transformation that makes the problem easier to solve in a new space. This is best shown by example.</p>
<p>Let’s start with a relatively simple BVP that we can solve using methods we’ve already covered.</p>
<section id="example-long-hollow-cylinder-held-at-two-different-potentials" class="level5">
<h5 class="anchored" data-anchor-id="example-long-hollow-cylinder-held-at-two-different-potentials">Example: Long hollow cylinder held at two different potentials</h5>
<p>Suppose an infinitely long hollow cylinder of radius <span class="math inline">\(R\)</span> is such that exactly half of the circular cross-section of the cylinder is held at a constant potential <span class="math inline">\(V\)</span>, while the other half is grounded. We’ll assume each half of the cylinder is separated by a very thin insulating sheet. We’ll assume that no other source charges are present inside our outside the cylinder. We’re interested in finding the potential at each point inside of the cylinder.</p>
<p>FIGURE (show cylinder with given potentials)</p>
<p>Inside the cylinder the potential must satisfy Laplace’s equation. We’ll formulate this problem as a BVP in Cartesian coordinates, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(x,y) = 0 \ , \\
\text{where} \ \phi(x,y) = 0 \ \text{when} \ x^2+y^2 = R^2 \ \text{and} \ x &gt; 0  \ , \\
\text{and} \ \phi(x,y) = V \ \text{when} \ x^2+y^2 = R^2 \ \text{and} \ x &lt; 0 \ .
\end{cases}
\end{align*}
\]</span> We’ll solve this problem two different ways to show that the results agree, first using separation of variables, and second using conformal mappings.</p>
<p>First, recall from the previous chapter that any BVP with cylindrical symmetry, as this problem does, has a solution in cylindrical coordinates of the form <span class="math display">\[
\phi(\varrho,\varphi) = a_0 + b_0 \log\varrho + \sum_{n=1}^\infty \big[(a_n \cos n\varphi + b_n \sin n\varphi)\varrho^n + (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n}\big] \ .
\]</span> For the potential to stay finite inside the cylinder we require that <span class="math inline">\(b_0 = c_n = d_n = 0\)</span>. What remains then is a Fourier series, <span class="math display">\[
\phi(\varrho,\varphi) = a_0 + \sum_{n=1}^\infty (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n} \ .
\]</span> The coefficients can be found using standard Fourier series methods. By applying the boundary conditions, one can show that <span class="math inline">\(a_0 =V/2\)</span>, <span class="math inline">\(a_n=0\)</span> for all <span class="math inline">\(n\)</span>, and <span class="math inline">\(b_n=0\)</span> for all even <span class="math inline">\(n\)</span>, while for odd <span class="math inline">\(n\)</span> we have <span class="math display">\[
b_n = -\frac{2V}{n\pi R^n} \quad , \quad n=1,3,5,\cdots \ .
\]</span> Plugging these in, we get <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{2V}{\pi} \sum_{n=1,3,5,\cdots} \bigg(\frac{\varrho}{R}\bigg)^n \frac{\sin n\varphi}{n} \ .
\]</span> It turns out this solution can also be written in closed form by using the Taylor expansion of the arctangent function. We get <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{V}{\pi} \tan^{-1} \frac{2R\varrho \sin\varphi}{R^2 - \varrho^2} \ .
\]</span> Let’s now show that we get the same result using conformal mappings. Since the problem is cylindrically symmetric, we know that the solution must only depend on <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Suppose then that we seek a potential <span class="math inline">\(\phi(x,y)\)</span>, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the real and imaginary components of a complex variable <span class="math inline">\(z\)</span>. Our goal is to find a conformal mapping <span class="math inline">\(w = T(z)\)</span> that makes <span class="math inline">\(\phi(u,v)\)</span> especially easy to write down in the <span class="math inline">\(w\)</span>-plane. To that end, consider the following conformal mapping, <span class="math display">\[
w = -i \frac{z-R}{z+R} \ .
\]</span> By writing <span class="math inline">\(w = u(x,y) + iv(x,y)\)</span> and simplifying this expression, it’s not hard to show that <span class="math display">\[
u = \frac{2Ry}{(x+R)^2 + y^2} \quad , \quad v = \frac{R^2 - x^2 - y^2}{(x+R)^2 + y^2} \ .
\]</span> To see why this is a useful conformal mapping to consider, let’s look at how the boundary cylinder transforms under the transformation. In the <span class="math inline">\(z\)</span>-plane, the boundary cylinder can be parametrized by <span class="math inline">\(z(\varphi) = R e^{i\varphi}\)</span>, where <span class="math inline">\(-\pi \leq \varphi \leq \pi\)</span>. Under the transformation <span class="math inline">\(w=T(z)\)</span>, the cylinder transforms to a curve in the <span class="math inline">\(w\)</span>-plane of the form <span class="math display">\[
w(\varphi) = -i \frac{z(\varphi)-R}{z(\varphi)+R} = -i \frac{R e^{i\varphi}-R}{R e^{i\varphi}+R} = -i \frac{e^{i\varphi}-1}{e^{i\varphi}+1} \ .
\]</span> By multiplying the numerator and denominator by <span class="math inline">\((e^{i\varphi}+1)^* = e^{-i\varphi}+1\)</span> and simplifying, it’s not hard to show that <span class="math display">\[
w(\varphi) = \frac{\sin\varphi}{1 + \cos\varphi} = \tan \frac{\varphi}{2} \ .
\]</span> This means the cylinder transforms to the curve <span class="math inline">\(u(\varphi) = \tan \varphi / 2\)</span> and <span class="math inline">\(v(\varphi) = 0\)</span> in the <span class="math inline">\(w\)</span>-plane. Clearly this is just the real axis in the <span class="math inline">\(w\)</span>-plane. When <span class="math inline">\(-\pi &lt; \varphi &lt; 0\)</span> the curve runs from <span class="math inline">\(u=-\infty\)</span> to <span class="math inline">\(u=0\)</span>, and when <span class="math inline">\(0 &lt; \varphi &lt; \pi\)</span> the curve runs from <span class="math inline">\(u=0\)</span> to <span class="math inline">\(u=\infty\)</span>. What we’ve managed to do with this conformal mapping is transform the surface of the cylinder in the <span class="math inline">\(z\)</span>-plane into the <span class="math inline">\(u\)</span>-axis in the <span class="math inline">\(w\)</span>-plane. Moreover, the interior of the cylinder in the <span class="math inline">\(z\)</span>-plane gets mapped to the upper half of the <span class="math inline">\(w\)</span>-plane.</p>
<p>What about the boundary conditions? If <span class="math inline">\(\phi(x,y) = 0\)</span> on the cylinder when <span class="math inline">\(x &gt; 0\)</span>, under the conformal mapping we must have <span class="math inline">\(\phi(u,0) = 0\)</span> when <span class="math inline">\(u &gt; 0\)</span>. Similarly, if <span class="math inline">\(\phi(x,y) = V\)</span> on the cylinder when <span class="math inline">\(x &lt; 0\)</span>, we must have <span class="math inline">\(\phi(u,0) = V\)</span> when <span class="math inline">\(u &lt; 0\)</span>. The points <span class="math inline">\(x = \pm R\)</span> in the <span class="math inline">\(z\)</span>-plane where these two parts of the cylinder joint both map to <span class="math inline">\(w = 0\)</span>. In the figure below we show a visualization of this mapping, including the boundary conditions.</p>
<p>FIGURE (show this conformal mapping with BCs included)</p>
<p>We now have an equivalent BVP to solve in the <span class="math inline">\(w\)</span>-plane, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(u,v) = 0 \ , \\
\text{where} \ \phi(u,0) = 0 \ \text{when} \ u &gt; 0 \ , \\
\text{and} \ \phi(u,0) = V \ \text{when} \ u &lt; 0 \ .
\end{cases}
\end{align*}
\]</span> So how do we find such a potential? The trick is to find a function <span class="math inline">\(\phi(w) = \phi(u,v)\)</span> that’s analytic in the upper half-plane while also satisfying the boundary conditions. If the function is analytic we know it must satisfy Laplace’s equation, and if it satisfies the boundary conditions we know it must be the unique solution. To that end, let’s try to guess a solution. Consider the function <span class="math display">\[
\phi(w) = \frac{V}{\pi} \text{Arg} \ w \ ,
\]</span> where <span class="math inline">\(\text{Arg} \ w\)</span> is the phase of <span class="math inline">\(w\)</span>, or equivalently the angle of the point <span class="math inline">\(w = u+iv\)</span> in the <span class="math inline">\(w\)</span>-plane relative to the positive <span class="math inline">\(u\)</span>-axis. First, notice that <span class="math inline">\(\phi(w)\)</span> satisfies the boundary conditions, since <span class="math inline">\(\text{Arg} \ w = 0\)</span> along the positive <span class="math inline">\(u\)</span>-axis and <span class="math inline">\(\text{Arg} \ w = \pi\)</span> along the negative <span class="math inline">\(u\)</span>-axis. Moreover, the function is analytic in the upper half plane <span class="math inline">\(v &gt; 0\)</span> since <span class="math inline">\(f(w) = \text{Arg} \ w\)</span> is analytic when <span class="math inline">\(v &gt; 0\)</span>. This guarantees that <span class="math inline">\(\phi(w) = \phi(u,v)\)</span> satisfies Laplace’s equation in the upper half plane. By the uniqueness theorem then, this must be the unique solution that solves the given BVP in the <span class="math inline">\(w\)</span>-plane.</p>
<p>We now need only transform back to the <span class="math inline">\(z\)</span>-plane to get the original potential <span class="math inline">\(\phi(x,y)\)</span> we seek. To do this we need to express the phase <span class="math inline">\(\text{Arg} \ w\)</span> as a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Since the phase of a product is the sum of their phases, we have <span class="math display">\[
\text{Arg} \ w = \text{Arg} \bigg(-i \frac{z-R}{z+R}\bigg) = \text{Arg} \ i - \text{Arg} \ \frac{z-R}{z+R} \ .
\]</span> Now, <span class="math inline">\(\text{Arg} \ i = \pi/2\)</span>, and the phase of the second term is just the arctangent of its imaginary part divided by its real part, which turns out to be given by <span class="math display">\[
\text{Arg} \ \frac{z-R}{z+R} = \tan^{-1} \frac{2yR}{R^2 - x^2 - y^2} \ .
\]</span> Plugging this back into the potential, we have <span class="math display">\[
\phi(x,y) = \frac{V}{\pi} \bigg[\frac{\pi}{2} - \tan^{-1} \frac{2yR}{R^2 - x^2 - y^2}\bigg] \ .
\]</span> Or, expressed in cylindrical coordinates, we have <span class="math display">\[
\phi(\varrho,\varphi) = \frac{V}{2} - \frac{V}{\pi} \tan^{-1} \frac{2R \varrho\sin\varphi}{R^2 - \varrho^2} \ .
\]</span> This is of course exactly the result we found above using separation of variables. It’s fair to ask if the use of complex methods made this problem any easier than just using separation of variables. In one sense, we replaced the need to solve a PDE with the algebra of complex variables. But in another sense we needed to be a lot more clever. For complex methods to be useful we need to be able to guess a conformal mapping that simplifies the problem. In this case we were able to do that, but it’s not always so obvious how to even find such a mapping. There are, however, problems that are much harder to solve using other methods where complex methods happen to be quite helpful. We’ll see an example of this next.</p>
</section>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example:</h5>
<ul>
<li>Work capacitor example or something just as complex.</li>
</ul>
</section>
</section>
</section>
<section id="multipole-moments" class="level2">
<h2 class="anchored" data-anchor-id="multipole-moments">Multipole Moments</h2>
<p>We will now turn our attention away from boundary value problems and consider again the problem of a localized charge distribution sitting somewhere in space, free of boundary surfaces like conductors or whatever. We know that in this setting we can formally express the potential as an integral <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \frac{\rho(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> The hard part is actually solving this integral for a general charge distribution <span class="math inline">\(\rho(\mathbf{x}')\)</span>. It would be nice then if we could find a systematic way to approximate the potential as a series in inverse powers of the distance of the field point from the charge distribution. Provided we can find such an expansion, we can often find a good approximate solution when we’re far away from the source charges by considering the first few expansion terms. This sort of expansion is called a <em>multipole expansion</em>.</p>
<section id="cartesian-multipole-expansion" class="level3">
<h3 class="anchored" data-anchor-id="cartesian-multipole-expansion">Cartesian Multipole Expansion</h3>
<p>Based on intuition and past examples, we expect that very far away from the charge distribution the potential should be approximately that of a point charge, falling off like <span class="math inline">\(1/r\)</span> when <span class="math inline">\(r \gg r'\)</span>. But we’ve also seen potentials that fall off like <span class="math inline">\(1/r^2\)</span> as well. In fact, we can find charge distributions with potentials that fall off like <span class="math inline">\(1/r^n\)</span> for <em>any</em> positive integer <span class="math inline">\(n\)</span>.</p>
<p>Since only the only part of the integrand that depends on the field point <span class="math inline">\(\mathbf{x}\)</span> is the Green’s function <span class="math inline">\(1/|\mathbf{x} - \mathbf{x}'|\)</span>, it suffices to find an expression of the Green’s function in powers of <span class="math inline">\(1/r\)</span>. Provided we can do this, we can plug the expansion back into the integral formula for the potential and get an expansion for the potential in powers of <span class="math inline">\(1/r\)</span>.</p>
<p>Suppose <span class="math inline">\(\alpha\)</span> is the angle between the vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}'\)</span>, i.e.&nbsp;<span class="math inline">\(\mathbf{x} \cdot \mathbf{x}' = rr' \cos \alpha\)</span>. We can then rewrite the Green’s function as <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{\sqrt{r^2 + r'^2 - 2 rr' \cos\alpha}} = \frac{1}{r} \frac{1}{\sqrt{1 + \varepsilon^2 - 2 \varepsilon \cos\alpha}} \ ,
\]</span> where <span class="math inline">\(\varepsilon \equiv r'/r\)</span>. We expect <span class="math inline">\(\varepsilon\)</span> to be small in the far field limit <span class="math inline">\(r \gg r'\)</span>, which means it suffices to look at only the first few expansion terms. We can then do a binomial expansion of the Green’s function in powers of <span class="math inline">\(\varepsilon^2 - 2 \varepsilon \cos\alpha\)</span> to get <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \bigg[1 - \frac{1}{2} (\varepsilon^2 - 2\varepsilon \cos\alpha) + \frac{3}{8} (\varepsilon^2 - 2\varepsilon \cos\alpha)^2 - \frac{5}{16} (\varepsilon^2 - 2\varepsilon \cos\alpha)^3 + \cdots \bigg] \ .
\]</span> Collecting terms in powers of <span class="math inline">\(\varepsilon\)</span> and substituting back in <span class="math inline">\(\varepsilon = r'/r\)</span> we then get <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} + \cos\alpha \frac{r'}{r^2} + \frac{1}{2} (3 \cos^2\alpha - 1) \frac{r'^2}{r^3} + \cdots \ .
\]</span> Finally, plugging this expansion of the Green’s function back into the potential, we get <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[\frac{1}{r} + \cos\alpha \frac{r'}{r^2} + \frac{1}{2} (3 \cos^2\alpha - 1) \frac{r'^2}{r^3} + \cdots\bigg] \ .
\]</span> For reasons we’ll explain below, we define <span class="math display">\[
\begin{align*}
q &amp;\equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \ , \\
\mathbf{p} &amp;\equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' \ , \\
\mathbf{Q} &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 \mathbf{x}' \otimes \mathbf{x}' - r'^2 \mathbf{1}\bigg] \ .
\end{align*}
\]</span> The first quantity <span class="math inline">\(q\)</span> is clearly a scalar. The second quantity <span class="math inline">\(\mathbf{p}\)</span> is evidently a vector. The last quantity <span class="math inline">\(\mathbf{Q}\)</span> is a rank-2 tensor. Its integrand contains an outer product of <span class="math inline">\(\mathbf{x}'\)</span> with itself, along with a term proportional to the rank-2 identity tensor <span class="math inline">\(\mathbf{1}\)</span>. Each of these quantities we’ve defined are called <em>multipole moments</em>. They’re called <em>moments</em> because they can each be thought of as the integral of a charge density times a power of <span class="math inline">\(\mathbf{x}'\)</span>, similar to how the moments of a probability distribution are integrals of a probability distribution times powers of a random variable.</p>
<p>If we substitute these moments into the expansion, it’s possible to show that we can rewrite the expansion as <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{r} + \frac{\mathbf{p} \cdot \mathbf{e}_r}{r^2} + \frac{\mathbf{e}_r \cdot \mathbf{Q} \cdot \mathbf{e}_r}{2r^3} + \cdots \ .
\]</span> We’ll show how to rewrite the expansion using these moments in the sections below. For now, notice if we let <span class="math inline">\(\mathbf{e}_r = \mathbf{x}/r\)</span>, we can rewrite the expansion in its more common form, <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \frac{q}{r} + \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} + \frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} + \cdots
} \ .
\]</span> This expansion is called the <em>Cartesian multipole expansion</em>, or more precisely the first few terms of the multipole expansion. In principle we could continue the expansion indefinitely using higher and higher multipole moments. We’ll do that later. Notice that all of the dependence on the source charge distribution is evidently contained in the multipole moments, leaving explicit any terms that depend on the field point.</p>
<p>Let’s now look at each of these expansion terms one by one and study their moments.</p>
</section>
<section id="monopole-moment" class="level3">
<h3 class="anchored" data-anchor-id="monopole-moment">Monopole Moment</h3>
<p>Substituting in the definition for the first multipole moment <span class="math inline">\(q\)</span>, we can write the first term in the multipole expansion as <span class="math display">\[
\phi_0(\mathbf{x}) = \frac{1}{r} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') = \frac{q}{r} \ .
\]</span> We call this first term in the expansion the <em>monopole potential</em>. Clearly it falls off like <span class="math inline">\(1/r\)</span>. The multipole moment <span class="math inline">\(q\)</span> is called the <em>monopole moment</em>. Evidently, the monopole moment is just the total <em>net charge</em> <span class="math inline">\(q\)</span> of the distribution, <span class="math display">\[
q \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \ .
\]</span> Thus, the first term in the expansion is just <span class="math inline">\(q/r\)</span>. This is exactly what we’d expect. Since the electric field is always given by <span class="math inline">\(\mathbf{E} = -\nabla \phi\)</span>, the electric field of the monopole potential will be given by Coulomb’s Law, with <span class="math display">\[
\mathbf{E}_0(\mathbf{x}) = \frac{q}{r^2} \mathbf{e}_r \ .
\]</span> The field lines for the monopole look exactly as we’d expect. We show a plot of these field lines below to compare with the field lines of the higher order multipole terms in the next few sections. As usual, the field lines are assume to point outward for a positive point charge, and inward for a negative point charge.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241108234730808.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Since this is the first term in the multipole expansion, we should expect that very far away from the charge distribution, the potential should approximate the of a point charge with total net charge <span class="math inline">\(q\)</span>. Of course, this is only true provided the net charge isn’t zero. If it is, we have to proceed to the next term in the multipole expansion, the dipole term.</p>
</section>
<section id="dipole-moment" class="level3">
<h3 class="anchored" data-anchor-id="dipole-moment">Dipole Moment</h3>
<p>Substituting in the definition for the second multipole moment <span class="math inline">\(\mathbf{p}\)</span>, we can write the second term in the multipole expansion as <span class="math display">\[
\phi_1(\mathbf{x}) = \frac{1}{r^2} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \cos\alpha r' = \frac{\mathbf{p} \cdot \mathbf{e}_r}{r^2} = \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} \ .
\]</span> In making this substitution we just used the fact that <span class="math inline">\(\mathbf{x} \cdot \mathbf{x}' = rr' \cos \alpha\)</span> to replace the <span class="math inline">\(\cos\alpha\)</span> term in the integrand, which lets us pull out a factor of <span class="math inline">\(\mathbf{x}/r\)</span> from the integrand since the integral is over <span class="math inline">\(\mathbf{x}'\)</span>.</p>
<p>We call this expansion term the <em>dipole potential</em>. This potential clearly falls off like <span class="math inline">\(1/r^2\)</span>. What remains is the multipole moment <span class="math inline">\(\mathbf{p}\)</span>, which encapsulates all of the information about the charge distribution. We call this moment the <em>dipole moment</em>, <span class="math display">\[
\mathbf{p} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \mathbf{x}' \ .
\]</span> As defined, the dipole moment evidently has dimensions of charge times distance. In particular, this means we should always expect the components of the dipole moment to go like <span class="math inline">\(qd\)</span>, where <span class="math inline">\(d\)</span> is some characteristic length scale.</p>
<p>But why do we call it the <em>dipole</em> moment? We’ve seen the dipole before, or more precisely the <em>physical dipole</em>. To recall, suppose we have two opposite point charges <span class="math inline">\(q\)</span> and <span class="math inline">\(-q\)</span> separated from each other by a distance <span class="math inline">\(d\)</span>. Suppose the charges are centered on the <span class="math inline">\(z\)</span>-axis with charge <span class="math inline">\(q\)</span> at position <span class="math inline">\(\mathbf{x}_+ = d/2 \mathbf{e}_z\)</span> and charge <span class="math inline">\(-q\)</span> at position <span class="math inline">\(\mathbf{x}_- = -d/2 \mathbf{e}_z\)</span>. We can then use the superposition principle to express the potential of the physical dipole as <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - d/2 \mathbf{e}_z|} - \frac{q}{|\mathbf{x} + d/2 \mathbf{e}_z|} \ .
\]</span> Rewriting the denominators in Cartesian coordinates, we can then write <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{\sqrt{x^2 + y^2 + (z-d/2)^2}} - \frac{q}{\sqrt{x^2 + y^2 + (z+d/2)^2}} \ .
\]</span> Here is a plot of what the field lines look like for the physical dipole, with <span class="math inline">\(+q\)</span> shown in red and <span class="math inline">\(-q\)</span> in blue. As always, the field lines go from positive charges to negative charges, and the equipotential curves are tangent to the field lines.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103010905701.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>This is the <em>exact</em> expression for the potential of the physical dipole. Clearly it doesn’t look at all like the expression for the dipole potential though. In fact, the dipole potential is just an approximation of the physical dipole potential in the far field limit. To see this, suppose we’re far away from the two charges, so that <span class="math inline">\(r \gg d\)</span>. Then we can do a binomial expansion of the roots to write $$ <span class="math display">\[\begin{align*}
\phi(\mathbf{x}) &amp;= q \bigg[\big(x^2 + y^2 + (z-d/2)^2\big)^{-1/2} - \big(x^2 + y^2 + (z+d/2)^2\big)^{-1/2}\bigg] \\
&amp;\approx \frac{q}{r} \bigg[\big(1-dz/r\big)^{-1/2} - \big(1+dz/r\big)^{-1/2}\bigg] \\
&amp;\approx \frac{q}{r} \big[(1 + dz/2r) - (1 - dz/2r)\big] \\
&amp;\approx \frac{qdz}{r^2} \ .

\end{align*}\]</span> $$</p>
<p>We now have a potential that falls off like <span class="math inline">\(1/r^2\)</span>. If we define <span class="math inline">\(\mathbf{p} = qd \mathbf{e}_z\)</span>, in the far field limit we can express this potential as <span class="math display">\[
\phi(\mathbf{x}) \approx \phi_1(\mathbf{x}) = \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} \ ,
\]</span> which is of course the dipole potential. It’s conventional to define a vector <span class="math inline">\(\mathbf{d} = d\mathbf{e}_z\)</span> and write the dipole moment for the physical dipole as <span class="math inline">\(\mathbf{p} = q \mathbf{d}\)</span>. Writing the dipole moment this way allows us to remove the requirement that the charges lie on the <span class="math inline">\(z\)</span>-axis.</p>
<p>We can model the behavior of the physical dipole in the far field limit in a slightly different way by considering an idealized physical dipole where we let <span class="math inline">\(d \to 0\)</span> while keeping <span class="math inline">\(qd\)</span> finite. This pushes the charges right on top of each other, giving an identical result to the far field dipole potential above. We call this idealized dipole configuration the <em>pure dipole</em>. The pure dipole is exactly the configuration that gives us the dipole potential in the multipole expansion.</p>
<p>Here is a plot of what the field lines of a pure dipole look like. Since the charges are right on top of each other in this case we show them both in red. Notice that these look just like the field lines of the physical dipole when far away from the charges. However, the field lines do look different near the charges, since all the higher order terms in the physical dipole potential identically vanish for the pure dipole potential.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103011630525.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>The physical dipole helps us assign meaning to what exactly the dipole moment and dipole potential represent. We can think of the dipole moment as representing the charge polarization of the source charge distribution <span class="math inline">\(\rho(\mathbf{x}')\)</span> along some axis <span class="math inline">\(\mathbf{d}\)</span>. To understand why this is true, suppose <span class="math inline">\(\rho(\mathbf{x}')\)</span> consists of <span class="math inline">\(N\)</span> discrete point charges <span class="math inline">\(q_i\)</span> located at positions <span class="math inline">\(\mathbf{x}_i\)</span>. Then <span class="math display">\[
\rho(\mathbf{x}') = \sum_{i=1}^N q_i \delta(\mathbf{x}' - \mathbf{x}_i) \ .
\]</span> We will now separate this sum into two sums, one for all the positive charges <span class="math inline">\(q_i^+\)</span> and one for all the negative charges <span class="math inline">\(-q_i^-\)</span>, <span class="math display">\[
\rho(\mathbf{x}') = \rho_+(\mathbf{x}') + \rho_-(\mathbf{x}') = \bigg(\sum_{i=1}^{N_+} q_i^+ \delta(\mathbf{x}' - \mathbf{x}_i^+)\bigg) - \bigg(\sum_{i=1}^{N_-} q_i^- \delta(\mathbf{x}' - \mathbf{x}_i^-)\bigg) \ ,
\]</span> where <span class="math inline">\(N_+\)</span> is the number of positive charges and <span class="math inline">\(N_-\)</span> is the number of negative charges, so that <span class="math inline">\(N = N_+ + N_-\)</span>.</p>
<p>Now, just as a collection of particles has a center of mass, a collection of charges has a <em>center of charge</em>. We can define a center of charge <span class="math inline">\(\mathbf{x}_\pm\)</span> for the positive and negative charges by <span class="math display">\[
\mathbf{x}_\pm \equiv \frac{\sum_{i=1}^{N_\pm} q_i^+ \mathbf{x}_i^\pm}{\sum q_i^\pm} \ ,
\]</span> On average then, the total positive and negative charges <span class="math inline">\(q_\pm\)</span> will be separated by some distance <span class="math inline">\(d = |\mathbf{d}|\)</span>, where <span class="math inline">\(\mathbf{d} = \mathbf{x}_+ - \mathbf{x}_-\)</span>. We can model this behavior with a physical dipole with a positive charge <span class="math inline">\(q_+\)</span> and a negative charge <span class="math inline">\(-q_-\)</span> separated by a distance <span class="math inline">\(d\)</span> along the <span class="math inline">\(\mathbf{d}\)</span>-axis. In the far field limit <span class="math inline">\(r \gg d\)</span>, we get a dipole moment that can be expressed in the form <span class="math display">\[
\mathbf{p} = q_+ \mathbf{x}_+ - q_- \mathbf{x}_- \ .
\]</span> Notice that in the special case <span class="math inline">\(q_+ = q_-\)</span>, we can simplify this further to get <span class="math inline">\(\mathbf{p} = q_+ \mathbf{d}\)</span>, which is the expression we had above. In this sense then, the dipole moment represents the average charge polarization of charges in a charge distribution.</p>
<p>FIGURE (sketch the dipole situation for a general charge distribution, showing the polarizations)</p>
<p>By writing <span class="math inline">\(\mathbf{E}_1 = -\nabla \phi_1\)</span> in index notation and plugging in the dipole potential above, while keeping in mind that <span class="math inline">\(\mathbf{p}\)</span> doesn’t depend on <span class="math inline">\(\mathbf{x}\)</span>, one can show that the electric field for the pure dipole is given by <span class="math display">\[
\boxed{
\mathbf{E}_1(\mathbf{x}) = \frac{3(\mathbf{p} \cdot \mathbf{x}) \mathbf{x} - r^2 \mathbf{p}}{r^5}
} \ .
\]</span> Notice that, while the dipole potential falls off like <span class="math inline">\(1/r^2\)</span> that, the dipole field falls off like <span class="math inline">\(1/r^3\)</span>, as we’d expect.</p>
<p>Let’s now work an example that involves calculating the dipole moment and potential for some general charge distribution.</p>
<section id="example-dipole-moment-of-a-spherical-shell-with-an-azimuthally-symmetric-charge-distribution" class="level5">
<h5 class="anchored" data-anchor-id="example-dipole-moment-of-a-spherical-shell-with-an-azimuthally-symmetric-charge-distribution">Example: Dipole moment of a spherical shell with an azimuthally symmetric charge distribution</h5>
<p>Consider a hollow spherical shell of radius <span class="math inline">\(R\)</span>, but instead of having uniform charge density, we have a polar-dependent surface charge density of the form <span class="math inline">\(\sigma' = k \cos\theta'\)</span>. We’d like to find the dipole moment and potential associated with this distribution.</p>
<p>First, notice that this distribution has no net charge, since the monopole moment is <span class="math display">\[
q = \int da' \ \sigma' = 2\pi R^2 k \int_0^\pi d\theta' \ \cos\theta' = 0 \ .
\]</span> This means the first term in the multipole expansion <em>must</em> be at least a dipole potential. Let’s now calculate the dipole moment. Notice first that the charge density is azimuthally symmetric about the <span class="math inline">\(z\)</span>-axis. This means the dipole potential must point along the <span class="math inline">\(z\)</span>-direction, with <span class="math inline">\(\mathbf{p} = p_z \mathbf{e}_z\)</span>. It thus suffices to calculate only the <span class="math inline">\(p_z\)</span> component of the dipole moment. We have <span class="math display">\[
p_z = \int da' \ \sigma' z' = \int_0^\pi R^2 \sin\theta' d\theta' \ k R \cos^2\theta' = \frac{4\pi}{3} k R^3 \ .
\]</span> With the dipole moment in hand we can now calculate the dipole potential. Evidently, we have <span class="math display">\[
\phi_1(\mathbf{x}) = \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} = \frac{p_z \cos\theta}{r^2} = \frac{4\pi}{3} kR \cos\theta \bigg(\frac{R}{r}\bigg)^2 \ .
\]</span> Since there is no monopole moment, this means in the far field limit the full potential can be approximated by <span class="math display">\[
\phi(\mathbf{x}) \approx \frac{4\pi}{3} kR \cos\theta \bigg(\frac{R}{r}\bigg)^2 \ .
\]</span> In fact, this is the <em>exact</em> potential for this charge distribution. We actually calculated it in the last chapter using separation of variables in spherical coordinates. This means that this charge distribution is already exactly a pure dipole.</p>
<p>We can calculate the associated electric field as well, which is <span class="math display">\[
\mathbf{E}(\mathbf{x}) = \frac{3(\mathbf{p} \cdot \mathbf{e}_r) \mathbf{e}_r}{r^3} - \frac{\mathbf{p}} {r^3} = \frac{4\pi}{3} k \bigg(\frac{R}{r}\bigg)^3 \bigg(3\cos\theta \mathbf{e}_r - \mathbf{e}_z\bigg) \ .
\]</span> As expected, the electric field falls off like <span class="math inline">\(1/r^3\)</span>, with field lines coming out from the top of the sphere (which we can think of as a <span class="math inline">\(+q\)</span> charge, and going into the bottom of the sphere (which we can think of as a <span class="math inline">\(-q\)</span> charge).</p>
<p>FIGURE (sketch the field lines of this sphere, showing it looks like a dipole)</p>
</section>
</section>
<section id="quadrupole-moment" class="level3">
<h3 class="anchored" data-anchor-id="quadrupole-moment">Quadrupole Moment</h3>
<p>Finally, let’s look at the quadratic term in the multipole expansion, which can be written <span class="math display">\[
\phi_2(\mathbf{x}) \equiv \frac{1}{2r^3} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') (3 \cos^2\alpha - 1) r'^2 \ .
\]</span> This term in the multipole expansion is called the <em>quadrupole potential</em>. Recall above that we also defined the multipole moment <span class="math display">\[
\mathbf{Q} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 \mathbf{x}' \otimes \mathbf{x}' - r'^2 \mathbf{1}\bigg] \ .
\]</span> We call this multipole moment the <em>quadrupole moment</em> or the <em>quadrupole tensor</em>. As defined, the quadrupole moment evidently have dimensions of charge times distances squared, or charge times area. In particular, this means we should always expect the components of the quadrupole moment to go like <span class="math inline">\(qd^2\)</span>, where <span class="math inline">\(d\)</span> is some characteristic length scale.</p>
<p>We’d like to rewrite the quadrupole potential to show its explicit dependence on the quadrupole moment. To do that, we’ll rewrite the quadrupole moment in index notation. In index notation the outer product <span class="math inline">\(\mathbf{x}' \otimes \mathbf{x}'\)</span> can be written <span class="math inline">\(x_i' x_j'\)</span> and the identity tensor <span class="math inline">\(\mathbf{1}\)</span> can be written <span class="math inline">\(\delta_{ij}\)</span>. We thus have <span class="math display">\[
Q_{ij} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Now, let’s look again at the potential. Observe if we substitute <span class="math inline">\(\mathbf{x} \cdot \mathbf{x}' = rr' \cos \alpha\)</span> we can write the quadrupole potential as <span class="math display">\[
\phi_2(\mathbf{x}) = \frac{1}{2r^3} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 \bigg(\frac{\mathbf{x} \cdot \mathbf{x}'}{r}\bigg)^2 - r'^2\bigg] \ .
\]</span> We’ll go ahead and rewrite this potential in index notation as well, <span class="math display">\[
\phi_2(\mathbf{x}) = \frac{1}{2r^3} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 \frac{(x_i x'_i) (x_j x_j')}{r^2} - r'^2\bigg] \ .
\]</span> We want the pull all dependence on <span class="math inline">\(\mathbf{x}\)</span> out of the integrand. We can do this be factoring <span class="math inline">\(x_i x_j\)</span> out of the first term, but if we do that we need to insert a <span class="math inline">\(\delta_{ij}\)</span> into the second term. We then have <span class="math display">\[
\phi_2(\mathbf{x}) = \frac{x_i x_j}{2r^5} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Notice now that the remaining integral is just the <span class="math inline">\(Q_{ij}\)</span> component of the quadrupole moment. We thus have <span class="math display">\[
\phi_2(\mathbf{x}) = \frac{Q_{ij} x_i x_j}{2r^5} \ .
\]</span> This is the usual way the quadrupole potential is written. We can also write it in abstract form by observing that <span class="math inline">\(Q_{ij} x_i x_j\)</span> is just the quadratic form <span class="math inline">\(\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}\)</span>, that is, the inner product of <span class="math inline">\(\mathbf{x}\)</span> with the vector <span class="math inline">\(\mathbf{Q} \cdot \mathbf{x}\)</span>. We can thus also write <span class="math display">\[
\phi_2(\mathbf{x}) =\frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} \ .
\]</span> With the quadrupole potential re-expressed in terms of the quadrupole moment, we’ve completed our derivation of the basic multipole expansion above up to the quadrupole term, <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{r} + \frac{\mathbf{p} \cdot \mathbf{x}}{r^3} + \frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2r^5} + \cdots \ .
\]</span> Let’s now say a bit about the properties of the quadrupole moment and what it represents physically. As we already mentioned, the quadrupole moment is indeed a rank-2 tensor. That is, it transforms as a rank-2 tensor under coordinate transformations, <span class="math display">\[
Q_{i'j'} = \frac{\partial x_{i'}}{\partial x_i} \frac{\partial x_{j'}}{\partial x_j} Q_{ij} \ .
\]</span> Indeed, this follows immediately from the fact that both the outer product and the identity tensor are valid rank-2 tensors, which means any linear superposition of them is also a rank-2 tensor.</p>
<p>It’s also easy to see that the quadrupole moment is <em>symmetric</em>, meaning <span class="math inline">\(Q_{ij} = Q_{ji}\)</span>. This also follows from the fact that the outer product of a vector with itself is symmetric, and the identity tensor is clearly also symmetric. Perhaps less intuitive though, the quadrupole moment is also <em>traceless</em>, meaning <span class="math inline">\(Q_{ii} = 0\)</span> when summed over <span class="math inline">\(i\)</span>. To see why, observe that <span class="math display">\[
Q_{ii} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 x_i' x_i' - r'^2 \delta_{ii}\bigg] = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') \bigg[3 r'^2 - 3 r'^2\bigg] = 0 \ .
\]</span> Here, we used the fact that <span class="math inline">\(x_i' x_i'\)</span> is just the inner product <span class="math inline">\(r'^2 = \mathbf{x}' \cdot \mathbf{x}'\)</span>, along with the fact that the trace of the identity is <span class="math inline">\(\delta_{ii} = 3\)</span> in three dimensions. We’ve thus shown that the quadrupole moment is a symmetric, traceless tensor of rank-2. Such a tensor is usually called an <em>irreducible tensor</em>. These conditions imply that the quadrupole moment only has <span class="math inline">\(3^2 - 3 - 1 = 5\)</span> independent components, since <span class="math inline">\(3\)</span> terms in a <span class="math inline">\(3 \times 3\)</span> symmetric matrix are redundant due to the <span class="math inline">\(Q_{ij} = Q_{ji}\)</span> requirement, and tracelessness implies that one of the terms in the diagonal depends on the rest, for instance <span class="math inline">\(Q_{zz} = -Q_{xx}-Q_{yy}\)</span>.</p>
<p>As with many rank-2 tensors, it’s common to express the components of the quadrupole moment as a matrix. If we enforce the redundancy requirements above for instance, we can write the quadrupole moment in matrix form as <span class="math display">\[
\mathbf{Q} = \begin{pmatrix}
Q_{xx} &amp; Q_{xy} &amp; Q_{xz} \\
Q_{xy} &amp; Q_{yy} &amp; Q_{yz} \\
Q_{xz} &amp; Q_{yz} &amp; -Q_{xx} - Q_{yy}
\end{pmatrix} \ .
\]</span> So what does the quadrupole moment represent physically? As we did with the dipole moment, we’ll consider a simple charge configuration, and show that in a certain limit its potential becomes the quadrupole potential. Consider then a configuration of point charges consisting of two oppositely oriented but parallel physical dipoles. We assume the charges inside each dipole is separated by a distance <span class="math inline">\(d\)</span>, and that the charge on each dipole is separated by the charge on the opposite dipole by the same distance <span class="math inline">\(d\)</span>. This will lead to a configuration of four opposite point charges <span class="math inline">\(\pm q\)</span> arranged as shown below.</p>
<p>FIGURE</p>
<p>We call this configuration of charges the <em>physical quadrupole</em>. First, notice that the physical quadrupole has no net charge, since all the charges sum to zero. Second, notice it also has no net dipole moment, since it consists of two opposite dipole moments <span class="math inline">\(\pm q\mathbf{d}\)</span>, which cancel each other when added together. These together evidently imply that whatever terms remain in the potential must fall off at least like <span class="math inline">\(1/r^3\)</span> in the limit <span class="math inline">\(d \ll r\)</span>.</p>
<p>We can write down the exact potential for the physical quadrupole using the principle of superposition. We have <span class="math display">\[
\phi(\mathbf{x}) = \frac{q}{|\mathbf{x} - d/2 (\mathbf{e}_y + \mathbf{e}_z)|} - \frac{q}{|\mathbf{x} - d/2 (\mathbf{e}_y - \mathbf{e}_z)|} + \frac{q}{|\mathbf{x} + d/2 (\mathbf{e}_y + \mathbf{e}_z)|} - \frac{q}{|\mathbf{x} - d/2 (\mathbf{e}_z - \mathbf{e}_y)|} \ .
\]</span> Written out in Cartesian components, this becomes <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q}{\sqrt{x^2 + (y-d/2)^2 + (z-d/2)^2}} - \frac{q}{\sqrt{x^2 + (y-d/2)^2 + (z+d/2)^2}} \\
&amp;- \frac{q}{\sqrt{x^2 + (y+d/2)^2 + (z-d/2)^2}} + \frac{q}{\sqrt{x^2 + (y+d/2)^2 + (z+d/2)^2}} \ .
\end{align*}
\]</span> Here is a plot of what the field lines look like for the physical quadrupole. Again, the positive charges are shown in red, and the negative charges in blue. As usual, the equipotentials curves are tangential to the field lines.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103012027269.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>We can again proceed as we did with the physical dipole and take a binomial expansion of the roots when <span class="math inline">\(d \ll r\)</span>. The end result of all the algebra is that in the far field limit we can approximate the potential of the physical quadrupole as <span class="math display">\[
\phi(\mathbf{x}) \approx \frac{3qd^2 yz}{r^5} \ .
\]</span> Evidently, in the far field limit the potential of the physical quadrupole goes like <span class="math inline">\(1/r^3\)</span>, which suggests the lowest expansion term of this potential is a quadrupole potential. However, since this approximation depends on <span class="math inline">\(yz\)</span>, it appears that only the <span class="math inline">\(Q_{yz}\)</span> and <span class="math inline">\(Q_{zy}\)</span> components of the quadrupole moment appear to contribute anything to the potential. We can see this by writing <span class="math display">\[
\phi(\mathbf{x}) \approx \frac{3d^2 yz}{r^5} = \frac{Q_{yz} yz}{2r^5} + \frac{Q_{zy} zy}{2r^5} \ .
\]</span> Evidently, we have <span class="math inline">\(Q_{yz} = Q_{zy} = 3qd^2\)</span>. The remaining components of <span class="math inline">\(\mathbf{Q}\)</span> all vanish, leaving us with the quadrupole matrix <span class="math display">\[
\mathbf{Q} = 3 qd^2\begin{pmatrix}
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0
\end{pmatrix} \ .
\]</span> Just as we did with the physical dipole, we can model the behavior of the physical quadrupole in the far field limit by considering an idealized physical quadrupole where we let <span class="math inline">\(d \to 0\)</span> while keeping <span class="math inline">\(qd\)</span> finite. This will give a potential completely equivalent to that of the physical quadrupole in the far field limit, since the higher order multipole terms all vanish. We call this idealized version of the physical quadrupole the <em>pure quadrupole</em>. The potential of the pure quadrupole is exactly the quadrupole potential.</p>
<p>Just as the physical dipole suggested something about what the dipole moment physically represents, the physical quadrupole suggests something about what the quadrupole moment physically represents. Notice each component of the quadrupole moment above is proportional to <span class="math inline">\(qd^2\)</span>, where <span class="math inline">\(d\)</span> is the separation distance between the charges. This means the quadrupole moment is saying something about the <em>spread</em> of the charge distribution. The more spread out the distribution is, the higher the quadrupole moment will be.</p>
<p>However, it’s slightly more complicated than this. To see why, recall the uniformly charged hollow sphere of radius <span class="math inline">\(R\)</span>. We showed that outside the sphere its potential is given by <span class="math inline">\(\phi(\mathbf{x}) = q/r\)</span>, where <span class="math inline">\(q = 4\pi R^2 \sigma\)</span> is the total charge on the sphere. This is an exact result, which evidently means the uniformly charged sphere has only one non-vanishing multipole moment, the monopole moment. This implies that both its dipole moment and quadrupole moment must be zero. Yet, if the quadrupole moment truly represented the spread of the charge distribution, we’d expect its components to go like <span class="math inline">\(qR^2\)</span>.</p>
<p>So what’s going on here? As it turns out, the quadrupole moment <em>also</em> measures the <em>anisotropy</em> of the charge distribution, or how much it deviates from being a sphere. The less spherical the distribution is, the more of a quadrupole moment it will have. We should thus <em>really</em> think of the quadrupole moment as a measure of a charge distribution’s spread and anisotropy.</p>
<p>Let’s now work an example to show how to calculate the quadrupole moment for a slightly more complicated charge distribution.</p>
<section id="example-uniformly-charged-ring" class="level5">
<h5 class="anchored" data-anchor-id="example-uniformly-charged-ring">Example: Uniformly charged ring</h5>
<p>Suppose we have a uniformly charged circular ring with radius <span class="math inline">\(a\)</span> and line charge density <span class="math inline">\(\lambda\)</span>. We’ll assume that the ring is centered at the origin in the <span class="math inline">\(xy\)</span>-plane. Clearly the ring has a net charge given by <span class="math inline">\(q = 2\pi a \lambda\)</span>, which means its potential must have a monopole contribution. It does not, however, have a dipole moment. This can be seen from symmetry. The ring clearly has no preferred direction in the <span class="math inline">\(xy\)</span>-plane since it’s circular and uniformly charged, which means it can’t have a dipole moment.</p>
<p>But does it have a quadrupole moment? This isn’t so clear from symmetry alone, so let’s calculate it explicitly. To do so we need to keep in mind we’re working with a one-dimensional distribution, which means <span class="math inline">\(dq = \lambda d\ell'\)</span>. Each component of the quadrupole moment will thus be given by the integral <span class="math display">\[
Q_{ij} = \int d\ell' \ \lambda(\mathbf{x}') \bigg[3 x_i' x_j' - r'^2 \delta_{ij}\bigg] \ .
\]</span> Along the ring, <span class="math inline">\(\lambda\)</span> is constant, <span class="math inline">\(r' = a\)</span> is constant, and the line element is just <span class="math inline">\(d\ell' = a d\varphi'\)</span>. We’re thus left to evaluate <span class="math display">\[
Q_{ij} = 3a\lambda \int_0^{2\pi} d\varphi' \ x_i' x_j' - a^3 \lambda \delta_{ij} \int_0^{2\pi} d\varphi' \ .
\]</span> The second integral is clearly just <span class="math inline">\(2\pi a^3 \lambda \delta_{ij}\)</span>, or equivalently <span class="math inline">\(qa^2 \delta_{ij}\)</span>. To evaluate the first integral we need to switch to polar coordinates, which means we’ll need to be explicit about which components we’re calculating.</p>
<p>Let’s calculate <span class="math inline">\(Q_{xx}\)</span> first. Since <span class="math inline">\(x' = a \cos\varphi'\)</span> and <span class="math inline">\(\delta_{xx} = 1\)</span>, we have <span class="math display">\[
\begin{align*}
Q_{xx} &amp;= 3a\lambda \int_0^{2\pi} d\varphi' \ a^2 \cos^2\varphi' - 2\pi a^3 \lambda \\
&amp;= 3\pi a^3 \lambda - 2\pi a^3 \lambda \\
&amp;= \pi a^3 \lambda \\
&amp;= \frac{1}{2} qa^2 \ .
\end{align*}
\]</span> Similarly, it’s easy to see we must get <span class="math inline">\(Q_{yy} = qa^2 / 2\)</span> as well. The vanishing trace property of the quadrupole tensor then implies we must have <span class="math inline">\(Q_{zz} = -Q_{xx} - Q_{yy} = -qa^2\)</span> for the remaining diagonal component.</p>
<p>Next, we need to find <span class="math inline">\(Q_{xy}\)</span>. Since <span class="math inline">\(y' = a\sin\varphi'\)</span> and <span class="math inline">\(\delta_{xy} = 0\)</span>, we have <span class="math display">\[
Q_{xy} = 3a\lambda \int_0^{2\pi} d\varphi' \ a^2 \cos\varphi' \sin\varphi' = 0 \ .
\]</span> This immediately implies <span class="math inline">\(Q_{yx} = 0\)</span> as well since the quadrupole tensor is symmetric. Last, observe <span class="math inline">\(Q_{xz} = Q_{yz} = 0\)</span> since for these components both the first and second integrals must vanish.</p>
<p>We thus have a quadrupole tensor <span class="math inline">\(\mathbf{Q}\)</span> with non-vanishing terms only along the diagonal, <span class="math display">\[
\mathbf{Q} = \frac{1}{2} qa^2\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; -2
\end{pmatrix} \ .
\]</span> With these moments in hand, we can now calculate the multipole expansion for the charged ring, <span class="math display">\[
\begin{align*}
\phi(\mathbf{x}) &amp;= \frac{q}{r} + \frac{Q_{xx} x^2 + Q_{yy} y^2 + Q_{zz} z^2}{2r^5} + \cdots \\
&amp;= \frac{q}{r} + \frac{qa^2(x^2 + y^2 - 2z^2)}{4r^5} + \cdots \ .
\end{align*}
\]</span> So how do we know this expansion is correct? One way to check is to calculate the exact potential in some simple direction. In this case, the clear choice is to choose the axis of symmetry, the <span class="math inline">\(z\)</span>-axis. We can calculate the exact potential along the <span class="math inline">\(z\)</span>-axis very easily from the integral formula. In fact we did that in the previous chapter, where we got <span class="math display">\[
\phi(z) = \frac{q}{\sqrt{a^2 + z^2}} = \frac{q}{z} - \frac{qa^2}{2z^3} + \cdots \ .
\]</span> Clearly this agrees with the expansion derived above when <span class="math inline">\(x = y = 0\)</span>. However, the expansion derived above works for <em>any</em> field point, not just those along the <span class="math inline">\(z\)</span>-axis. Indeed, we already have a good approximation to the potential for the ring when <span class="math inline">\(r \gg z\)</span>. So long as we’re far enough away from the ring the higher order moments are negligible. It’s really in this sense that the multipole expansion is most useful in practice.</p>
<hr>
<p>To find the electric field associated to the quadrupole term we can differentiate it in the usual way. By writing the potential in index notation and using the symmetric property of the quadrupole moment, one can show the components of the quadrupole field are given by <span class="math display">\[
E_k(\mathbf{x}) = \frac{5 Q_{ij} x_i x_j x_k - 2r^2 Q_{ik} x_k}{2r^7} \ .
\]</span> As expected, the quadrupole field falls off like <span class="math inline">\(1/r^4\)</span>. We can also express this in vector notation as <span class="math display">\[
\boxed{
\mathbf{E}_2(\mathbf{x}) = \frac{5 (\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}) \mathbf{x} - 2r^2(\mathbf{Q} \cdot \mathbf{x})}{2r^7}
} \ .
\]</span> Below is a plot of the field lines of the pure quadrupole, with the charges shown all in red. Notice that these field lines agree with those of the physical quadrupole in the far field limit, but differ close to the charges due to the lack of higher order moments. The density of field lines indicate the strength of the field at a given point. Near the charges the field lines are extremely strong compared to farther away, due to the fact that the quadrupole field falls off very rapidly, as <span class="math inline">\(1/r^4\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../resources/image-20241103010154876.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
</section>
</section>
</section>
<section id="general-multipole-expansion" class="level2">
<h2 class="anchored" data-anchor-id="general-multipole-expansion">General Multipole Expansion</h2>
<p>We’ve now studied the first few terms of the multipole expansion in depth. In practice these are often the only terms we care about when finding an approximate expansion of the potential of some given. Nevertheless, it’s illuminating to find the general multipole expansion for all powers of <span class="math inline">\(1/r\)</span>, not just the first few. We will do that now, first considering the special case of azimuthally symmetric charge distributions before proceeding the more general distributions.</p>
<section id="greens-function-expansion" class="level3">
<h3 class="anchored" data-anchor-id="greens-function-expansion">Green’s Function Expansion</h3>
<p>Recall from above that we wrote the Green’s function in the following form, <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \frac{1}{\sqrt{1 + (r'/r)^2 - 2 (r'/r) \cos\alpha}} \ .
\]</span> We then used the binomial expansion in the limit <span class="math inline">\(r \gg r'\)</span> to find an expansion of the Green’s function up to the first few terms.</p>
<p>We’ll now do something slightly more clever. Recall from the appendix that we <em>defined</em> the Legendre polynomials <span class="math inline">\(P_\ell(x)\)</span> to be the expansion coefficients of the following <em>generating function</em> <span class="math inline">\(g(x,t)\)</span> when expanded in powers of <span class="math inline">\(t\)</span>, <span class="math display">\[
g(x,t) \equiv \frac{1}{\sqrt{1 + t^2 - 2xt}} = \sum_{\ell=0}^\infty P_\ell(x) t^\ell \ .
\]</span> Now, notice that this generating function looks exactly like the Green’s function, except with <span class="math inline">\(t = r'/r\)</span> and <span class="math inline">\(x = \cos\alpha\)</span>. This means we immediately have an expansion of the Green’s function in powers of <span class="math inline">\(1/r\)</span> given by</p>
<p><span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \sum_{\ell=0}^\infty P_\ell(\cos\alpha) \bigg(\frac{r'}{r}\bigg)^\ell \ .
\]</span> As written, this is the most general possible expansion of the Green’s function in powers of <span class="math inline">\(1/r\)</span>. Let’s make sure that this agrees with the expansion we derived before up to the first few terms. First, let’s recall the first few Legendre polynomials are <span class="math display">\[
P_0(\cos\alpha) = 1 \quad , \quad P_1(\cos\alpha) = \cos\alpha \quad , \quad P_2(\cos\alpha) = \frac{1}{2} (3 \cos^2\alpha - 1) \ .
\]</span> Expanding the Green’s function up to the quadratic term and plugging these in, we have <span class="math display">\[
\begin{align*}
\frac{1}{|\mathbf{x} - \mathbf{x}'|} &amp;= P_0(\cos\alpha) \frac{1}{r} + P_1(\cos\alpha) \frac{r'}{r^2} + P_2(\cos\alpha) \frac{r'^2}{r^3} + \cdots \\
&amp;= \frac{1}{r} + \cos\alpha \frac{r'}{r^2} + \frac{1}{2} (3 \cos^2\alpha - 1) \frac{r'^2}{r^3} + \cdots \ .
\end{align*}
\]</span> This is exactly what we derived before when deriving the first few terms of the Cartesian multipole expansion.</p>
<p>If we plug this Green’s function expansion back into the integral for the potential, we then get <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \ \frac{\rho(\mathbf{x}')}{r} \sum_{\ell=0}^\infty P_\ell(\cos\alpha) \bigg(\frac{r'}{r}\bigg)^\ell \ .
\]</span> Collecting the source-dependent terms all together, this becomes <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{1}{r^{\ell+1}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') P_\ell(\cos\alpha) r'^\ell \ .
\]</span> Now, the remaining integrals depend both on <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}'\)</span>, since the angle <span class="math inline">\(\alpha\)</span> between them depend on both points. This means we can’t exactly identify these integrals with the multipole moment just yet. Instead we’ll break this into two cases. First we’ll consider the case of azimuthally symmetric distributions, and then proceed to more general distributions.</p>
</section>
<section id="azimuthally-symmetric-expansion" class="level3">
<h3 class="anchored" data-anchor-id="azimuthally-symmetric-expansion">Azimuthally Symmetric Expansion</h3>
<p>Let’s first consider the special case where the charge distribution is azimuthally symmetric, so that <span class="math inline">\(\rho(\mathbf{x}') = \rho(r, \theta)\)</span>.</p>
<ul>
<li>This is turning out to be a lot harder and more subtle than expected.</li>
<li>Really the only thing I <em>need</em> from this expansion are the scalar multipole moments. Is there an easier way?</li>
<li>It may be easier to derive the general expansion first and do this as a special case, where <span class="math inline">\(m=0\)</span> for all <span class="math inline">\(\ell\)</span>.</li>
<li>Don’t forget to show the first non-vanishing moment is origin independent. Use spherical harmonics for this.</li>
</ul>
<p><span class="math display">\[
\phi(\mathbf{x}) = \frac{1}{r_&gt;} \sum_{\ell=0}^\infty c_\ell \bigg(\frac{r_&lt;}{r_&gt;}\bigg)^\ell P_\ell(\cos\theta) \ .
\]</span> <span class="math display">\[
\int d\theta \ \phi(\mathbf{x}) P_{\ell'}(\cos\theta) = \sum_{\ell=0}^\infty c_\ell \frac{r'^\ell}{r^{\ell+1}} \frac{2}{2\ell+1} \delta_{\ell\ell'}
\]</span></p>
<p><span class="math display">\[
\int d\theta \ \phi(\mathbf{x}) P_{\ell}(\cos\theta) = c_\ell \frac{r'^\ell}{r^{\ell+1}} \frac{2}{2\ell+1}
\]</span></p>
<p><span class="math display">\[
c_\ell = \frac{2\ell+1}{2} \frac{r^{\ell+1}}{r'^\ell} \int_{0}^{2\pi} d\theta \ \phi(\mathbf{x}) P_\ell(\cos\theta)
\]</span></p>
<p>We now want to eliminate the explicit dependent on <span class="math inline">\(\cos\alpha\)</span>. We can do that by making use of the <em>addition theorem</em> of spherical harmonics. We proved in the appendix that we can expand <span class="math inline">\(P_\ell(\cos\alpha)\)</span> in terms of the spherical harmonics by <span class="math display">\[
P_\ell(\cos\alpha) = \frac{4\pi}{2\ell+1} \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> If we plug this back into the Green’s function, we get <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r'}{r}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Notice that this expansion is now over two indices, <span class="math inline">\(\ell\)</span> and <span class="math inline">\(m\)</span>. For each <span class="math inline">\(\ell\)</span> there will be <span class="math inline">\(2\ell+1\)</span> terms in the sum indexed by <span class="math inline">\(m\)</span>.</p>
<p>We’ll call this version of the Green’s function expansion in spherical coordinates the <em>exterior</em> expansion. The exterior expansion is valid whenever <span class="math inline">\(r &gt; r'\)</span>. It’s worth mentioning that this derivation in terms of the generating function is completely symmetric under an interchange of <span class="math inline">\(r\)</span> and <span class="math inline">\(r'\)</span>. This means we can also get an <em>interior</em> expansion of the Green’s function when <span class="math inline">\(r &lt; r'\)</span> by <span class="math display">\[
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r'} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r}{r'}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Indeed, it’s common to combine these two expressions together by letting <span class="math inline">\(r_&lt; \equiv \min(r,r')\)</span> and <span class="math inline">\(r_&gt; \equiv \max(r,r')\)</span>, and writing <span class="math display">\[
\boxed{
\frac{1}{|\mathbf{x} - \mathbf{x}'|} = \frac{1}{r_&gt;} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r_&lt;}{r_&gt;}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi')
} \ .
\]</span> We won’t need this more general expansion to derive the spherical multipole expansion. It’s just worth being aware of, since this expansion can occasionally be used to solve various boundary value problems.</p>
</section>
<section id="spherical-expansion" class="level3">
<h3 class="anchored" data-anchor-id="spherical-expansion">Spherical Expansion</h3>
<p>If we plug the exterior Green’s function expansion back into the integral formula for the potential, we get <span class="math display">\[
\phi(\mathbf{x}) = \int d^3\mathbf{x}' \ \frac{\rho(\mathbf{x}')}{r} \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \bigg(\frac{r'}{r}\bigg)^\ell \sum_{m=-\ell}^\ell Y_{\ell m}(\theta,\varphi) Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> Now, notice that only the term <span class="math inline">\(r'^\ell Y_{\ell m}^*(\theta',\varphi')\)</span> depend on the source points <span class="math inline">\(\mathbf{x}'\)</span>. We’ll thus define the quantities <span class="math display">\[
q_{\ell m} \equiv \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r'^\ell Y_{\ell m}^*(\theta',\varphi') \ .
\]</span> These quantities are the only terms in the expansion that depend on the source points. They’re called the <em>spherical multipole moments</em>. These moments aren’t <em>exactly</em> the usual multipole moments, but they’re related to them in ways we’ll show shortly. At any rate, if we substitute <span class="math inline">\(q_{\ell m}\)</span> in for this integral, we can finally write <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \frac{4\pi}{2\ell+1} \frac{1}{r^{\ell+1}} \sum_{m=-\ell}^\ell q_{\ell m} Y_{\ell m}(\theta,\varphi)
} \ .
\]</span> As written, this is the most general form of the multipole expansion. We usually call the multipole expansion in this form the <em>spherical multipole expansion</em> since it involves an expansion in spherical coordinates.</p>
<p>Before proceeding, it’s worth briefly recalling a few properties of spherical harmonics. First, <span class="math inline">\(Y_{\ell m}(\theta,\varphi)\)</span> and <span class="math inline">\(Y_{\ell,-1m}(\theta,\varphi)\)</span> are related by the formula <span class="math inline">\(Y_{\ell,-m}(\theta,\varphi) = (-1)^m Y_{\ell m}^*(\theta,\varphi)\)</span>. This evidently implies that the moment <span class="math inline">\(q_{\ell m}\)</span> is related to the moment <span class="math inline">\(q_{\ell,-m}\)</span> by <span class="math inline">\(q_{\ell,-m} = (-1)^m q_{\ell m}^*\)</span>. The first few spherical harmonics when <span class="math inline">\(\ell=0,1,2\)</span> are given by $$ <span class="math display">\[\begin{align*}
Y_{00}(\theta,\varphi) &amp;= \sqrt{\frac{1}{4\pi}} \ , \quad

\begin{cases}
Y_{1,-1}(\theta,\varphi) &amp;= \sqrt{\frac{3}{8\pi}} \sin\theta e^{-i\varphi} \\
Y_{10}(\theta,\varphi)&amp; = \sqrt{\frac{3}{4\pi}} \cos\theta \\
Y_{11}(\theta,\varphi) &amp;= -\sqrt{\frac{3}{8\pi}} \sin\theta e^{i\varphi} \\
\end{cases} \ , \quad

\begin{cases}
Y_{2,-2}(\theta,\varphi) &amp;= \sqrt{\frac{15}{32\pi}} \sin^2 \theta e^{-2i\varphi} \\
Y_{2,-1}(\theta,\varphi) &amp;= \sqrt{\frac{15}{8\pi}} \sin\theta \cos\theta e^{-i\varphi} \\
Y_{20}(\theta,\varphi) &amp;= \sqrt{\frac{5}{16\pi}} (3\cos^2 \theta - 1) \\
Y_{21}(\theta,\varphi) &amp;= -\sqrt{\frac{15}{8\pi}} \sin\theta \cos\theta e^{i\varphi} \\
Y_{22}(\theta,\varphi) &amp;= \sqrt{\frac{15}{32\pi}} \sin^2 \theta e^{2i\varphi} \\
\end{cases} \ .
\end{align*}\]</span> $$</p>
<p>We now want to show that the spherical multipole expansion agrees with the basic multipole expansion when <span class="math inline">\(\ell=0,1,2\)</span>. Let’s proceed case by case. When <span class="math inline">\(\ell = 0\)</span>, we only have one term, <span class="math inline">\(m=0\)</span>. The moment <span class="math inline">\(q_{00}\)</span> is evidently given by <span class="math display">\[
q_{00} = \int d^3\mathbf{x}' \ \rho(\mathbf{x}') Y_{00}^*(\theta',\varphi') = \frac{q}{\sqrt{4\pi}} \ ,
\]</span> where <span class="math inline">\(q\)</span> is the usual monopole moment, or total net charge of the distribution. The <span class="math inline">\(\ell=0\)</span> expansion term is then just the monopole potential, <span class="math display">\[
\phi_0(\mathbf{x}) = \frac{q}{r} \ .
\]</span> Next, when <span class="math inline">\(\ell = 1\)</span> we have <span class="math inline">\(m=-1,0,1\)</span>. The associated multipole moments are evidently then <span class="math display">\[
\begin{align*}
q_{10} &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' Y_{10}^*(\theta',\varphi') = \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \cos\theta \ , \\
q_{1,\pm1} &amp;= \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' Y_{1,\pm 1}^*(\theta',\varphi') = \mp \sqrt{\frac{3}{8\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \sin\theta e^{\mp i\varphi} \ .
\end{align*}
\]</span> If we write <span class="math inline">\(e^{\pm i\varphi} = \cos\varphi \pm i \sin\varphi\)</span>, and use the formulas to convert spherical coordinates <span class="math inline">\((r',\theta',\varphi')\)</span> to Cartesian coordinates <span class="math inline">\((x',y',z')\)</span>, we get <span class="math display">\[
\begin{align*}
q_{10} &amp;= \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \cos\theta = \sqrt{\frac{3}{4\pi}}\int d^3\mathbf{x}' \ \rho(\mathbf{x}') z' \ , \\
q_{1,\pm 1} &amp;= \mp \sqrt{\frac{3}{8\pi}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') r' \sin\theta (\cos\varphi \mp i \sin\varphi) = \mp \sqrt{\frac{3}{8\pi}} \int d^3\mathbf{x}' \ \rho(\mathbf{x}') (x' \mp iy') \ .
\end{align*}
\]</span> Now, notice that the remaining terms in each integral are just the components of the dipole vector <span class="math inline">\(\mathbf{p}\)</span>, with <span class="math display">\[
q_{10} = \sqrt{\frac{3}{4\pi}} p_z \quad , \quad
q_{1,\pm 1} = \mp \sqrt{\frac{3}{8\pi}} (p_x \mp i p_y) \ .
\]</span> Then the <span class="math inline">\(\ell=1\)</span> terms in the spherical multipole expansion are <span class="math display">\[
\begin{align*}
\phi_1(\mathbf{x}) &amp;= \frac{4\pi}{3r^2} \big[q_{1,-1} Y_{1,-1}(\theta,\varphi) + q_{10} Y_{10}(\theta,\varphi) + q_{11} Y_{11}(\theta,\varphi)\big] \\
&amp;= \frac{4\pi}{3r^2} \bigg[\frac{3}{8\pi} \sin\theta e^{-i\varphi} (p_x + i p_y) + \frac{3}{4\pi} \cos\theta p_z + \frac{3}{8\pi} \sin\theta e^{i\varphi} (p_x - i p_y) \bigg] \\
&amp;= \frac{1}{r^2} \bigg[\frac{1}{2} \sin\theta e^{-i\varphi} (p_x + i p_y) + \cos\theta p_z + \frac{1}{2} \sin\theta e^{i\varphi} (p_x - i p_y)\bigg] \\
&amp;= \frac{1}{r^2} \big[x p_x + y p_y + z p_z \big] \ .
\end{align*}
\]</span> In the last step we again used the fact that <span class="math inline">\(e^{\pm i\varphi} = \cos\varphi \pm i \sin\varphi\)</span>. When this is plugged in and we simplify terms, we find that the imaginary parts all vanish. The remaining real parts then contain terms that turn out to be the Cartesian coordinates <span class="math inline">\((x,y,z)\)</span>. What remains in brackets is clearly just the dot product between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{p}\)</span>. We thus end up with the usual dipole potential, <span class="math display">\[
\phi_1(\mathbf{x}) = \frac{\mathbf{p} \cdot \mathbf{x}}{r^2} \ .
\]</span> Finally we’ll consider the <span class="math inline">\(\ell=2\)</span> expansion terms. In this case <span class="math inline">\(m=-2,-1,0,1,2\)</span>, which means there will be five terms. Using the same logic we did with the dipole term, one can show that these spherical moments can be written in the form</p>
<p><span class="math display">\[
\begin{align*}
q_{20} &amp;= \frac{1}{2} \sqrt{\frac{5}{4\pi}} Q_{zz} \ , \\
q_{2,\pm 1} &amp;= \mp \frac{1}{3} \sqrt{\frac{15}{8\pi}} (Q_{xz} \mp 2i Q_{yz}) \ , \\
q_{2,\pm 2} &amp;= \frac{1}{12} \sqrt{\frac{15}{2\pi}} (Q_{xx} - Q_{yy} \mp 2i Q_{xy}) \ ,
\end{align*}
\]</span> where each <span class="math inline">\(Q_{ij}\)</span> are the components of the usual quadrupole tensor <span class="math inline">\(\mathbf{Q}\)</span>. By plugging these into the <span class="math inline">\(\ell=2\)</span> expansion term and simplifying as before, we eventually end up with the usual quadrupole potential, <span class="math display">\[
\phi_2(\mathbf{x}) = \frac{Q_{ij} x_i x_j}{2r^5} = \frac{\mathbf{x} \cdot \mathbf{Q} \cdot \mathbf{x}}{2 r^5} \ .
\]</span> This shows that the spherical multipole expansion agrees with the basic multipole expansion up to <span class="math inline">\(\ell=2\)</span>. One could proceed to derive higher order multipole moments and potentials from this expansion as well. For example, by expanding the <span class="math inline">\(\ell=3\)</span> terms one can derive the octupole moment and octupole potential.</p>
<ul>
<li>If feeling judicious, maybe derive the general cartesian expansion using the irreducible representations of tensors</li>
</ul>
</section>
</section>
<section id="multipole-expansion-in-an-external-field" class="level2">
<h2 class="anchored" data-anchor-id="multipole-expansion-in-an-external-field">Multipole Expansion in an External Field</h2>
<ul>
<li>Rederive multipole expansion for a localized charge distribution in the presence of an external electric field</li>
<li>See: Notes, Greiner, Jackson</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../electrodynamics/bvps-2.html" class="pagination-link" aria-label="Boundary Value Problems II">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Boundary Value Problems II</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../electrodynamics/magnetostatics.html" class="pagination-link" aria-label="Magnetostatics">
        <span class="nav-page-text"><span class="chapter-title">Magnetostatics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>