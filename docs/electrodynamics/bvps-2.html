<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personal Notes - Boundary Value Problems II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../electrodynamics/multipole-expansion.html" rel="next">
<link href="../electrodynamics/bvps-1.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-2.html"><span class="chapter-title">Boundary Value Problems II</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Classical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/newtonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Newtonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/simple-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Simple Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/reference-frames.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Reference Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/lagrangian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lagrangian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/hamiltonian-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Hamiltonian Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/central-forces.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Central Forces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/coupled-oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Coupled Oscillations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/rigid-bodies.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rigid Bodies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/canonical-transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Canonical Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/integrability-and-chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Integrability and Chaos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classical-mechanics/continuum-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Continuum Mechanics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Electromagnetism</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/preliminaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/electrostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Electrostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Boundary Value Problems I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/bvps-2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Boundary Value Problems II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/multipole-expansion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Multipole Expansion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/magnetostatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Magnetostatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/maxwell-equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Maxwell’s Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/orthogonal-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix I: Orthogonal Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../electrodynamics/complex-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix II: Complex Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Circuit Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/circuit-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Lumped Circuit Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Analyzing Circuits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/nonlinear-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nonlinear Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/digital-abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Digital Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/amplifiers.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/first-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">First-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/second-order-systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second-Order Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/ac-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">AC Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/op-amps.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Operational Amplifiers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../circuits/energy-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Energy and Power</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Quantum Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/identical-particles.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Identical Particles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quantum-mechanics/second-quantization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Second Quantization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/thermodynamics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Thermodynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/kinetic-theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Kinetic Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/classical-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Classical Gases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-stat-mech.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Statistical Mechanics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistical-mechanics/quantum-gases.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Quantum Gases</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-partial-differential-equations" id="toc-linear-partial-differential-equations" class="nav-link active" data-scroll-target="#linear-partial-differential-equations">Linear Partial Differential Equations</a>
  <ul class="collapse">
  <li><a href="#general-problem" id="toc-general-problem" class="nav-link" data-scroll-target="#general-problem">General Problem</a></li>
  </ul></li>
  <li><a href="#separation-of-variables" id="toc-separation-of-variables" class="nav-link" data-scroll-target="#separation-of-variables">Separation of Variables</a>
  <ul class="collapse">
  <li><a href="#separation-of-variables-in-cartesian-coordinates" id="toc-separation-of-variables-in-cartesian-coordinates" class="nav-link" data-scroll-target="#separation-of-variables-in-cartesian-coordinates">Separation of Variables in Cartesian Coordinates</a></li>
  </ul></li>
  <li><a href="#separation-of-variables-in-spherical-coordinates" id="toc-separation-of-variables-in-spherical-coordinates" class="nav-link" data-scroll-target="#separation-of-variables-in-spherical-coordinates">Separation of Variables in Spherical Coordinates</a></li>
  <li><a href="#separation-of-variables-in-cylindrical-coordinates" id="toc-separation-of-variables-in-cylindrical-coordinates" class="nav-link" data-scroll-target="#separation-of-variables-in-cylindrical-coordinates">Separation of Variables in Cylindrical Coordinates</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../electrodynamics/preliminaries.html">Electromagnetism</a></li><li class="breadcrumb-item"><a href="../electrodynamics/bvps-2.html"><span class="chapter-title">Boundary Value Problems II</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Boundary Value Problems II</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p>In this chapter, we continue on with the topic of boundary value problems in electrostatics. We’ll introduce the separation of variables technique, a method that can be used to solve Laplace’s equation for a large class of problems, before solving some problems using this technique.</p>
<section id="linear-partial-differential-equations" class="level2">
<h2 class="anchored" data-anchor-id="linear-partial-differential-equations">Linear Partial Differential Equations</h2>
<p>In the previous chapter we showed that, at least formally, we can solve Poisson’s equation subject to some given set of boundary conditions by the integral <span class="math display">\[
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G}{\partial n'} \bigg] \ ,
\]</span> where <span class="math inline">\(G(\mathbf{x} - \mathbf{x}')\)</span> is the Green’s function. This isn’t, however, the <em>only</em> way to solve Poisson’s equation, nor is it always the most useful. For all but the simplest problems this integral can be very difficult to solve in practice.</p>
<section id="general-problem" class="level3">
<h3 class="anchored" data-anchor-id="general-problem">General Problem</h3>
<p>Another way we can proceed is to solve Poisson’s equation directly using standard PDE methods. Suppose we have a linear PDE of the form <span class="math display">\[
\mathcal{L} \phi(\mathbf{x}) = f(\mathbf{x}) \ ,
\]</span> where <span class="math inline">\(\mathcal{L}\)</span> is a linear partial differential operator and <span class="math inline">\(f(\mathbf{x})\)</span> is some source term, e.g.&nbsp;the charge density <span class="math inline">\(\rho(\mathbf{x})\)</span>. We assume that some set of boundary conditions may be given implicitly.</p>
<p>When we say <span class="math inline">\(\mathcal{L}\)</span> is a linear operator, we mean that for any two functions <span class="math inline">\(\phi_1(\mathbf{x})\)</span> and <span class="math inline">\(\phi_2(\mathbf{x})\)</span> and constants <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, we have <span class="math display">\[
\mathcal{L} \big(\alpha\phi_1(\mathbf{x}) + \beta\phi_2(\mathbf{x})\big) = \alpha\mathcal{L} \phi_1(\mathbf{x}) + \beta\mathcal{L} \phi_2(\mathbf{x}) \ .
\]</span> Linearity means we can compose solutions to a linear PDE using the principle of superposition. In fact we can say more than this. The theory of linear PDEs guarantees that we can solve <em>any</em> linear PDE by finding two solutions of a particular kind and summing them together:</p>
<ul>
<li>A general <em>homogeneous solution</em> <span class="math inline">\(\phi_h(\mathbf{x})\)</span> that solves the homogeneous PDE <span class="math inline">\(\mathcal{L} \phi_h(\mathbf{x}) = 0\)</span> subject to the boundary conditions.</li>
<li>A <em>particular solution</em> <span class="math inline">\(\phi_p(\mathbf{x})\)</span> that solves the inhomogeneous PDE <span class="math inline">\(\mathcal{L} \phi_p(\mathbf{x}) = f(\mathbf{x})\)</span> in the absence of boundary conditions.</li>
</ul>
<p>Provided we can find these two solutions, the most general solution to <span class="math inline">\(\mathcal{L} \phi(\mathbf{x}) = f(\mathbf{x})\)</span> can be written in the form <span class="math display">\[
\phi(\mathbf{x}) = \phi_h(\mathbf{x}) + \phi_p(\mathbf{x}) \ .
\]</span> All of the PDEs we’ll see in electromagnetism, and indeed in most of physics, turn out to be linear second-order PDEs. The most general spatial second-order linear partial differential operator we can write down is a linear superposition of first and second partial derivatives, plus an ordinary function. We can write this with summation notation in the form <span class="math display">\[
\mathcal{L} = a_{ij}(\mathbf{x}) \frac{\partial^2}{\partial x_i \partial x_j} + b_i(\mathbf{x}) \frac{\partial}{\partial x_i} + c(\mathbf{x}) \ .
\]</span> In particular, we can see that the Laplacian <span class="math inline">\(\nabla^2\)</span> is a linear operator if we take <span class="math inline">\(a_{ij} = \delta_{ij}\)</span> and <span class="math inline">\(b_i = c = 0\)</span>. This means we can solve Poisson’s equation in the way specified before, by finding a homogeneous solution that solves Laplace’s equation subject to the boundary conditions, and a particular solution that solves Poisson’s equation with a given charge density <span class="math inline">\(\rho(\mathbf{x})\)</span>.</p>
<p>For a localized charge distribution, we already know how to find the particular solution via the integral <span class="math display">\[
\phi_p(\mathbf{x}) = \int d^3 \mathbf{x}' \ \frac{\rho(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \ .
\]</span> This means to solve the general PDE we only need to find the homogeneous solution <span class="math inline">\(\phi_h(\mathbf{x})\)</span> that solves Laplace’s equation <span class="math inline">\(\nabla^2 \phi_h = 0\)</span> subject to the given boundary conditions, and we’ll have a general solution to Poisson’s equation subject to those boundary conditions.</p>
<p>Notice how similar this looks to the formal solution approach we took before using Green’s functions. In fact the two approaches are completely equivalent, as they should be. Recall the formal solution could be written <span class="math display">\[
\phi(\mathbf{x}) = \int_\mathcal{V} d^3 \mathbf{x}' \ \rho(\mathbf{x}') G(\mathbf{x} - \mathbf{x}') + \frac{1}{4\pi} \oint_\mathcal{S} da' \ \bigg[G \frac{\partial \phi}{\partial n'} - \phi \frac{\partial G}{\partial n'} \bigg] \ ,
\]</span> where the Green’s function is given by <span class="math display">\[
G(\mathbf{x} - \mathbf{x}') = \frac{1}{|\mathbf{x} - \mathbf{x}'|} + F(\mathbf{x} - \mathbf{x}') \ .
\]</span> The first integral is just the particular solution <span class="math inline">\(\phi_p(\mathbf{x})\)</span>. The second integral is in fact the homogeneous solution <span class="math inline">\(\phi_h(\mathbf{x})\)</span>, which is evidently closely related to the homogeneous part of the Green’s function, <span class="math inline">\(F(\mathbf{x} - \mathbf{x}')\)</span>.</p>
<p>Since we know how to find the particular solution, what remains is finding the homogeneous solution. This involves solving Laplace’s equation subject to the given boundary conditions. This is what the rest of this chapter will focus on.</p>
</section>
</section>
<section id="separation-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="separation-of-variables">Separation of Variables</h2>
<p>The most popular technique for solving linear PDEs analytically is the <em>separation of variables</em> method. Suppose we have an arbitrary homogeneous linear PDE of the form <span class="math display">\[
\mathcal{L} \phi(\mathbf{x}) = 0 \ .
\]</span> The separation of variables of variable method works exactly as the name suggests. We first assume that in some coordinate system <span class="math inline">\((u,v,w)\)</span> that <span class="math inline">\(\phi(\mathbf{x})\)</span> can be written as a trial solution that’s a product of univariate functions of only those coordinates, <span class="math display">\[
\phi(\mathbf{x}) = U(u) V(v) W(w) \ .
\]</span> Provided the linear operator <span class="math inline">\(\mathcal{L}\)</span> in this coordinate system can be separated into linear operators acting only on these variables alone, i.e.&nbsp;<span class="math inline">\(\mathcal{L} = \mathcal{L}_u + \mathcal{L}_v + \mathcal{L}_w \ \)</span>, we can plug this trial solution in and divide by <span class="math inline">\(UVW\)</span> and write <span class="math display">\[
\frac{1}{U(u)}\mathcal{L}_u U(u) + \frac{1}{V(v)}\mathcal{L}_v V(v) + \frac{1}{W(w)}\mathcal{L}_v W(w) = 0 \ .
\]</span> Now, notice we have an equation of the form <span class="math display">\[
f(u) + g(v) + h(w) = 0 \ .
\]</span> Since each of these functions is an independent function of its own coordinate, the only way their sum can be zero for all possible <span class="math inline">\(u,v,w\)</span> is if each of these functions is constant and those constants all sum to zero, i.e. <span class="math display">\[
f(u) = \alpha \ , \ g(v) = \beta \ , \ h(w) = \gamma \ , \ \alpha + \beta + \gamma = 0 \ .
\]</span> That is, we must have three coupled ordinary differential equations of the form <span class="math display">\[
\begin{align*}
&amp;\mathcal{L}_u U(u) = \alpha U(u) \ , \\
&amp;\mathcal{L}_v V(v) = \beta V(v) \ , \\
&amp;\mathcal{L}_w W(w) = \gamma W(w) \ , \\
&amp;\alpha + \beta + \gamma = 0 \ .
\end{align*}
\]</span> All that remains now is to solve each of these ODEs and impose the boundary conditions. Provided we can find a set of three functions <span class="math inline">\(U,V,W\)</span> that solve these ODEs as well as the boundary conditions, we can reassemble them to get the full solution.</p>
<p>Those that have read the appendix will notice that each of these differential equations is an eigenvalue problem with eigenvalues <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\gamma\)</span> respectively. Typically one or more of the separation constants will end up being quantized in terms of an integer whose eigenfunctions form a complete orthonormal set inside the boundary region. For example, we may end up with a set of three quantized differential equations of the form <span class="math display">\[
\begin{align*}
&amp;\mathcal{L}_u U_n(u) = \alpha_n U_n(u) \ , \\
&amp;\mathcal{L}_v V_m(v) = \beta_m V_m(v) \ , \\
&amp;\mathcal{L}_w W_k(w) = \gamma_k W_k(w) \ , \\
&amp;\alpha_n + \beta_m + \gamma_k = 0 \ ,
\end{align*}
\]</span> where <span class="math inline">\(n,m,k\)</span> are integers. The product of <span class="math inline">\(U_n, V_m, W_k\)</span> will then give rise to a basis solution of the form <span class="math display">\[
\phi_{nmk}(u,v,w) = U_n(u) V_m(v) W_k(w) \ .
\]</span> Since <span class="math inline">\(U_n(u)\)</span>, <span class="math inline">\(V_m(v)\)</span>, and <span class="math inline">\(W_k(w)\)</span> are each complete sets of orthogonal functions on their own intervals, <span class="math inline">\(\phi_{nmk}\)</span> will also form a complete set of orthogonal functions in 3-dimensional space. To get the most general solution that solves the boundary value problem, we can use the principle of superposition to sum over a weighted combination of these basis functions to get <span class="math display">\[
\phi(\mathbf{x}) = \sum_{n,m,k} c_{nmk} \phi_{nmk}(u,v,w) \ .
\]</span> At this point there will be one more boundary condition left that we still need to satisfy, usually that the potential needs to equal some known function <span class="math inline">\(f\)</span> on one of the boundaries. We can use this last boundary condition along with the orthogonality of the basis functions to determine the coefficients <span class="math inline">\(c_{nmk}\)</span>. Once we find these coefficients we’ll have the general solution to the boundary value problem.</p>
<p>In this chapter we’ll only be concerned with solving Laplace’s equation, where <span class="math inline">\(\mathcal{L} = \nabla^2\)</span>. In this case, we can guarantee by the uniqueness theorem that once we find the general solution that fits the boundary conditions that it will be unique, provided the boundary conditions are Dirichlet, Neumann, or mixed, which in practice they always will be.</p>
<p>This process will be much easier to illustrate by looking at specific problems. We’ll do that first by considering Laplace’s equation in Cartesian coordinates, before looking at Laplace’s equation in spherical and cylindrical coordinates as well. By the end, the process of how to use separation of variables to find the general solution should hopefully be quite clear.</p>
<section id="separation-of-variables-in-cartesian-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="separation-of-variables-in-cartesian-coordinates">Separation of Variables in Cartesian Coordinates</h3>
<p>We’ll now turn our focus to solving Laplace’s equation <span class="math inline">\(\nabla^2 \phi(\mathbf{x}) = 0\)</span> using separation of variables, subject to either Dirichlet, Neumann, or mixed boundary conditions. Since the Laplacian looks different in different coordinate systems, we’ll need separate variables and solve this PDE in different coordinate systems of interest, i.e.&nbsp;Cartesian, spherical, and cylindrical coordinates.</p>
<p>We start with the simplest case of solving Laplace’s equation in Cartesian coordinates <span class="math inline">\((x,y,z)\)</span>. In this coordinate system the Laplacian has an especially simple form, with <span class="math display">\[
\nabla^2 \phi = \frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} + \frac{\partial^2 \phi}{\partial z^2} \ .
\]</span> To match with the general setup from before, we can take <span class="math inline">\(\mathcal{L} = \nabla^2\)</span>, <span class="math inline">\(\mathcal{L}_x = \partial_x^2\)</span>, <span class="math inline">\(\mathcal{L}_y = \partial_y^2\)</span>, and <span class="math inline">\(\mathcal{L}_z = \partial_z^2\)</span>.</p>
<p>We now apply the separation of variables by supposing a trial solution exists of the form <span class="math display">\[
\phi(\mathbf{x}) = X(x) Y(y) Z(z) \ .
\]</span> Plugging this into Laplace’s equation and dividing by <span class="math inline">\(\phi = XYZ\)</span>, we get <span class="math display">\[
0 = \frac{1}{X} \frac{d^2 X}{dx^2} + \frac{1}{Y} \frac{d^2 Y}{dy^2} + \frac{1}{Z} \frac{d^2 Z}{dz^2} \ .
\]</span> Again, since each term is a function of its own variable, the only way this equation can be satisfied for all coordinate values is if each term is constant, and those constants sum to zero. This gives us three coupled ordinary differential equations of the form <span class="math display">\[
\begin{align*}
&amp;\frac{d^2 X}{dx^2} = \alpha_x X \ , \\
&amp;\frac{d^2 Y}{dy^2} = \alpha_y Y \ , \\
&amp;\frac{d^2 Z}{dz^2} = \alpha_z Z \ , \\
&amp;\alpha_x + \alpha_y + \alpha_z = 0 \ .
\end{align*}
\]</span> Notice that we now have three uncoupled linear ordinary second differential equations to solve, which can be easily done once we know the boundary conditions. Once we’ve solved these equations, we can stitch them back together to get the general solution for the potential <span class="math inline">\(\phi(\mathbf{x})\)</span>.</p>
<p>At this point it will be easiest to proceed by illustrating this technique with a simple example, since to go any further we need to impose some boundary conditions. We’ll consider a simple 2-dimensional problem involving only <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Suppose we have two grounded parallel conducting sheets separated by a distance <span class="math inline">\(L\)</span>. On one end, the two sheets are separated with insulating material from a perpendicular third conducting sheet held at a constant potential <span class="math inline">\(V\)</span>, while on the other end the two parallel sheets extend infinitely far.</p>
<p>FIGURE</p>
<p>We’ll assume the sheets are oriented parallel to the <span class="math inline">\(xz\)</span>-plane and separated along the <span class="math inline">\(y\)</span>-axis from <span class="math inline">\(y=0\)</span> to <span class="math inline">\(y=L\)</span>. This means the sheet is held at constant potential <span class="math inline">\(\phi = V\)</span> at <span class="math inline">\(x=0\)</span>, and at <span class="math inline">\(\phi = 0\)</span> when <span class="math inline">\(y=0\)</span> or <span class="math inline">\(y=L\)</span>. We will require that the potential not blow up at infinity as well. Assuming there are no other source charges present, this means we have the following Dirichlet boundary value problem to solve, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi = 0 \ , \\
\text{where} \ \phi(0,y) = V \ , \\
\phi(x,0) = \phi(x,L) = 0 \ .
\end{cases}
\end{align*}
\]</span> We will also require that the potential stay finite inside the boundary region. We will always assume this finiteness condition implicitly unless specified otherwise. Now we can employ separation of variables. Suppose a trial solution of the form <span class="math display">\[
\phi(x,y) = X(x) Y(y) Z(z) \ .
\]</span> We neglect the <span class="math inline">\(z\)</span> coordinate since it isn’t contributing anything to the problem, so we can just set <span class="math inline">\(Z(z) = 1\)</span> and focus on the remaining functions <span class="math inline">\(X(x)\)</span> and <span class="math inline">\(Y(y)\)</span>.</p>
<p>Now, if we plug this trial solution into Laplace’s equation, we find the problem reduces to solving two coupled ODEs, <span class="math display">\[
\frac{1}{X} \frac{d^2 X}{dx^2} = \alpha \quad , \quad \frac{1}{Y} \frac{d^2 Y}{dy^2} = \beta \quad , \quad \alpha + \beta = 0 \ .
\]</span> Now, since we only have two separation constants <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, and those constants must add to zero, we immediately have that <span class="math inline">\(\beta = -\alpha\)</span>. This means we can work in terms of a single separation constant <span class="math inline">\(\alpha\)</span>. We’ll suppose that <span class="math inline">\(\alpha = k^2\)</span> for some <span class="math inline">\(k &gt; 0\)</span>. This then gives us the following two ODEs to solve subject to the boundary conditions,</p>
<p><span class="math display">\[
\frac{d^2 X}{dx^2} = k^2 X \quad , \quad \frac{d^2 Y}{dy^2} = -k^2 Y \ .
\]</span> The first equation must satisfy the boundary conditions that <span class="math inline">\(X(x)\)</span> is finite at infinity, and <span class="math inline">\(X(0) = V\)</span>. The second equation must satisfy the boundary conditions <span class="math inline">\(Y(0) = Y(L) = 0\)</span>.</p>
<p>The general solution for the first equation is given by <span class="math display">\[
X(x) = A e^{kx} + B e^{-kx} \ .
\]</span> If we impose the condition that <span class="math inline">\(X(x)\)</span> not blow up at infinity, then we must choose <span class="math inline">\(A=0\)</span> so that the first term vanishes. Then <span class="math display">\[
X(x) = B e^{-kx} \ .
\]</span> We still need to impose the boundary condition <span class="math inline">\(X(0) = V\)</span>. We’ll come back to this at the end.</p>
<p>For the second equation, we know we can express its general solution in the form <span class="math display">\[
Y(y) = C \cos ky + D \sin ky \ .
\]</span> This solution has to satisfy the boundary conditions <span class="math inline">\(Y(0) = Y(L) = 0\)</span>. Plugging in the first condition requires <span class="math inline">\(C=0\)</span>. Plugging in the second condition, we’re left with <span class="math display">\[
Y(y) = D \sin kL = 0 \ .
\]</span> The only way this can be true is if either <span class="math inline">\(D=0\)</span> or <span class="math inline">\(kL\)</span> is an integer multiple of <span class="math inline">\(\pi\)</span>. If <span class="math inline">\(D=0\)</span> we get nowhere, since that would give the trivial solution <span class="math inline">\(Y(y) = 0\)</span>. We’re thus left to impose the second condition. Suppose <span class="math inline">\(kL = \pi n\)</span> for some positive integer <span class="math inline">\(n\)</span>. This implies that <span class="math inline">\(k\)</span> must be <em>quantized</em> as a function of <span class="math inline">\(n\)</span>, with <span class="math display">\[
k_n = \frac{n\pi}{L} \quad , \quad n=1,2,3,\cdots \ .
\]</span> Now, each choice of <span class="math inline">\(k_n\)</span> will give rise to its own solution <span class="math inline">\(Y_n(y) = D_n \sin k_n y\)</span> that solves the differential equation <span class="math display">\[
\frac{d^2 Y_n}{dy^2} = -k_n^2 Y_n
\]</span> So which <span class="math inline">\(Y_n(y)\)</span> do we choose? In fact we’ll want to keep all of them, since <em>any</em> choice of these functions will satisfy Laplace’s equation, albeit with different separation constants. We don’t care about the separation constants. We care about the general solution to Laplace’s equation. To get the general solution, we use the fact that each <span class="math inline">\(Y_n(y)\)</span> are just the Fourier sine functions. This means they will be orthogonal, and we can represent any general solution <span class="math inline">\(Y(y)\)</span> as a linear superposition of <span class="math inline">\(Y_n(y)\)</span>. This means the general solution <span class="math inline">\(Y(y)\)</span> will be a real <em>Fourier series</em>.</p>
<p>Instead of applying superposition now though, we typically want to do it to the full potential. Notice that if we quantize <span class="math inline">\(k\)</span> that <span class="math inline">\(X(x)\)</span> now also becomes an infinitely family of solutions as well, with <span class="math inline">\(X_n(x) = B_n e^{-k_n x}\)</span>. If we now multiply <span class="math inline">\(X_n(x)\)</span> and <span class="math inline">\(Y_n(y)\)</span> back together, we get a <em>basis solution</em> <span class="math inline">\(\phi_n(x,y,z)\)</span> that solves Laplace’s equation subject to these boundary conditions. We’ll ignore the integration constants, which we’ll put back in a moment, and define the basis functions by <span class="math display">\[
\phi_n(x,y,z) \equiv e^{-k_n x} \sin k_n y \ .
\]</span> By construction <span class="math inline">\(\phi_n(x,y,z)\)</span> will solve Laplace’s equation subject to all boundary conditions except one, that <span class="math inline">\(\phi_n(0,y,z) = V\)</span>. The only way we can <em>also</em> satisfy this boundary condition is to use the principle of superposition to take a weighted sum over all of these basis functions to get the most general possible expression for the potential, <span class="math display">\[
\phi(x,y,z) = \sum_{n=1}^\infty b_n \phi_n(x,y,z) \ .
\]</span> Now, at this point we have one boundary condition to satisfy, and an infinite set of coefficients <span class="math inline">\(b_n\)</span> to determine. Here we appeal to the property of orthogonality. Observe that when <span class="math inline">\(x=0\)</span> we must have <span class="math display">\[
V = \phi(0,y,z) = \sum_{n=1}^\infty b_n \sin k_n y \ .
\]</span> We know from the appendix that the functions <span class="math inline">\(\sin k_n y\)</span> will be orthogonal on the interval <span class="math inline">\(0 \leq y \leq L\)</span>. That is, we know that when <span class="math inline">\(m \neq n\)</span> we must have <span class="math display">\[
\langle \sin k_m y | \sin k_n y \rangle = \int_0^L dy \ \sin k_m y \sin k_n y = 0 \ .
\]</span> This is called an <em>inner product</em>. Similar to how we can define a dot product between two vectors, we can define an inner product between two functions. We say two functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are orthogonal provided <span class="math inline">\(\langle f | g \rangle = 0\)</span>.</p>
<p>To see what this implies, let’s multiply both expressions for <span class="math inline">\(\phi(0,y,z)\)</span> by <span class="math inline">\(\sin k_m y\)</span> and integrate from <span class="math inline">\(y=0\)</span> to <span class="math inline">\(y=L\)</span>. That is, we want to take the inner product of both sides and solve <span class="math inline">\(\langle \sin k_m y | V \rangle = \langle \sin k_m | \sin k_n y \rangle\)</span>. Plugging in <span class="math inline">\(k_m = \frac{2\pi}{L}\)</span>, we see that <span class="math display">\[
\langle \sin k_m y | V \rangle = \int_0^L dy \ V \sin \frac{m\pi y}{L} = \frac{VL}{m\pi}(1-\cos m\pi) \ .
\]</span> Evaluating the second inner product, we get <span class="math display">\[
\begin{align*}
\bigg\langle \sin k_m \bigg| \sum_{n=1}^\infty b_n \sin k_n y \bigg\rangle &amp;= \sum_{n=1}^\infty b_n \int_0^L dy \ \sin\frac{m\pi y}{L} \sin\frac{n\pi y}{L} \\
&amp;= \sum_{n=1}^\infty b_n \frac{L}{2} \delta_{nm} \\
&amp;= \frac{L}{2} b_m \ .
\end{align*}
\]</span> Notice that we in fact didn’t need to take <span class="math inline">\(m\)</span> different from <span class="math inline">\(n\)</span> in these inner products. We already knew the sine functions would be orthogonal. We could have just taken the inner products with <span class="math inline">\(\sin k_n y\)</span> directly. In fact, we could’ve calculate the coefficients <span class="math inline">\(b_n\)</span> directly by using the formula <span class="math display">\[
b_n = \frac{\langle \sin k_n y | V \rangle}{\langle \sin k_n y | \sin k_n y \rangle} \ .
\]</span> At any rate, these two inner product expressions together give us an equation for each <span class="math inline">\(b_n\)</span>. We evidently have</p>
<p><span class="math display">\[
b_n = \frac{2V}{n\pi} (1 - \cos n\pi) \ .
\]</span> Before plugging this back into the general solution we can simplify it a little bit. Notice that <span class="math inline">\(\cos n\pi\)</span> will be <span class="math inline">\(+1\)</span> when <span class="math inline">\(n\)</span> is an even number, and <span class="math inline">\(-1\)</span> when <span class="math inline">\(n\)</span> is an odd number. In the even case we get <span class="math inline">\(b_n = 0\)</span> since each term cancels, while in the odd case we get <span class="math display">\[
b_n = \frac{4V}{n\pi} \quad , \quad n=1,3,5,\cdots \ .
\]</span> This means the series expansion for the potential will contain only odd terms, with <span class="math display">\[
\phi(\mathbf{x}) = \frac{4V}{\pi} \sum_{n=1,3,5,\cdots}^\infty \frac{1}{n} e^{-k_n x} \sin k_n y \ .
\]</span> This expression is the most general form we can write down to the potential for this boundary value problem. By construction it satisfies all of the boundary conditions, which means by the uniqueness theorem it will be the only such solution that does.</p>
<p>If we like, we can further simplify this expression further by noting that the sum on the right-hand side has a closed form given by <span class="math display">\[
\phi(\mathbf{x}) = \frac{2V}{\pi} \tan^{-1} \bigg(\frac{\sin k_n y}{\sinh k_n x}\bigg) \ .
\]</span> Since this potential is only a function of two variables, we can plot its equipotentials with a contour plot in the <span class="math inline">\(xy\)</span>-plane. In the <span class="math inline">\(x\)</span>-direction, the potential is highest at <span class="math inline">\(x=0\)</span>, where <span class="math inline">\(\phi(0,y)=V\)</span> before dying off exponentially as <span class="math inline">\(x \rightarrow \infty\)</span>. In the <span class="math inline">\(y\)</span>-direction, the potential goes to zero at the endpoints <span class="math inline">\(y=0\)</span> and <span class="math inline">\(y=L\)</span>, and hits its maximum at the midpoint <span class="math inline">\(y=\frac{L}{2}\)</span>.</p>
<p>FIGURE</p>
<p>This in essence is how separation of variables works in Cartesian coordinates. We will always end up with a potential that’s a linear superposition of exponentials and sinusoid functions, where the expansion coefficients are determined by imposing a final boundary condition of some type. Let’s work a few more complex examples to solidify the idea.</p>
<section id="example-infinite-conducting-rectangular-pipe-held-at-a-given-potential-on-one-end" class="level5">
<h5 class="anchored" data-anchor-id="example-infinite-conducting-rectangular-pipe-held-at-a-given-potential-on-one-end">Example: Infinite conducting rectangular pipe held at a given potential on one end</h5>
<p>Let’s now consider a slight generalization of the previous problem. Suppose we have a rectangular infinitely long conducting pipe. One end of the pipe is held at some potential <span class="math inline">\(V(y,z)\)</span>, while the other end extends infinitely far. Suppose the pipe has a finite width <span class="math inline">\(a\)</span> and a finite depth <span class="math inline">\(b\)</span>, and the sides of the pipe are grounded. We want to find the potential inside the pipe.</p>
<p>We’ll orient the pipe exactly like we did in the previous problem, with the length along the <span class="math inline">\(x\)</span>-axis, and the width and depth along the <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> axes. At <span class="math inline">\(x=0\)</span> the potential is held constant, with <span class="math inline">\(\phi(0,y,z)=V(y,z)\)</span>. At <span class="math inline">\(y=0\)</span> and <span class="math inline">\(y=a\)</span>, and at <span class="math inline">\(z=0\)</span> and <span class="math inline">\(z=b\)</span>, the pipe is grounded, with <span class="math inline">\(\phi(x,0,z) = \phi(x,b,z) = \phi(x,y,0) = \phi(x,y,b) = 0\)</span>. We’ll also require that <span class="math inline">\(\phi\)</span> not blow up at infinity.</p>
<p>FIGURE</p>
<p>This means we end up with a Dirichlet boundary value problem to solve of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi = 0 \ , \\
\text{where} \ \phi(0,y,z) = V(y,z) \ , \\
\phi(x,0,z) = \phi(x,a,z) = 0 \ , \\
\phi(x,y,0) = \phi(x,y,b) = 0 \ .
\end{cases}
\end{align*}
\]</span> We again employ separation of variables by assuming a trial solution of the form</p>
<p><span class="math display">\[
\phi(x,y,z) = X(x) Y(y) Z(z) \ .
\]</span> This time we can’t set <span class="math inline">\(Z(z) = 1\)</span>, meaning we’ll end up with three ODEs to solve instead of two. We end up with <span class="math display">\[
\frac{1}{X} \frac{d^2 X}{dx^2} = \alpha \quad , \quad \frac{1}{Y} \frac{d^2 Y}{dy^2} = \beta \quad , \quad \quad \frac{1}{Y} \frac{d^2 Z}{dz^2} = \gamma \quad , \quad \alpha + \beta + \gamma = 0 \ .
\]</span> At this point it’s not obvious what signs to choose for these constants. As a general rule of thumb though, if there’s an unbounded coordinate in the problem (in this case <span class="math inline">\(x\)</span>) we want that coordinate to have a positive constant. Any coordinates that have fixed boundary conditions on both ends (in this case <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>) we’ll want to have negative constants. To that end, we’ll assume that <span class="math inline">\(\beta = -k^2\)</span> and <span class="math inline">\(\gamma = -\ell^2\)</span> are both negative, which luckily forces <span class="math inline">\(\alpha = \sqrt{k^2 + \ell^2}\)</span> to be positive.</p>
<p>This then leaves us with three differential equations to solve of the form <span class="math display">\[
\frac{d^2 X}{dx^2} = (k^2+\ell^2) X \quad , \quad \frac{d^2 Y}{dy^2} = -k^2 Y \quad , \quad \frac{d^2 Z}{dz^2} = -\ell^2 Z \ .
\]</span> The equation for <span class="math inline">\(X(x)\)</span> must satisfy the boundary conditions that <span class="math inline">\(X(x)\)</span> is finite at infinity, and <span class="math inline">\(X(0) = V(y,z)\)</span>. The first condition will force <span class="math inline">\(X(x)\)</span> be given by a negative exponential, and the second condition we’ll have to come back to at the end. We have <span class="math display">\[
X(x) = C e^{-\sqrt{k^2+\ell^2}x} \ .
\]</span> The equations for <span class="math inline">\(Y(y)\)</span> and <span class="math inline">\(Z(z)\)</span> are identical apart for their separation constants and their endpoints. Requiring that <span class="math inline">\(Y(y)\)</span> vanish at <span class="math inline">\(y=0\)</span> and <span class="math inline">\(y=a\)</span> forces <span class="math inline">\(k\)</span> to be quantized in terms of an integer <span class="math inline">\(n\)</span>, with <span class="math inline">\(k_n = \frac{n\pi}{a}\)</span>. Similarly, requiring that <span class="math inline">\(Z(z)\)</span> vanish at <span class="math inline">\(z=0\)</span> and <span class="math inline">\(z=b\)</span> forces <span class="math inline">\(\ell\)</span> to be quantized in terms of another integer <span class="math inline">\(m\)</span>, with <span class="math inline">\(\ell_m = \frac{m\pi}{b}\)</span>. In each case, we’ll have a basis of sinusoid solutions of the form <span class="math display">\[
Y_n(y) = A_n \sin k_n y \quad , \quad Z_m(z) = B_n \sin \ell_m z \ .
\]</span> As in the previous example, each of these functions forms a set of complete orthogonal functions on their respective intervals. Now, since <span class="math inline">\(X(x)\)</span> depends on both <span class="math inline">\(k\)</span> and <span class="math inline">\(\ell\)</span>, its set of solutions will now depend on both <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, with <span class="math display">\[
X_{nm}(x) = C e^{-\sqrt{k_n^2+\ell_m^2}x} \ .
\]</span> This means we can construct the general solution for the potential by multiplying each of these solutions together to get a basis function for the potential, which we can superpose with each other to get the general solution. Again ignoring the integration constants, which we’ll put back in soon, we define basis functions of the form <span class="math display">\[
\phi_{nm}(x,y,z) \equiv e^{-\sqrt{k_n^2+\ell_m^2}x} \sin k_n y \sin \ell_m z \ .
\]</span> Now, none of these solutions satisfies the final boundary condition that <span class="math inline">\(\phi(0,y,z) = V(y,z)\)</span>. This means we need to consider a more general class of solutions. We again do that by appealing to the principle of superposition. This time though we need to sum over both <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> to get the most general possible solution, <span class="math display">\[
\phi(x,y,z) = \sum_{n=1}^\infty \sum_{m=1}^\infty b_{nm} \phi_{nm}(x,y,z) \ .
\]</span> We’ll now impose the final boundary condition and use that to find the expansion coefficients <span class="math inline">\(b_{nm}\)</span>. Plugging in the final condition <span class="math inline">\(V(y,z) = \phi(0,y,z)\)</span> to the general solution evaluated at <span class="math inline">\(x=0\)</span>, we get <span class="math display">\[
V(y,z) = \phi(0,y,z) = \sum_{n=1}^\infty \sum_{m=1}^\infty b_{nm} \sin k_n y \sin \ell_m z \ .
\]</span> To find the coefficients, we now appeal to the fact that the set of functions <span class="math inline">\(\sin k_n y\)</span> and <span class="math inline">\(\sin \ell_m z\)</span> are each orthogonal on their respective intervals. This means we can multiply both sides of this equation by <span class="math inline">\(\sin k_{n'} y \ \sin \ell_{m'} z\)</span> and integrate over both <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> to get <span class="math display">\[
\int_0^a dy \int_0^b dz \ V(y,z) \sin k_{n'} y \ \sin \ell_{m'} z = \sum_{n=1}^\infty \sum_{m=1}^\infty b_{nm} \int_0^a dy \int_0^b dz \ \sin k_n y \sin \ell_m z \sin k_{n'} y \ \sin \ell_{m'} z \ .
\]</span> On the right-hand side, we see that the integrals separate into a product of two univariate integrals, giving <span class="math display">\[
\begin{align*}
\sum_{n,m} b_{nm} \int_0^a dy \int_0^b dz \ \sin k_n y \sin \ell_m z \sin k_{n'} z \ \sin \ell_{m'} y
&amp;= \sum_{n,m} b_{nm} \bigg(\int_0^a dy \ \sin k_{n'} y \ \sin k_n y\bigg) \bigg(\int_0^b dz \ \sin \ell_m z \ \sin \ell_{m'} z\bigg) \\
&amp;= \frac{a}{2} \frac{b}{2} \sum_{n,m} b_{nm} \delta_{nn'} \delta_{mm'} \\
&amp;= \frac{ab}{4} b_{n'm'} \ .
\end{align*}
\]</span> For the left-hand side, we can’t proceed any further without a specific form for <span class="math inline">\(V(y,z)\)</span>. For the sake of argument we’ll suppose that <span class="math inline">\(V(y,z) = V\)</span> is constant. In that case, the left-hand side evaluates to <span class="math display">\[
\begin{align*}
\int_0^a dy \int_0^b dz \ V(y,z) \sin k_{n'} y \ \sin \ell_{m'} z
&amp;= V \int_0^a dy \ \sin k_{n'} y \int_0^b dz \ \sin \ell_{m'} z \\
&amp;= V \frac{a}{n'\pi}(1-\cos n'\pi) \frac{b}{m'\pi}(1-\cos m'\pi) \\
&amp;= \frac{Vab}{n'm' \pi^2} (1-\cos n'\pi) (1-\cos m'\pi) \ .
\end{align*}
\]</span> Putting these together, the coefficients <span class="math inline">\(b_{nm}\)</span> are evidently given by <span class="math display">\[
b_{nm} = \frac{4V}{nm\pi^2} (1-\cos n\pi) (1-\cos m\pi) \ .
\]</span> As with the previous example, <span class="math inline">\(\cos n\pi\)</span> will equal <span class="math inline">\(+1\)</span> when <span class="math inline">\(n\)</span> is even and <span class="math inline">\(-1\)</span> when <span class="math inline">\(n\)</span> is odd, and similarly for <span class="math inline">\(\cos m\pi\)</span>. This means the coefficients will vanish if either <span class="math inline">\(n\)</span> or <span class="math inline">\(m\)</span> is even. The only terms that survive are when both are odd, with <span class="math display">\[
b_{nm} = \frac{16V}{nm\pi^2} \quad , \quad n,m = 1,3,5,\cdots \ .
\]</span> We’ve thus satisfied all the boundary conditions in the problem. According to the uniqueness theorem, plugging <span class="math inline">\(b_{nm}\)</span> back into the general solution will give the unique solution that solves this boundary value problem, with <span class="math display">\[
\phi(\mathbf{x}) = \frac{16V}{\pi^2} \sum_{n,m=1,3,5,\cdots} \frac{1}{nm} e^{-\sqrt{k_n^2+\ell_m^2}x} \sin k_n y \sin \ell_m z  \ .
\]</span> In this case there’s no closed-form solution, so we’re left with this series. Notice, though, that each term falls off quadratically. This means if we like we can get a reasonable approximation to this potential by keeping only the first few terms. Visualizing the equipotentials for this problem is more challenging since now we’re faced with a 4-dimensional plotting situation, but we can still describe qualitatively what these equipotentials will look like. We expect that the potential will be highest at <span class="math inline">\(x=0\)</span> before falling off exponentially in that direction. On the other edges of the pipe the potential will vanish on both sides due to grounding, and will peak along the center-line of the pipe.</p>
</section>
<section id="example-conducting-rectangular-box-held-at-given-potential-on-one-end" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-rectangular-box-held-at-given-potential-on-one-end">Example: Conducting rectangular box held at given potential on one end</h5>
<p>Let’s now consider a slight variation to the previous problem. Suppose we have a rectangular conducting box of finite extent in all directions. One of the sides of the box is held at some varying potential <span class="math inline">\(V(y,z)\)</span>, while the other five sides of the box are grounded. Suppose the box has a width <span class="math inline">\(a\)</span> in the direction where the potential is ungrounded, a depth <span class="math inline">\(b\)</span>, and a height <span class="math inline">\(c\)</span>.</p>
<p>We’ll orient the box exactly like we did in the previous problem, with the length along the <span class="math inline">\(x\)</span>-axis, and the width and depth along the <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> axes. We’ll assume the box is is ungrounded at <span class="math inline">\(x=a\)</span> with <span class="math inline">\(\phi(a,x,y) = V(y,z)\)</span>, while the other sides are grounded.</p>
<p>FIGURE</p>
<p>This gives us a Dirichlet BVP to solve of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi = 0 \ , \\
\text{where} \ \phi(a,y,z) = V(y,z) \ , \\
\phi(0,y,z) = 0 \ , \\
\phi(x,0,z) = \phi(x,a,z) = 0 \ , \\
\phi(x,y,0) = \phi(x,y,b) = 0 \ .
\end{cases}
\end{align*}
\]</span> Since we confine ourselves to the inside of the box, we don’t need to require that <span class="math inline">\(\phi \rightarrow \infty\)</span> as <span class="math inline">\(|\mathbf{x}| \rightarrow \infty\)</span>.</p>
<p>If we apply separation of variables to this problem, we end up with three differential equations to solve of the form <span class="math display">\[
\frac{d^2 X}{dx^2} = (k^2+\ell^2) X \quad , \quad \frac{d^2 Y}{dy^2} = -k^2 Y \quad , \quad \frac{d^2 Z}{dz^2} = -\ell^2 Z \ .
\]</span> Notice that we skipped the step where we chose the signs of the separation constants. To give a brief justification for the above choice, notice that all coordinates are bounded in this problem. Two of the coordinates (<span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>) have vanishing potentials at both boundaries. For those it makes sense to choose negative constants so that we again get sinusoidal solutions, and can expand the general solution in terms of Fourier bases again. The final coordinate <span class="math inline">\(x\)</span> is then forced to have a positive separation constant. This will turn out to be a reasonable choice, as we’ll see.</p>
<p>Now, the equations for <span class="math inline">\(Y(y)\)</span> and <span class="math inline">\(Z(z)\)</span> are exactly the same as they were in the previous problem. The boundary conditions force the constants <span class="math inline">\(k\)</span> and <span class="math inline">\(\ell\)</span> to be quantized in terms of integers <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, with <span class="math inline">\(k_n = \frac{n\pi}{b}\)</span> and <span class="math inline">\(\ell_m = \frac{m\pi}{c}\)</span>. This means we end up with two infinite sets of basis functions of the form <span class="math inline">\(Y_n(y) = \sin k_n y\)</span> and <span class="math inline">\(Z_m(z) = \sin \ell_m z\)</span>. Both sets of functions will be complete and orthogonal on their given intervals.</p>
<p>The equation for <span class="math inline">\(X(x)\)</span> again gives a general solution in terms of real exponentials, but this time we can’t throw away one of them since <span class="math inline">\(x\)</span> is bounded as well in this problem. For each <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, we’ll have a general solution of the form <span class="math display">\[
X_{nm}(x) = A_{nm} e^{\sqrt{k_n^2 + \ell_m^2} x} + B_{nm} e^{-\sqrt{k_n^2 + \ell_m^2} x} \ .
\]</span> Each of these functions must satisfy the boundary condition that <span class="math inline">\(X_{nm}(0) = 0\)</span>. Plugging this in forces <span class="math inline">\(B_{nm} = -A_{nm}\)</span>, giving <span class="math display">\[
X_{nm}(x) = A_{nm} \big(e^{\sqrt{k_n^2 + \ell_m^2} x} - e^{-\sqrt{k_n^2 + \ell_m^2} x}\big) = 2 A_{nm} \sinh \sqrt{k_n^2 + \ell_m^2} x \ .
\]</span> We can then combine each of these solutions together to get a basis of solutions for the potential, which we’ll define by <span class="math display">\[
\phi_{nm}(x,y,z) \equiv \sinh \sqrt{k_n^2 + \ell_m^2} x \ \sin k_n y \ \sin \ell_m z \ .
\]</span> Now, we still have to fit the boundary condition that <span class="math inline">\(\phi(a,y,z) = V(y,z)\)</span>. None of these basis functions solve this condition. This means we need to consider a more general solution by appealing to the principle of superposition to write <span class="math display">\[
\phi(x,y,z) = \sum_{n=1}^\infty \sum_{m=1}^\infty b_{nm} \phi_{nm}(x,y,z) \ .
\]</span> Fitting the final boundary condition will determine the expansion coefficients <span class="math inline">\(b_{nm}\)</span>. Setting <span class="math inline">\(x=a\)</span> in the above solution, we get <span class="math display">\[
V(y,z) = \phi(a,y,z) = \sum_{n=1}^\infty \sum_{m=1}^\infty b_{nm} \sinh \sqrt{k_n^2 + \ell_m^2} a \ \sin k_n y \ \sin \ell_m z \ .
\]</span> We now again appeal to the fact that <span class="math inline">\(\sin k_n y\)</span> and <span class="math inline">\(\sin \ell_m z\)</span> each form an orthogonal set of functions, which means we can determine the expansion coefficients by taking inner products. Equivalently, we can determine <span class="math inline">\(b_{nm}\)</span> by multiplying both sides of the above equation by <span class="math inline">\(\sin k_{n'} y \ \sin \ell_{m'} z\)</span> and integrating over both <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> on their respective intervals. Using the previous example as a guide, it’s not hard to see that the right-hand side will give <span class="math display">\[
\sum_{n,m} b_{nm} \sinh \sqrt{k_n^2 + \ell_m^2} a \int_0^b dy \int_0^c dz \ \sin k_n y \sin \ell_m z \sin k_{n'} z \ \sin \ell_{m'} y = \frac{bc}{4} \sinh \sqrt{k_{n'}^2 + \ell_{m'}^2} a \ b_{n'm'} \ .
\]</span> To evaluate the left-hand side we need a specific functional form for <span class="math inline">\(V(y,z)\)</span>. Even so, we can formally express <span class="math inline">\(b_{nm}\)</span> in terms of an integral by using the previous expression to write <span class="math display">\[
b_{nm} = \frac{4}{bc} \frac{1}{\sinh \sqrt{k_n^2 + \ell_m^2} a} \int_0^b dy \int_0^c dz \ V(y,z) \sin k_n y \ \sin \ell_m z \ .
\]</span> Notice if we set <span class="math inline">\(V(y,z)\)</span> to a constant and integrate, we get a solution that looks identical to the solution in the previous problem, except with an extra hyperbolic sine factor included. In that simple case, we get <span class="math display">\[
\phi(\mathbf{x}) = \frac{16V}{\pi^2} \sum_{n,m=1,3,5,\cdots} \frac{1}{nm} \frac{\sinh \sqrt{k_n^2 + \ell_m^2} x}{\sinh \sqrt{k_n^2 + \ell_m^2} a} \sin k_n y \sin \ell_m z  \ .
\]</span> Again, the uniqueness theorem will guarantee that once we’ve found this solution, it will be unique.</p>
</section>
</section>
</section>
<section id="separation-of-variables-in-spherical-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="separation-of-variables-in-spherical-coordinates">Separation of Variables in Spherical Coordinates</h2>
<p>Applying separation of variables in Cartesian coordinates is pretty easy due to the fact that the Laplacian takes such a simple form. In curvilinear coordinates though it’s not quite as easy, but it’s still very useful to solve many interesting problems.</p>
<p>Suppose we now choose to work in spherical coordinates <span class="math inline">\((r,\theta,\varphi)\)</span>. In this coordinate system, the Laplacian is given by <span class="math display">\[
\nabla^2 \phi = \frac{1}{r^2} \frac{\partial}{\partial r} \bigg(r^2 \frac{\partial \phi}{\partial r}\bigg) + \frac{1}{r^2 \sin\theta} \frac{\partial}{\partial \theta} \bigg(\sin\theta \frac{\partial \phi}{\partial \theta}\bigg) + \frac{1}{r^2 \sin^2 \theta} \frac{\partial^2 \phi}{\partial \varphi^2} \ .
\]</span></p>
<p>To solve Laplace’s equation we require that <span class="math inline">\(\nabla^2 \phi = 0\)</span>. If we multiply both sides by <span class="math inline">\(r^2\)</span> we end up with <span class="math display">\[
\frac{\partial}{\partial r} \bigg(r^2 \frac{\partial \phi}{\partial r}\bigg) + \frac{1}{ \sin\theta} \frac{\partial}{\partial \theta} \bigg(\sin\theta \frac{\partial \phi}{\partial \theta}\bigg) + \frac{1}{\sin^2 \theta} \frac{\partial^2 \phi}{\partial \varphi^2} = 0 \ .
\]</span> Notice this equation isn’t completely separated yet since the last term still depends on <span class="math inline">\(\theta\)</span>. As is convention, we’ll handle the special situation of azimuthal symmetry before proceeding to study the general case.</p>
<section id="azimuthally-symmetric-potentials" class="level4">
<h4 class="anchored" data-anchor-id="azimuthally-symmetric-potentials">Azimuthally Symmetric Potentials</h4>
<p>For problems with azimuthal symmetry the potential depends only on <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span>, not on <span class="math inline">\(\varphi\)</span>. An example of this type of situation might be a conducting sphere held at a fixed potential, or a potential with only a polar dependence, say <span class="math inline">\(\phi = V(\theta)\)</span> on the surface. For problems like this we can ignore the <span class="math inline">\(\varphi\)</span> derivatives in Laplace’s equation and write <span class="math display">\[
\frac{\partial}{\partial r} \bigg(r^2 \frac{\partial \phi}{\partial r}\bigg) + \frac{1}{ \sin\theta} \frac{\partial}{\partial \theta} \bigg(\sin\theta \frac{\partial \phi}{\partial \theta}\bigg) = 0 \ .
\]</span> This equation is clearly separable in <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span>, so we can proceed as usual. Assume a trial solution of the form <span class="math display">\[
\phi(\mathbf{x}) = R(r) \Theta(\theta) \ .
\]</span> Plugging this into the previous equation and dividing by <span class="math inline">\(R\Theta\)</span>, we get <span class="math display">\[
0 = \frac{1}{R} \frac{d}{dr} \bigg(r^2 \frac{dR}{dr}\bigg) + \frac{1}{\Theta} \frac{1}{\sin\theta} \frac{d}{d\theta} \bigg(\sin\theta \frac{dY}{d\theta}\bigg) \ .
\]</span> Since each term is an independent function in its own variable, the only way their sum can vanish for all <span class="math inline">\(r,\theta\)</span> is the two terms are equal to a constant if opposite sign. We’ll denote this separation constant by <span class="math inline">\(\ell(\ell+1)\)</span> for reasons that will become clear in a moment. Then we have <span class="math display">\[
\begin{align*}
\frac{d}{dr} \bigg(r^2 \frac{dR}{dr}\bigg) &amp;= \ell (\ell+1) R(r) \ , \\
\frac{1}{\sin\theta}\frac{d}{d\theta} \bigg(\sin\theta \frac{d\Theta}{d\theta}\bigg) &amp;= -\ell (\ell+1) \Theta(\theta) \ .
\end{align*}
\]</span> The first equation, called the <em>radial equation</em> can be solved by changing variables to <span class="math inline">\(U(r) = r R(r)\)</span>. Then <span class="math inline">\(\frac{dR}{dr} = \frac{U}{r} - \frac{dU}{dr}\)</span>, and so after simplifying a bit we end up with an ODE for <span class="math inline">\(U(r)\)</span> of the form <span class="math display">\[
\frac{d^2 U}{dr^2} = \frac{\ell (\ell+1)}{r^2} U \ .
\]</span> To solve this ODE we assume a trial solution of the form <span class="math inline">\(U(r) = r^\lambda\)</span> for some parameter <span class="math inline">\(\lambda\)</span> we need to determine. Plugging this solution into the ODE evidently forces <span class="math inline">\(\lambda = -\ell, \ell+1\)</span>, which means the general solution is given by the superposition <span class="math display">\[
U(r) = a r^{-\ell} + b r^{\ell+1} \ .
\]</span> Finally, dividing by <span class="math inline">\(r\)</span> gives us the general solution to the original radial equation, <span class="math display">\[
R(r) = a r^{-\ell-1} + b r^{\ell} \ .
\]</span> We now need to deal with the other ODE, called the <em>angular equation</em>, <span class="math display">\[
\frac{1}{\sin\theta} \frac{d}{d\theta} \bigg(\sin\theta \frac{d\Theta}{d\theta}\bigg) = -\ell (\ell+1) \Theta(\theta) \ .
\]</span> If we change variables by letting <span class="math inline">\(x = \cos\theta\)</span>, then <span class="math inline">\(\frac{d\Theta}{d\theta} = -\sin\theta \frac{d\Theta}{dx}\)</span>, and so we end up with the following ODE for <span class="math inline">\(\Theta(x)\)</span>, <span class="math display">\[
-\frac{d}{dx} \bigg((1-x^2)\frac{d\Theta}{dx}\bigg) = \ell(\ell+1) \Theta(x) \ .
\]</span> Those who have read the appendix will know that this ODE has a name. It’s the <em>Legendre equation</em>. Its only bounded solution is the <em>Legendre polynomial</em> <span class="math inline">\(P_\ell(x) = P_\ell(\cos\theta)\)</span>, where <span class="math inline">\(\ell = 0,1,2,\cdots\)</span> must be a positive integer. Since this is a second order equation, there is also a second solution, but this solution is known to be unbounded for all <span class="math inline">\(\ell\)</span>, and hence non-physical.</p>
<p>We can define the Legendre polynomials most simply using the Rodrigues’ formula as <span class="math display">\[
P_\ell(x) \equiv \frac{1}{2^\ell \ell!} \frac{d^\ell}{dx^\ell} (x^2 - 1)^\ell \ .
\]</span> For example, the first three Legendre polynomials are given by <span class="math display">\[
P_0(x) = 1 \quad , \quad P_1(x) = x = \cos\theta \quad , \quad P_2(x) = \frac{1}{2} (3x^2 - 1) = \frac{1}{2} (3\cos^2 \theta - 1) \ .
\]</span> The Legendre polynomials form a complete orthogonal set on the interval <span class="math inline">\(-1 \leq x \leq 1\)</span>. This means we can express the general solution <span class="math inline">\(\Theta(\theta)\)</span> as a linear superposition of <span class="math inline">\(P_\ell(\cos\theta)\)</span>, with <span class="math display">\[
\Theta(\theta) = \sum_{\ell=0}^\infty c_\ell P_\ell(\cos\theta) \ .
\]</span> Combining this angular solution with the radial solution and absorbing constants together, we can write the general solution for an azimuthally symmetric potential <span class="math inline">\(\phi(\mathbf{x})\)</span> in the form <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \big(a_\ell r^\ell + b_\ell r^{-(\ell+1)}\big) P_\ell(\cos\theta)
} \ .
\]</span> The coefficients <span class="math inline">\(a_\ell\)</span> and <span class="math inline">\(b_\ell\)</span> can then be found by imposing the remaining boundary condition. Once these are found, we’ve found the unique general solution for the potential in spherical coordinates that satisfy all the boundary conditions.</p>
<p>To see that this solution makes sense, let’s consider the special case where the potential is spherically symmetric, with <span class="math inline">\(\phi = \phi(r)\)</span>. Then all but the <span class="math inline">\(\ell=0\)</span> terms vanish, and since <span class="math inline">\(P_0(\cos\theta) = 1\)</span> by definition, we end up with <span class="math display">\[
\phi(r) = a_0 + \frac{b_0}{r} \ .
\]</span> We immediately recognize this as the potential of a uniformly charged sphere, with <span class="math inline">\(b_0 = Q\)</span> and <span class="math inline">\(a_0 = \phi(0)\)</span> a chosen ground point potential that we can ignore. Let’s now consider some more interesting examples.</p>
<section id="example-potential-inside-a-hollow-sphere-held-at-a-given-potential" class="level5">
<h5 class="anchored" data-anchor-id="example-potential-inside-a-hollow-sphere-held-at-a-given-potential">Example: Potential inside a hollow sphere held at a given potential</h5>
<p>Suppose we have a hollow sphere of radius <span class="math inline">\(R\)</span> with a fixed potential <span class="math inline">\(V(\theta)\)</span> on its surface. We want to find the potential inside of the sphere.</p>
<p>FIGURE</p>
<p>The Dirichlet boundary value problem we seek to solve is evidently <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(r,\theta,\varphi) = 0 \ , \\
\text{where} \ \phi(R,\theta,\varphi) = V(\theta) \ .
\end{cases}
\end{align*}
\]</span> Since this is clearly an azimuthally symmetric problem, <span class="math inline">\(\phi = \phi(r,\theta)\)</span>, which means the general solution must have the form <span class="math display">\[
\phi(r,\theta) = \sum_{\ell=0}^\infty \big(a_\ell r^\ell + b_\ell r^{-(\ell+1)}\big) P_\ell(\cos\theta) \ .
\]</span> Since we’re inside the sphere, we require that all <span class="math inline">\(b_\ell = 0\)</span> to prevent the potential from blowing up at the origin. This leaves <span class="math display">\[
\phi(r,\theta) = \sum_{\ell=0}^\infty a_\ell r^\ell P_\ell(\cos\theta) \ .
\]</span> We’re now left to find the coefficients <span class="math inline">\(b_\ell\)</span> by imposing the boundary condition at <span class="math inline">\(\phi(R,\theta)\)</span>, which we can write as <span class="math display">\[
V(\theta) = \phi(R,\theta) = \sum_{\ell=0}^\infty a_\ell R^\ell P_\ell(\cos\theta) \ .
\]</span> Now, recall from the appendix that the Legendre polynomials satisfy the orthogonality relation <span class="math display">\[
\langle P_\ell(x) | P_{\ell'}(x) \rangle = \int_{-1}^1 dx P_\ell(x) P_{\ell'}(x) = \frac{2}{2\ell+1} \delta_{\ell\ell'} \ .
\]</span> Using the relation <span class="math inline">\(x=\cos\theta\)</span> we can re-express this integral in terms of <span class="math inline">\(\theta\)</span> as well, <span class="math display">\[
\langle P_\ell(\cos\theta) | P_{\ell'}(\cos\theta) \rangle = \int_0^\pi d\theta \ P_\ell(\cos\theta) P_{\ell'}(\cos\theta) \sin\theta = \frac{2}{2\ell+1} \delta_{\ell\ell'} \ .
\]</span> We can now use this orthogonality condition to determine the coefficients <span class="math inline">\(a_\ell\)</span>. To do that we proceed as usual. We multiply both sides of the equation for <span class="math inline">\(\phi(R,\theta)\)</span> by <span class="math inline">\(P_{\ell'}(\cos\theta)\)</span> and integrate from <span class="math inline">\(\theta=0\)</span> to <span class="math inline">\(\theta=\pi\)</span>. Doing the right-hand side, first, we have <span class="math display">\[
\sum_{\ell=0}^\infty a_\ell R^\ell \int_0^\pi d\theta \ P_{\ell'}(\cos\theta) P_\ell(\cos\theta) = \sum_{\ell=0}^\infty a_\ell R^\ell \frac{2}{2\ell+1} \delta_{\ell\ell'} = \frac{2}{2\ell'+1} a_{\ell'} R^{\ell'} \ .
\]</span> To evaluate the left-hand side we need a specific form for <span class="math inline">\(V(\theta)\)</span>. Nevertheless, we can use the previous expression to solve for <span class="math inline">\(a_\ell\)</span> in terms of this integral to get <span class="math display">\[
a_\ell = \frac{2\ell+1}{2R^\ell} \int_0^\pi d\theta \ V(\theta) P_\ell(\cos\theta) \ .
\]</span> As an example, let’s suppose <span class="math inline">\(V(\theta)\)</span> takes the specific form <span class="math display">\[
V(\theta) = k \sin^2 \frac{\theta}{2} \ .
\]</span> Using the half-angle formula and the value of the first two Legendre polynomials, we can write this in the form <span class="math display">\[
V(\theta) = \frac{k}{2} (1-\cos\theta) = \frac{k}{2} \big(P_0(\cos\theta) - P_1(\cos\theta)\big) \ .
\]</span> If we then plug this into the previous integral and use the definition of the inner product above, we get <span class="math display">\[
\begin{align*}
a_\ell &amp;= \frac{k}{2}\frac{2\ell+1}{2R^\ell} \int_0^\pi d\theta \  \big[P_0(\cos\theta) - P_1(\cos\theta)\big]P_\ell(\cos\theta) \sin\theta \\
&amp;= \frac{k}{2}\frac{2\ell+1}{2R^\ell} \big[\langle P_0 | P_\ell \rangle - \langle P_1 | P_\ell \rangle\big] \ .
\end{align*}
\]</span> Now, by the orthogonality relation, only the <span class="math inline">\(\ell=0,1\)</span> terms will contribute anything while the rest vanish, with <span class="math display">\[
\begin{align*}
a_0 &amp;= \frac{k}{2} \frac{1}{2} \langle P_0 | P_0 \rangle = \frac{k}{2} \ , \\
a_1 &amp;= -\frac{k}{2} \frac{3}{2R} \langle P_1 | P_1 \rangle = -\frac{k}{2R} \ .
\end{align*}
\]</span> For this choice of <span class="math inline">\(V(\theta)\)</span> we thus have our general solution for the potential that solves this BVP, given by <span class="math display">\[
\phi(\mathbf{x}) = a_0 P_0(\cos\theta) + a_1 r P_1(\cos\theta) = \frac{k}{2} \bigg(1 - \frac{r}{R} \cos\theta\bigg) \ .
\]</span> By the uniqueness theorem, we can guarantee this will be the unique general solution to the given BVP.</p>
</section>
<section id="example-potential-outside-a-hollow-sphere-held-at-a-given-potential" class="level5">
<h5 class="anchored" data-anchor-id="example-potential-outside-a-hollow-sphere-held-at-a-given-potential">Example: Potential outside a hollow sphere held at a given potential</h5>
<p>Let’s now consider again the previous problem, but suppose we’re not interested in the potential <em>outside</em> the hollow sphere. We now require that the potential not blow up at infinity, giving a Dirichlet BVP of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(r,\theta,\varphi) = 0 \ , \\
\text{where} \ \phi(R,\theta,\varphi) = V(\theta) \ .
\end{cases}
\end{align*}
\]</span> Clearly this problem also has an azimuthally symmetric potential <span class="math inline">\(\phi = \phi(r,\theta)\)</span>, and hence we can still write <span class="math display">\[
\phi(r,\theta) = \sum_{\ell=0}^\infty \big(a_\ell r^\ell + b_\ell r^{-(\ell+1)}\big) P_\ell(\cos\theta) \ .
\]</span> But now we need the potential outside the sphere, not inside. The requirement that <span class="math inline">\(\phi\)</span> not blow up at infinity now forces <span class="math inline">\(a_\ell=0\)</span> instead, leaving <span class="math display">\[
\phi(r,\theta) = \sum_{\ell=0}^\infty b_\ell r^{-(\ell+1)} P_\ell(\cos\theta) \ .
\]</span> To find <span class="math inline">\(b_\ell\)</span> we proceed the same way as before, relying on the orthogonality of Legendre polynomials. Multiplying both sides by <span class="math inline">\(P_{\ell'}(\cos\theta)\)</span> and integrating, we end up with the expression <span class="math display">\[
b_\ell = \frac{(2\ell+1)R^{\ell+1}}{2} \int_0^\pi d\theta \ V(\theta) P_\ell(\cos\theta) \sin\theta \ .
\]</span> To proceed further we’d need to know the specific form of the boundary potential <span class="math inline">\(V(\theta)\)</span>. For example, if we again assume the same boundary potential given in the previous problem, we can write <span class="math display">\[
V(\theta) = k \sin^2 \theta = \frac{k}{2} \big[P_0(\cos\theta) - P_1(\cos\theta)\big] \ .
\]</span> As in that problem, plugging this into the integral for <span class="math inline">\(b_\ell\)</span> forces only the <span class="math inline">\(\ell=0,1\)</span> terms to survive, with coefficients <span class="math display">\[
\begin{align*}
b_0 &amp;= \frac{k}{2} \frac{R}{2} \langle P_0 | P_0 \rangle = \frac{kR}{2} \ , \\
b_1 &amp;= -\frac{k}{2} \frac{3R^2}{2} \langle P_1 | P_1 \rangle = -\frac{kR^2}{2} \ .
\end{align*}
\]</span> With these, we can write the general solution for the potential outside the sphere as <span class="math display">\[
\phi(\mathbf{x}) = \frac{b_0}{r} P_0(\cos\theta) + \frac{b_1}{r^2} P_1(\cos\theta) = \frac{kR}{2r} \bigg(1 - \frac{R}{r} \cos\theta\bigg) \ .
\]</span> Notice that this behaves exactly how we expect, with <span class="math inline">\(\phi \rightarrow 0\)</span> at infinity. It’s also easy to see that this solution agrees with the one inside the sphere at the boundary surface where <span class="math inline">\(r=R\)</span>. Indeed, these two solutions together give us the unique potential in all space that satisfies the boundary condition <span class="math inline">\(\phi(R,\theta,\varphi) = V(\theta)\)</span> on the surface of the sphere.</p>
<p>In general, if we have a problem where a boundary value is specified on the surface of a sphere and we’re interested in the potential inside and outside the sphere, we only need to find one of the solutions, and we automatically know the other. For example, suppose we’ve found the potential <span class="math inline">\(\phi\)</span> inside the sphere. All we need to do to get the potential outside the sphere is make the substitution <span class="math inline">\(\big(\frac{r}{R})^\ell \rightarrow \big(\frac{R}{r}\big)^{\ell+1}\)</span> and we automatically have that solution as well.</p>
</section>
<section id="example-conducting-hemispheres-at-opposite-constant-potential" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-hemispheres-at-opposite-constant-potential">Example: Conducting hemispheres at opposite constant potential</h5>
<p>Let’s now consider a slightly more interesting example that we calculated in the last chapter using Green’s functions, namely the problem of two conducting hemispheres held at equal and opposite constant potentials <span class="math inline">\(\pm V\)</span>.</p>
<p>FIGURE</p>
<p>We showed before with great effort that we could represent the potential as a series of odd-degree Legendre polynomials. Now we’ll provide a much easier way to arrive at the same result using separation of variables.</p>
<p>We can also solve this problem using separation of variables. We thus have the following Dirichlet boundary value problem. <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(r,\theta,\varphi) = 0 \ , \\
\text{where} \ \phi(R,\theta,\varphi) = V \ \text{when} \ 0 \leq \theta &lt; \frac{\pi}{2} \ , \\
\phi(R,\theta,\varphi) = -V \ \text{when} \ \frac{\pi}{2} &lt; \theta \leq \pi \ .
\end{cases}
\end{align*}
\]</span> Again, this problem is clearly azimuthally symmetric. Since one is as easy as the other, we’ll show how to find the potential inside the sphere, and then use that formula to get the potential outside as well using the trick described in the previous example.</p>
<p>Inside the sphere we require that <span class="math inline">\(b_\ell = 0\)</span>, which gives an expansion of the form <span class="math display">\[
\phi(r,\theta,\varphi) = \sum_{\ell=0}^\infty a_\ell r^{\ell} P_\ell(\cos\theta) \ .
\]</span> Notice this looks exactly like the previous examples if we take <span class="math inline">\(V(\theta) = \pm V\)</span>. We can solve for the coefficients <span class="math inline">\(a_\ell\)</span> in the usual way, in which case we end up with the integral <span class="math display">\[
a_\ell = \frac{2\ell+1}{2R^\ell} \int_0^\pi d\theta \ V(\theta) P_\ell(\cos\theta) \sin\theta \ .
\]</span> Plugging in <span class="math inline">\(V(\theta) = \pm V\)</span>, this becomes <span class="math display">\[
a_\ell =  \frac{2\ell+1}{2R^\ell} V \bigg[\int_0^{\pi/2} d\theta \ P_\ell(\cos\theta) \sin\theta - \int_{\pi/2}^\pi d\theta \ P_\ell(\cos\theta) \sin\theta\bigg] \ .
\]</span> Since <span class="math inline">\(P_\ell(\cos\theta)\)</span> is odd when <span class="math inline">\(\ell\)</span> is odd and even when <span class="math inline">\(\ell\)</span> is even, we can see that the even coefficients must cancel out, while for odd terms we can write <span class="math display">\[
a_\ell = \frac{2\ell+1}{R^\ell} V \int_0^{\pi/2} d\theta \ P_\ell(\cos\theta) \sin\theta \ .
\]</span> Now, by changing variables with <span class="math inline">\(x=\cos\theta\)</span> we see that the above integral can be written in the simpler form <span class="math display">\[
\int_0^{\pi/2} d\theta \ P_\ell(\cos\theta) \sin\theta = \int_0^1 dx \ P_\ell(x) \ .
\]</span> This integral is just the interval of <span class="math inline">\(P_\ell(x)\)</span> over the right-half interval <span class="math inline">\(0 \leq x \leq 1\)</span>. Its expression can be calculated for odd <span class="math inline">\(\ell\)</span> (see the appendix for an example) to give <span class="math display">\[
\int_0^1 dx \ P_\ell(x) = \frac{(-1)^{\frac{\ell-1}{2}}}{2^\ell \big(\frac{\ell+1}{2}\big)} \frac{(\ell-1)!}{\big(\frac{\ell-1}{2}!\big)^2} \ .
\]</span> Plugging this in and simplifying, the coefficients we seek are given by <span class="math display">\[
a_\ell = \bigg(\frac{-1}{2}\bigg)^{\frac{\ell-1}{2}} \frac{(2\ell+1)(\ell-2)!!}{2\big(\frac{\ell+1}{2}!\big)^2} \frac{V}{R^\ell} \quad , \quad \ell=1,3,5,\cdots \ .
\]</span> This means the potential inside the sphere must be given by <span class="math display">\[
\begin{align*}
\phi(r,\theta,\varphi) &amp;= V\sum_{\ell=0}^\infty \bigg(\frac{-1}{2}\bigg)^{\frac{\ell-1}{2}} \frac{(2\ell+1)(\ell-2)!!}{2\big(\frac{\ell+1}{2}!\big)^2} \bigg(\frac{r}{R}\bigg)^\ell P_\ell(\cos\theta) \\
&amp;= V \bigg[\frac{3}{2}\bigg(\frac{r}{R}\bigg)P_1(\cos\theta) - \frac{7}{8}\bigg(\frac{r}{R}\bigg)^3P_3(\cos\theta) + \frac{11}{16}\bigg(\frac{r}{R}\bigg)^5P_5(\cos\theta) - \cdots\bigg] \ , \quad r \leq R \ .
\end{align*}
\]</span> To get the potential outside the sphere we need only substitute <span class="math inline">\(\big(\frac{r}{R})^\ell \rightarrow \big(\frac{R}{r}\big)^{\ell+1}\)</span> to get <span class="math display">\[
\begin{align*}
\phi(r,\theta,\varphi) &amp;= V\sum_{\ell=0}^\infty \bigg(\frac{-1}{2}\bigg)^{\frac{\ell-1}{2}} \frac{(2\ell+1)(\ell-2)!!}{2\big(\frac{\ell+1}{2}!\big)^2} \bigg(\frac{R}{r}\bigg)^{\ell+1} P_\ell(\cos\theta) \\
&amp;= V \bigg[\frac{3}{2}\bigg(\frac{R}{r}\bigg)^2P_1(\cos\theta) - \frac{7}{8}\bigg(\frac{R}{r}\bigg)^4P_3(\cos\theta) + \frac{11}{16}\bigg(\frac{R}{r}\bigg)^6P_5(\cos\theta) - \cdots\bigg] \ , \quad r \geq R \ .
\end{align*}
\]</span> As expected, the potential outside the sphere goes to zero at infinity, satisfying the final boundary condition. It also appears that the potential vanishes at the origin, and indeed in the whole equatorial plane. Indeed, the potential seems to behave as a dipole, with the electric field falling off like <span class="math inline">\(r^{-3}\)</span> far away from the sphere. This should hopefully make sense. Far away from the sphere we could imagine modeling the two hemispheres as opposite point charges very close together.</p>
</section>
<section id="example-potential-of-a-hollow-sphere-with-an-azimuthally-symmetric-surface-charge-distribution" class="level5">
<h5 class="anchored" data-anchor-id="example-potential-of-a-hollow-sphere-with-an-azimuthally-symmetric-surface-charge-distribution">Example: Potential of a hollow sphere with an azimuthally symmetric surface charge distribution</h5>
<p>Since we’ve neglected Neumann boundary value problems so far in this chapter, let’s consider an example where the potential on the surface of a sphere isn’t known, but instead its surface charge density is known. Suppose we have a hollow sphere of radius <span class="math inline">\(R\)</span>, and on this sphere we have a surface charge density of the form <span class="math inline">\(\sigma' = k \cos\theta\)</span>, where <span class="math inline">\(k\)</span> is some constant.</p>
<p>We’d like to find the potential due to this charged sphere both inside and outside the sphere. We can use the fact that the normal derivative is <span class="math inline">\(\partial \phi / \partial n' = -4\pi \sigma'\)</span> on the surface of the sphere to express this as a Neumann BVP of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(r,\theta,\varphi) = 0 \ , \\
\text{where} \ \partial \phi / \partial r' \big|_{r'=R} = -4\pi k\cos\theta \ .
\end{cases}
\end{align*}
\]</span> We’ll denote the potential inside the sphere by <span class="math inline">\(\phi_-(r,\theta,\varphi)\)</span>, and the potential outside the sphere by <span class="math inline">\(\phi_+(r,\theta,\varphi)\)</span>. By requiring that the potential be continuous at the surface of the sphere, we require that <span class="math inline">\(\phi_-(R,\theta,\varphi) = \phi_+(R,\theta,\varphi)\)</span>.</p>
<p>When outside the sphere the coefficients <span class="math inline">\(a_\ell\)</span> must all vanish for the potential to not blow up at infinity. We thus have <span class="math display">\[
\phi_+(r,\theta,\varphi) = \sum_{\ell=0}^\infty b_\ell r^{-\ell(\ell+1)} P_\ell(\cos\theta) \ .
\]</span> Inside the sphere we require the opposite, that each <span class="math inline">\(b_\ell\)</span> vanish, giving <span class="math display">\[
\phi_-(r,\theta,\varphi) = \sum_{\ell=0}^\infty a_\ell r^\ell P_\ell(\cos\theta) \ .
\]</span> Requiring that the potential be continuous at the surface of the sphere means each term in these series must match at <span class="math inline">\(r=R\)</span>. This means for each <span class="math inline">\(\ell\)</span> we must have the condition <span class="math display">\[
b_\ell R^{-\ell(\ell+1)} - a_\ell R^\ell = 0 \quad \Longrightarrow \quad b_\ell = a_\ell R^{2\ell+1} \ .
\]</span> Since the sphere is hollow, we know that there’s a discontinuity in the electric field across the surface at <span class="math inline">\(r=R\)</span> that’s proportional to <span class="math inline">\(4\pi\sigma'\)</span>. The difference between the normal derivatives across the surface the sphere must then satisfy <span class="math display">\[
\frac{\partial \phi_+}{\partial r'} \bigg|_{r'=R} - \frac{\partial \phi_-}{\partial r'} \bigg|_{r'=R} = -4\pi k\cos\theta \ .
\]</span> Plugging in the series expansions for each term and differentiating, we then have <span class="math display">\[
\sum_{\ell=0}^\infty \bigg[b_\ell (\ell+1)R^{-(\ell+2)} + a_\ell \ell R^{\ell-1} \bigg] P_\ell(\cos\theta) = 4\pi k\cos\theta \ .
\]</span> Since only <span class="math inline">\(P_1(\cos\theta) = \cos\theta\)</span>, each <span class="math inline">\(\ell \neq 1\)</span> term on the left must vanish, which means we have <span class="math display">\[
b_\ell (\ell+1)R^{-(\ell+2)} + a_\ell \ell R^{\ell-1} = 0 \quad \Longrightarrow b_\ell = a_\ell R^{2\ell+1} = 0 \ .
\]</span> When <span class="math inline">\(\ell = 1\)</span> we must have <span class="math display">\[
2b_1 R^{-3} + a_1 = 4\pi k \quad \Longrightarrow \quad b_1 = a_1 R^3 = \frac{4\pi}{3} kR^3 \ .
\]</span> Thus, to satisfy the boundary conditions the full potential must be <span class="math display">\[
\phi(r,\theta,\varphi) = \frac{4\pi}{3} kR \cos\theta \bigg(\frac{R}{r}\bigg)^2 \ .
\]</span> By the uniqueness theorem, this is the only potential that satisfies the boundary condition <span class="math inline">\(\partial \phi / \partial n' = -4\pi \sigma'\)</span>, which means it’s the only valid potential that solves this BVP both inside and outside the sphere. Notice that this potential falls off like <span class="math inline">\(1/r^2\)</span>. That is, this problem is an example of a <em>dipole</em>. We’ll discuss this more in the next chapter.</p>
</section>
<section id="example-conducting-sphere-in-the-presence-of-an-external-electric-field" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-sphere-in-the-presence-of-an-external-electric-field">Example: Conducting sphere in the presence of an external electric field</h5>
<p>Let’s revisit another problem we solved previously with the method of images, that of a solid conducting sphere of radius <span class="math inline">\(R\)</span> in the presence of a constant external electric field <span class="math inline">\(\mathbf{E}_0\)</span>. Recall that we solved this problem previously by modeling the external field with two opposite point charges located far away from the sphere, and placed two image charges inside the sphere that fit the boundary conditions on the sphere. We’ll now show that we can solve this same problem using separation of variables as well.</p>
<p>Modeling this as a Dirichlet boundary value problem with <span class="math inline">\(\mathbf{E}_0 = E_0 \mathbf{e}_z\)</span> oriented along the <span class="math inline">\(z\)</span>-axis, we write <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(r,\theta,\varphi) = 0 \ , \\
\text{where} \ \phi(R,\theta,\varphi) = 0 \ , \\
\phi(r,\theta,\varphi) \rightarrow -E_0 r\cos\theta \ \text{as} \ r \rightarrow \infty \ .
\end{cases}
\end{align*}
\]</span> Note the last boundary condition was chosen to ensure <span class="math inline">\(\phi\)</span> becomes the potential for <span class="math inline">\(E_0\)</span> at <span class="math inline">\(z=\infty\)</span>, i.e.&nbsp;<span class="math inline">\(\phi = -E_0z\)</span>. This problem is clearly azimuthally symmetric as well. However, since the potential in this case doesn’t vanish at infinity we can’t set <span class="math inline">\(a_\ell=0\)</span> anymore. We have to include both terms. Suppose then that <span class="math display">\[
\phi(r,\theta,\varphi) = \sum_{\ell=0}^\infty \big(a_\ell r^\ell + b_\ell r^{-\ell(\ell+1)}\big) P_\ell(\cos\theta) \ .
\]</span> At the surface of the sphere we must have <span class="math inline">\(\phi(R,\theta,\varphi) = 0\)</span>, which means each term in the sum must vanish, with <span class="math display">\[
\big(a_\ell R^\ell + b_\ell R^{-\ell(\ell+1)}\big) P_\ell(\cos\theta) = 0 \ .
\]</span> Since <span class="math inline">\(P_\ell(\cos\theta)\)</span> doesn’t depend on <span class="math inline">\(r\)</span>, the only way each term can vanish is if the terms in parentheses do. This happens when <span class="math display">\[
b_\ell = -a_\ell R^{2\ell+1} \ .
\]</span> Let’s now look at the limiting behavior as <span class="math inline">\(r \rightarrow \infty\)</span>. When <span class="math inline">\(r \gg R\)</span> we can neglect the second term and write <span class="math display">\[
\phi(r,\theta,\varphi) \approx \sum_{\ell=0}^\infty a_\ell r^\ell P_\ell(\cos\theta) \ .
\]</span> To satisfy the boundary condition at infinity we require that <span class="math inline">\(\phi(r,\theta,\varphi) \approx -E_0 r \cos\theta\)</span>. Matching this condition with the series evidently forces <span class="math inline">\(\ell = 1\)</span> while the other terms must vanish. Since <span class="math inline">\(P_1(\cos\theta) = \cos\theta\)</span>, we then get <span class="math display">\[
-E_0 r \cos\theta = a_1 r \cos\theta \quad \Longrightarrow \quad a_1 = -E_0 \ .
\]</span> Plugging this in, we get a final expression for the potential satisfying these boundary conditions, with <span class="math display">\[
\phi(\mathbf{x}) = -E_0 r \bigg(1 - \frac{R^3}{r^3}\bigg) \cos\theta \ .
\]</span> This of course is exactly what we found before using the method of images. It’s useful to look at the induced surface charge on the sphere to see how the charges on the surface are distributing in response to the external field. We do that by calculating <span class="math display">\[
\sigma = -\frac{1}{4\pi} \frac{\partial \phi}{\partial r} \bigg|_{r=R} = \frac{E_0}{\pi} \cos\theta \ .
\]</span> Notice that charge density is evidently the most positive near <span class="math inline">\(\theta = 0\)</span> and the most negative near <span class="math inline">\(\theta = \pi\)</span>. This indicates that positive charge is building up in the direction of the external field, while negative charge is building up opposite to the direction of the field, which is of course what we’d expect physically in this situation.</p>
<hr>
<p>Before moving onto the more general non-azimuthally symmetric case we’ll mention one more useful property of azimuthally symmetric potentials that can often be useful for solving BVPs. In this case, we know the potential must have the general form <span class="math display">\[
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \big(a_\ell r^\ell + b_\ell r^{-(\ell+1)}\big) P_\ell(\cos\theta) \ .
\]</span> Now, let’s look at the special case where the field point <span class="math inline">\(\mathbf{x}\)</span> lies on the positive <span class="math inline">\(z\)</span>-axis, so that <span class="math inline">\(\mathbf{x} = z \mathbf{e}_z\)</span>. Along this axis we must have <span class="math inline">\(\theta = 0\)</span> in spherical coordinates, hence <span class="math inline">\(r=z\)</span>. We also know that <span class="math inline">\(P_\ell(1) = 1\)</span> for all <span class="math inline">\(\ell\)</span>. This means along this axis we must have <span class="math display">\[
\phi(z) = \sum_{\ell=0}^\infty \big(a_\ell z^\ell + b_\ell z^{-(\ell+1)}\big) \ .
\]</span> This tells us something interesting. Provided we can find the potential <span class="math inline">\(\phi(z)\)</span> along the positive <span class="math inline">\(z\)</span>-axis, a much simpler case usually for azimuthally symmetric potentials, then we can immediately obtain the general solution as well by following the procedure above in reverse. We first find <span class="math inline">\(\phi(z)\)</span> and expand it in powers of <span class="math inline">\(z\)</span>. Then, we set <span class="math inline">\(r=z\)</span> and multiply each term by its corresponding Legendre polynomial <span class="math inline">\(P_\ell(\cos\theta)\)</span>.</p>
<p>This trick provides an expedient way to obtain the general solution to many interesting BVPs. Let’s see a quick example of this.</p>
</section>
<section id="example-potential-of-a-ring-of-uniform-charge" class="level5">
<h5 class="anchored" data-anchor-id="example-potential-of-a-ring-of-uniform-charge">Example: Potential of a ring of uniform charge</h5>
<p>Suppose we have a planar circular ring of radius <span class="math inline">\(a\)</span> containing a uniform charge line density <span class="math inline">\(\lambda\)</span>. We’ll suppose the ring is centered at the origin and oriented in the <span class="math inline">\(xy\)</span>-plane. This means the problem will be azimuthally symmetric.</p>
<p>FIGURE (show ring of charge)</p>
<p>Now, suppose we’re interested in the potential at each <span class="math inline">\(r &gt; a\)</span> outside the ring. To solve this problem we’ll first try to find <span class="math inline">\(\phi(z)\)</span>. We can do this any way we like. For this problem it’s most convenient to use the integral formula directly. Since the ring is one-dimensional, we’ll use the integral formula <span class="math display">\[
\phi(z) = \int d\ell \ \frac{\lambda(\mathbf{x}')}{|z \mathbf{e}_z - \mathbf{x}'|} \ .
\]</span> Since the ring has constant line charge density <span class="math inline">\(\lambda\)</span>, we can pull it outside the integral. Since all charges lie on a ring of radius <span class="math inline">\(a\)</span>, we can write <span class="math inline">\(d\ell = a d\varphi\)</span> and <span class="math inline">\(|z\mathbf{e}_z - \mathbf{x}'| = \sqrt{a^2 + z^2}\)</span>. Since the integrand becomes independent of the integration variable <span class="math inline">\(\varphi\)</span>, we get <span class="math display">\[
\phi(z) = a \lambda \int_0^{2\pi} \frac{d\varphi}{\sqrt{a^2 + z^2}} = \frac{2\pi a^2 \lambda}{\sqrt{a^2 + z^2}}  \ .
\]</span> This is the exact solution for the potential along the positive <span class="math inline">\(z\)</span>-axis. To get the general solution we first need to expand <span class="math inline">\(\phi(z)\)</span>. Since we’re only interested in field points where <span class="math inline">\(r &gt; a\)</span>, we need only do an expansion in integer powers of <span class="math inline">\(a/r\)</span>. This can easily be done by taking the binomial expansion of <span class="math inline">\((a^2 + z^2)^{-1/2}\)</span>, in which case we get <span class="math display">\[
\phi(z) = 2\pi a^2 \lambda \bigg[\frac{1}{z} - \frac{1}{2} \frac{a^2}{z^3} + \frac{3}{8} \frac{a^4}{z^5} - \frac{5}{16} \frac{a^6}{z^7} + \cdots \bigg] \ .
\]</span> Finally, we set <span class="math inline">\(r=z\)</span> and multiply each <span class="math inline">\(1/r^{\ell+1}\)</span> term by its Legendre polynomial <span class="math inline">\(P_\ell(\cos\theta)\)</span> to get the general solution, <span class="math display">\[
\phi(\mathbf{x}) = 2\pi a^2 \lambda \bigg[\frac{1}{r} - \frac{1}{2} \frac{a^2}{r^3} P_2(\cos\theta) + \frac{3}{8} \frac{a^4}{r^5} P_4(\cos\theta) - \frac{5}{16} \frac{a^6}{r^7} P_6(\cos\theta) + \cdots \bigg]  \ .
\]</span> Notice that <span class="math inline">\(q = 2\pi a^2 \lambda\)</span> is just the total charge of the ring. This means the first expansion term is just <span class="math inline">\(q/r\)</span>. This is exactly what we expect, since very far away from the ring it should behave like a point charge. We call this the <em>monopole term</em>. The next expansion term goes like <span class="math inline">\(1/r^3\)</span>. We call this the <em>quadrupole term</em>. And so on. In fact, what we’ve just done is a <em>multipole expansion</em> of this potential. We’ll study such expansions in great depth in the next chapter.</p>
<p>If we like, we can do an expansion for <span class="math inline">\(r &lt; a\)</span> as well, by replacing <span class="math inline">\(a^\ell / r^{\ell+1} \to r^\ell / a^{\ell+1}\)</span> to get <span class="math display">\[
\phi(\mathbf{x}) = 2\pi a^2 \lambda \bigg[\frac{1}{a} - \frac{1}{2} \frac{r^2}{a^3} P_2(\cos\theta) + \frac{3}{8} \frac{r^4}{a^5} P_4(\cos\theta) - \frac{5}{16} \frac{r^6}{a^7} P_6(\cos\theta) + \cdots \bigg]  \ .
\]</span> These together give the potential at all points in space, except along the spherical shell <span class="math inline">\(r=a\)</span>. The two solutions can be joined to get a solution along the shell by setting <span class="math inline">\(r=a\)</span>. The potential will be finite at every point except along the ring itself, where we end up with a divergent series.</p>
</section>
</section>
<section id="general-potentials" class="level4">
<h4 class="anchored" data-anchor-id="general-potentials">General Potentials</h4>
<p>Now that we’ve studied the special case of azimuthally symmetric potentials we’ll return to the general case where the potential can depend on the angle <span class="math inline">\(\varphi\)</span> as well. Recall we had the following form for Laplace’s equation in spherical coordinates, <span class="math display">\[
\frac{\partial}{\partial r} \bigg(r^2 \frac{\partial \phi}{\partial r}\bigg) + \frac{1}{ \sin\theta} \frac{\partial}{\partial \theta} \bigg(\sin\theta \frac{\partial \phi}{\partial \theta}\bigg) + \frac{1}{\sin^2 \theta} \frac{\partial^2 \phi}{\partial \varphi^2} = 0 \ .
\]</span> Now we’ll keep the last term involving the <span class="math inline">\(\varphi\)</span> derivatives in. However, since the two angular terms depend on each other, we can only separate the radial and angular components, but not all three. Suppose then a trial solution of the form <span class="math display">\[
\phi(\mathbf{x}) = R(r) Y(\theta,\varphi) \ .
\]</span> Plugging this trial solution into the above equation and dividing by <span class="math inline">\(\phi = RY\)</span>, we get <span class="math display">\[
0 = \frac{1}{R} \frac{d}{dr} \bigg(r^2 \frac{dR}{dr}\bigg) + \frac{1}{Y}\bigg[\frac{1}{\sin\theta} \frac{\partial}{\partial\theta} \bigg(\sin\theta \frac{\partial Y}{\partial\theta}\bigg) + \frac{1}{\sin^2 \theta} \frac{\partial^2 Y}{\partial\varphi^2}\bigg] \ .
\]</span> Since these two terms are independent of the other, the only way they can sum to zero is they both equal the same constant but with opposite sign. Again, we’ll denote the separation constant by <span class="math inline">\(\ell(\ell+1)\)</span> and write <span class="math display">\[
\begin{align*}
\frac{d}{dr} \bigg(r^2 \frac{dR}{dr}\bigg) &amp;= \ell (\ell+1) R(r) \\
\frac{\partial}{\partial\theta} \bigg(\sin\theta \frac{\partial Y}{\partial\theta}\bigg) + \frac{\partial^2 Y}{\partial\varphi^2} &amp;= -\ell (\ell+1) \sin^2 \theta \ Y(\theta,\varphi) \ .
\end{align*}
\]</span> The first equation we recognize from before. It’s the radial equation. Its general solution is given by <span class="math display">\[
R(r) = a r^\ell + b r^{-(\ell+1)} \ .
\]</span> The second equation is evidently a more general form of the angular equation. We can again separate variables for the angular equation by supposing a second trial solution of the form <span class="math display">\[
Y(\theta,\varphi) = \Theta(\theta) \Phi(\varphi) \ .
\]</span> If we plug this into the angular equation and divide by <span class="math inline">\(\Theta\Phi \ \)</span>, we get <span class="math display">\[
\bigg[\frac{1}{\Theta} \frac{d}{d\theta} \bigg(\sin\theta \frac{d\Theta}{d\theta}\bigg) - \ell (\ell+1) \sin^2 \theta\bigg] + \frac{1}{\Phi} \frac{d^2 \Phi}{d\varphi^2} = 0
\]</span> Again, each term is an independent function of its own variable, so the only way their sum can vanish is if they’re both constants of equal and opposite sign. For reasons we’ll see in a moment, we’ll denote the separation constant by <span class="math inline">\(m^2\)</span> and write <span class="math display">\[
\begin{align*}
&amp;\frac{d}{d\theta} \bigg(\sin\theta \frac{d\Theta}{d\theta}\bigg) - \ell (\ell+1)\Theta(\theta) = m^2 \Theta(\theta) \ , \\
&amp;\frac{d^2\Phi}{d\varphi^2} = -m^2 \Phi(\varphi) \ .
\end{align*}
\]</span> The second equation is easy to solve. It’s just a sum of complex exponentials <span class="math inline">\(e^{\pm im\varphi}\)</span>. Since we’re dealing with an angle, we require that any solution <span class="math inline">\(\Phi(\varphi)\)</span> be periodic, meaning <span class="math inline">\(\Phi(\varphi) = \Phi(\varphi + 2\pi)\)</span>. It’s easy to see that this requirement forces <span class="math inline">\(m\)</span> to be an integer. By convention, we’ll allow <span class="math inline">\(m\)</span> to run both positive and negative, and write <span class="math inline">\(\Phi(\varphi)\)</span> in the form <span class="math display">\[
\Phi(\varphi) = c e^{im\varphi} \ .
\]</span> We’re now left with the other differential equation to deal with, which we’ll write as <span class="math display">\[
\frac{d}{d\theta} \bigg(\sin\theta \frac{d\Theta}{d\theta}\bigg) - \big[\ell (\ell+1) \sin^2 \theta - m^2\big] \Theta(\theta) = 0 \ .
\]</span> Notice that this equation looks very similar to the Legendre equation except there’s an extra term of the form <span class="math inline">\(m^2 \Theta(\theta)\)</span> present. From the appendix, we know that the solutions to this equation are the <em>associated Legendre functions</em> <span class="math inline">\(P_\ell^m(\cos\theta)\)</span>, where <span class="math inline">\(\ell\)</span> again must be a non-negative integer, and <span class="math inline">\(m\)</span> must be an integer that runs from <span class="math inline">\(-\ell\)</span> to <span class="math inline">\(\ell\)</span>. By again defining <span class="math inline">\(x = \cos\theta\)</span> we can again define these functions in terms of a Rodrigues’ equation, with <span class="math display">\[
P_\ell^m(x) = \frac{1}{2^\ell \ell!} (1-x^2)^{m/2} \frac{d^{\ell+m}}{dx^{\ell+m}} (x^2 - 1)^\ell \ .
\]</span> These also form a complete set of orthogonal functions on the interval <span class="math inline">\(-1 \leq x \leq 1\)</span>, which means we can use superposition to write the general solution <span class="math inline">\(\Theta(\theta)\)</span> in the form <span class="math display">\[
\Theta(\theta) = \sum_{\ell=0}^\infty \sum_{m=-\ell}^\ell c_{\ell m} P_\ell^m(\cos\theta) \ .
\]</span> If we combine <span class="math inline">\(\Theta(\theta)\)</span> and <span class="math inline">\(\Phi(\varphi)\)</span> back together, we get an angular solution <span class="math inline">\(Y(\theta,\varphi)\)</span> of the form <span class="math display">\[
Y(\theta,\varphi) = \sum_{\ell=0}^\infty \sum_{m=-\ell}^\ell c_{\ell m} P_\ell^m(\cos\theta) e^{im\varphi} \ .
\]</span> Note that we absorbed the integration constant for <span class="math inline">\(\Phi(\varphi)\)</span> into the ones for <span class="math inline">\(\Theta(\theta)\)</span>.</p>
<p>Now, recall again from the appendix that functions proportional to <span class="math inline">\(P_\ell^m(\cos\theta) e^{im\varphi}\)</span> also have a name. They’re called the <em>spherical harmonics</em>, which we by convention normalize and write in the more complicated form <span class="math display">\[
Y_{\ell m}(\theta,\varphi) \equiv (-1)^m \sqrt{\frac{2\ell+1}{4\pi} \frac{(\ell-m)!}{(\ell+m)!}} P_\ell^m(\cos\theta) e^{im\varphi} \ .
\]</span> The spherical harmonics are precisely the eigenfunctions of the Laplacian in spherical coordinates. By construction, they form a complete orthonormal set of functions on the sphere, meaning we can write any <span class="math inline">\(Y(\theta,\varphi)\)</span> as a superposition of them, <span class="math display">\[
Y(\theta,\varphi) = \sum_{\ell=0}^\infty \sum_{m=-\ell}^\ell c_{\ell m} Y_\ell^m(\theta,\varphi) \ .
\]</span> Finally, we can combine <span class="math inline">\(R(r)\)</span> and <span class="math inline">\(Y(\theta,\varphi)\)</span> back together to get the general solution for the potential <span class="math inline">\(\phi(\mathbf{x})\)</span>. We’ll again absorb the constants <span class="math inline">\(c_{\ell m}\)</span> into the constants of <span class="math inline">\(R(r)\)</span> and write <span class="math display">\[
\boxed{
\phi(\mathbf{x}) = \sum_{\ell=0}^\infty \sum_{m=-\ell}^\ell \big(a_{\ell m} r^\ell + b_{\ell m} r^{-(\ell+1)}\big) Y_\ell^m(\theta,\varphi)} \ .
\]</span> This equation looks exactly the same as the one for the azimuthally symmetric potential, except we now have to replace the Legendre polynomial <span class="math inline">\(P_\ell(\cos\theta)\)</span> by the more general spherical harmonic <span class="math inline">\(Y_\ell^m(\theta,\varphi)\)</span> and sum over <span class="math inline">\(m\)</span>. Indeed, it’s easy to see that the azimuthally symmetric potential is a special case of this general potential. Azimuthal symmetry is evidently equivalent to requiring that <span class="math inline">\(m=0\)</span>. If we set <span class="math inline">\(m=0\)</span> in the general potential we recover the previous one, up to a normalization factor. The coefficients <span class="math inline">\(a_{\ell m}\)</span> and <span class="math inline">\(b_{\ell m}\)</span> can be found in the usual way, by imposing the final boundary condition and taking an inner product.</p>
</section>
</section>
<section id="separation-of-variables-in-cylindrical-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="separation-of-variables-in-cylindrical-coordinates">Separation of Variables in Cylindrical Coordinates</h2>
<p>Last, we’ll apply separation of variables to the Laplacian in cylindrical coordinates <span class="math inline">\((\varrho,\varphi,z)\)</span>. In cylindrical coordinates, the Laplacian can be written in the form <span class="math display">\[
\nabla^2 \phi = \frac{1}{\varrho} \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial\phi}{\partial\varrho} \bigg) + \frac{1}{\varrho^2} \frac{\partial^2 \phi}{\partial^2\varphi} + \frac{\partial^2 \phi}{\partial z^2} \ .
\]</span> To satisfy Laplace’s equation we again require <span class="math inline">\(\nabla^2 \phi = 0\)</span>. If we set the above equation equal to zero we get <span class="math display">\[
0 = \frac{1}{\varrho} \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial\phi}{\partial\varrho} \bigg) + \frac{1}{\varrho^2} \frac{\partial^2 \phi}{\partial^2\varphi} + \frac{\partial^2 \phi}{\partial z^2} \ .
\]</span> As with spherical coordinates, the terms aren’t completely separable since <span class="math inline">\(\varrho\)</span> appears in two terms. We’ll first consider the case of cylindrical symmetry, where the potential is independent of <span class="math inline">\(z\)</span>, before proceeding to the case of more general potentials.</p>
<section id="cylindrically-symmetric-potentials" class="level4">
<h4 class="anchored" data-anchor-id="cylindrically-symmetric-potentials">Cylindrically Symmetric Potentials</h4>
<p>For problems with cylindrically symmetry the potential depends only on <span class="math inline">\(r\)</span> and <span class="math inline">\(\varphi\)</span>, not on <span class="math inline">\(z\)</span>. These kinds of problems include the infinitely long wire held at constant potential, or infinitely long wires held at some anisotropic potential <span class="math inline">\(V(\varphi)\)</span>.</p>
<p>If we assume the potential is cylindrically symmetric then the <span class="math inline">\(z\)</span> derivatives in Laplace’s equation vanish, and we can multiply through by <span class="math inline">\(\varrho^2\)</span> and write Laplace’s equation in the form <span class="math display">\[
0 = \varrho \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial\phi}{\partial\varrho} \bigg) + \frac{\partial^2 \phi}{\partial^2\varphi} \ .
\]</span> Now each term is separable and we can proceed to apply separation of variables. Assume a trial solution of the form <span class="math display">\[
\phi(\mathbf{x}) = R(\varrho) \Phi(\varphi) \ .
\]</span> Plugging this into Laplace’s equation and dividing through by <span class="math inline">\(\phi = RZ\)</span>, we end up with <span class="math display">\[
0 = \frac{\varrho}{R} \frac{d}{d\varrho} \bigg(\varrho \frac{dR}{d\varrho} \bigg) + \frac{1}{\Phi} \frac{d^2 \Phi}{d\varphi^2} \ .
\]</span> The only way this equation can vanish is if both terms equal a constant of opposite sign, which we’ll call <span class="math inline">\(n^2\)</span>. Then we have <span class="math display">\[
\begin{align*}
\varrho \frac{d}{d\varrho} \bigg(\varrho \frac{dR}{d\varrho} \bigg)&amp;= n^2 R(\varrho) \ , \\
\frac{d^2 \Phi}{d\varphi^2} &amp;= -n^2 \Phi(\varphi) \ .
\end{align*}
\]</span> The second equation is easy enough to solve. In real form its solutions are sines and cosines. Provided the problem allows <span class="math inline">\(\varphi\)</span> to range over the full circle from <span class="math inline">\(0 \leq \varphi \leq 2\pi\)</span>, then we require that the potential be the same when <span class="math inline">\(\varphi \rightarrow \varphi + 2\pi\)</span>. That is, we require that <span class="math inline">\(n\)</span> be an integer so that <span class="math inline">\(\Phi(\phi) = \Phi(\phi + 2\pi)\)</span>. This means that for each <span class="math inline">\(n\)</span> we’ll have a solution of the form <span class="math display">\[
\Phi_n(\varphi) = a \cos n\varphi + b \sin n\varphi \ .
\]</span> Note that if <span class="math inline">\(\varphi\)</span> is restricted to some range <span class="math inline">\(0 \leq \varphi \leq \beta\)</span> then we have to modify this result slightly. In that case, <span class="math inline">\(n\)</span> will no longer be an integer, but must instead be an integer multiple of <span class="math inline">\(\frac{\pi}{\beta}\)</span>. We’ll see an example of such a case below.</p>
<p>Anyway, to get the full solution for all integer <span class="math inline">\(n\)</span> we appeal to the principle of superposition. We know that the set of functions <span class="math inline">\(\Phi_n(\varphi)\)</span> are just the real Fourier functions on the interval <span class="math inline">\(0 \leq \varphi \leq 2\pi\)</span>, which form a complete set of orthogonal functions on this interval. This means the general solution <span class="math inline">\(\Phi(\varphi)\)</span> can be written in terms of a real Fourier series of the form <span class="math display">\[
\Phi(\varphi) = \frac{a_0}{2} + \sum_{n=1}^\infty \big(a_n \cos n\varphi + b_n \sin n\varphi\big) \ .
\]</span> To solve the first equation we’ll assume a trial solution of the form <span class="math inline">\(R(\varrho) = \varrho^\lambda\)</span>. Plugging this in forces <span class="math inline">\(\lambda = \pm n\)</span>, giving <span class="math display">\[
R_n(\varrho) = c_1 \varrho^n + c_2 \varrho^{-n} \ .
\]</span> However, this is only true when <span class="math inline">\(n \neq 0\)</span>. When <span class="math inline">\(n=0\)</span> we need to solve for <span class="math inline">\(R(\varrho)\)</span> separately. In that case it’s easy to see that <span class="math display">\[
R_0(\varrho) = d_1 + d_2 \log \varrho \ .
\]</span> To get the general solution for the potential we then combine these two functions. We’ll absorb the constants together and write <span class="math display">\[
\phi(\mathbf{x}) = a_0 + b_0 \log\varrho + \sum_{n=1}^\infty \big[(a_n \cos n\varphi + b_n \sin n\varphi)\varrho^n + (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n}\big] \ .
\]</span> Note that the requirement that the potential not blow up inside the boundary surface will generally force some of these constants to vanish depending on whether we’re inside of our outside of the boundary surface. If we’re inside the surface, we require that <span class="math inline">\(b_0\)</span> and the <span class="math inline">\(\varrho^{-n}\)</span> constants <span class="math inline">\(c_n\)</span> and <span class="math inline">\(d_n\)</span> vanish so that the potential doesn’t blow up at the origin. If we’re outside the surface we require that the <span class="math inline">\(\varrho^n\)</span> constants <span class="math inline">\(a_n\)</span> and <span class="math inline">\(b_n\)</span> vanish so that the potential vanishes at infinity.</p>
<p>To check that this solution makes sense, let’s consider the case of a potential where <span class="math inline">\(\phi = \phi(\varrho)\)</span> only. In this case only the <span class="math inline">\(n=0\)</span> terms survive, leaving <span class="math display">\[
\phi(\varrho) = a_0 + b_0 \log\varrho \ .
\]</span> The associated electric field is then <span class="math inline">\(\mathbf{E}(\mathbf{x}) = E(\varrho) \mathbf{e}_\varrho\)</span>, where <span class="math display">\[
E(\varrho) = -\frac{d\phi}{d\varrho} = -\frac{b_0}{\varrho} \equiv \frac{2\lambda}{\varrho} \ .
\]</span> If we take <span class="math inline">\(b_0 = -2\lambda\)</span> and <span class="math inline">\(a_0 = \phi(0)\)</span> as a ground point, this is evidently the potential of a uniform wire with line density <span class="math inline">\(\lambda\)</span>. Let’s now consider a more general example.</p>
<section id="example-grounded-infinite-wire-perpendicular-to-a-uniform-electric-field" class="level5">
<h5 class="anchored" data-anchor-id="example-grounded-infinite-wire-perpendicular-to-a-uniform-electric-field">Example: Grounded infinite wire perpendicular to a uniform electric field</h5>
<p>Let’s now consider the problem of an infinite, grounded wire of some thickness <span class="math inline">\(R\)</span> that’s placed perpendicular to a uniform external electric field <span class="math inline">\(\mathbf{E}_0\)</span>. We’ll suppose the wire is oriented along the <span class="math inline">\(z\)</span>-axis and the field is oriented in the direction of the positive <span class="math inline">\(x\)</span>-axis, with <span class="math inline">\(\mathbf{E}_0 = E_0 \mathbf{e}_x\)</span>.</p>
<p>FIGURE</p>
<p>We can thus formulate this problem in terms of the following Dirichlet boundary value problem, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(\varrho,\varphi,z) = 0 \ , \\
\text{where} \ \phi(R,\varphi,z) = 0 \ , \\
\phi(r,\varphi,z) \rightarrow -E_0 \varrho \cos\varphi \ \text{as} \ \varrho \rightarrow \infty \ .
\end{cases}
\end{align*}
\]</span> Again, we see that this problem is clearly cylindrically symmetric since the wire is infinite and perpendicular to the field. This means the general solution for the potential can again be written in the form <span class="math display">\[
\phi(\mathbf{x}) = a_0 + b_0 \log\varrho + \sum_{n=1}^\infty \big[(a_n \cos n\varphi + b_n \sin n\varphi)\varrho^n + (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n}\big] \ .
\]</span> Requiring that <span class="math inline">\(\phi \rightarrow -E_0 \varrho \cos\varphi\)</span> as <span class="math inline">\(\varrho \rightarrow \infty\)</span> forces <span class="math inline">\(a_0 = b_0 = 0\)</span> and <span class="math inline">\(b_n = d_n = 0\)</span> for all <span class="math inline">\(n\)</span>, and <span class="math inline">\(a_n = c_n = 0\)</span> when <span class="math inline">\(n \neq 1\)</span>. When <span class="math inline">\(n=1\)</span> we must evidently have <span class="math inline">\(a_1 = -E_0\)</span> as well. This evidently leaves a solution of the form <span class="math display">\[
\phi(\mathbf{x}) = \bigg(-E_0 \rho + \frac{c_1}{\varrho}\bigg) \cos\varphi \ .
\]</span> Requiring now that the potential vanish on the surface of the wire forces <span class="math inline">\(c_1 = E_0 R^2\)</span>. Plugging this back in, we finally have <span class="math display">\[
\phi(\mathbf{x}) = -E_0 \varrho \bigg(1 - \frac{R^2}{\varrho^2}\bigg) \cos\varphi \ .
\]</span> When dealing with conductors placed in an external field, it’s good to look at the induced charge density <span class="math inline">\(\sigma\)</span> along the surface of the conductor as well. Since the surface normal is just <span class="math inline">\(\mathbf{n} = \mathbf{e}_\varrho\)</span> in this problem, we have <span class="math display">\[
\sigma = -\frac{1}{4\pi} \frac{\partial \phi}{\partial\varrho} = \frac{E_0}{2\pi} \cos\varphi \ .
\]</span> As we’d expect, the surface charge polarizes along the direction of the field, with positive charge concentrating in the positive <span class="math inline">\(x\)</span>-direction and the negative charge concentrating in the negative <span class="math inline">\(x\)</span>-direction.</p>
</section>
<section id="example-infinite-hollow-cylinder-held-at-a-given-surface-charge-density" class="level5">
<h5 class="anchored" data-anchor-id="example-infinite-hollow-cylinder-held-at-a-given-surface-charge-density">Example: Infinite hollow cylinder held at a given surface charge density</h5>
<p>Suppose we have an infinitely long hollow cylinder of radius <span class="math inline">\(R\)</span> whose surface is held at some surface charge density <span class="math inline">\(\sigma(\varphi)\)</span>. We’re interested in the behavior of the potential inside and outside the cylinder.</p>
<p>FIGURE</p>
<p>Recall that we can relate the surface density to the potential via its normal derivative, with <span class="math inline">\(\frac{\partial \phi}{\partial n} = -4\pi \sigma\)</span>. Since the surface normal to the cylinder is <span class="math inline">\(\mathbf{n} = \pm \mathbf{e}_\varrho\)</span> depending on whether we’re outside or inside the surface, we thus require that <span class="math inline">\(\frac{\partial \phi}{\partial \varrho} \big|_{\varrho=R} = \mp 4\pi \sigma(\varphi)\)</span>. We’ll also require that the potential not blow up at any finite position or at infinity.</p>
<p>This means we end up with a Neumann boundary value problem to solve of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(\varrho,\varphi,z) = 0 \ , \\
\text{where} \ \frac{\partial \phi}{\partial \varrho} \big|_{\varrho=R} = \mp 4\pi \sigma(\varphi) \ .
\end{cases}
\end{align*}
\]</span> Since this problem is cylindrically symmetric, we know the general solution can be written in the form <span class="math display">\[
\phi(\mathbf{x}) = a_0 + b_0 \log\varrho + \sum_{n=1}^\infty \big[(a_n \cos n\varphi + b_n \sin n\varphi)\varrho^n + (c_n \cos n\varphi + d_n \sin n\varphi)\varrho^{-n}\big] \ .
\]</span> Now, outside the cylinder we require the potential not blow up at infinity. This forces <span class="math inline">\(b_0 = a_n = b_n = 0\)</span> outside the wire, giving <span class="math display">\[
\phi_+(\mathbf{x}) = a_0^+ + \sum_{n=1}^\infty (c_n^+ \cos n\varphi + d_n^+ \sin n\varphi)\varrho^{-n} \quad , \quad \varrho \geq R \ .
\]</span> Meanwhile, inside the cylinder we require that the potential not blow up when <span class="math inline">\(\varrho \leq R\)</span>. This forces <span class="math inline">\(b_0 = c_n = d_n = 0\)</span>, giving <span class="math display">\[
\phi_-(\mathbf{x}) = a_0^- + \sum_{n=1}^\infty (a_n^- \cos n\varphi + b_n^- \sin n\varphi)\varrho^n \quad , \quad \varrho \leq R \ .
\]</span> We now need to match these two solutions together at the boundary surface <span class="math inline">\(\varrho = R\)</span>. Along this surface we require that these two solutions match and that the difference in normal derivatives be proportional to <span class="math inline">\(\sigma(\varphi)\)</span>. The first condition requires that <span class="math display">\[
\begin{align*}
0 &amp;= \phi_+(R,\varphi,z) - \phi_-(R,\varphi,z) \\
&amp;= (a_0^+ - a_0^-) + \sum_{n=1}^\infty \bigg[(c_n^+ \cos n\varphi + d_n^+ \sin n\varphi) R^{-n} - (a_n^- \cos n\varphi + b_n^- \sin n\varphi) R^n \bigg] \\
&amp;= (a_0^+ - a_0^-) + \sum_{n=1}^\infty R^n \bigg[(c_n^+ R^{-2n} - a_n^-) \cos n\varphi + (d_n^+ R^{-2n} - b_n^-) \sin n\varphi \bigg] \ .
\end{align*}
\]</span> The only way this can hold is if each term in parentheses vanishes, with <span class="math inline">\(a_0^+ = a_0^-\)</span>, <span class="math inline">\(a_n^- = c_n^+ R^{-2n}\)</span>, and <span class="math inline">\(b_n^- = d_n^+ R^{-2n}\)</span>.</p>
<p>The second condition requires that <span class="math display">\[
\begin{align*}
\sigma(\varphi) &amp;= -\frac{1}{4\pi} \bigg[\frac{\partial \phi_+}{\partial \varrho} - \frac{\partial \phi_-}{\partial \varrho}\bigg]_{\varrho=R} \\
&amp;= -\frac{1}{4\pi} \sum_{n=1}^\infty \bigg[-n(c_n^+ \cos n\varphi + d_n^+ \sin n\varphi)R^{-(n+1)} - n(a_n^- \cos n\varphi + b_n^- \sin n\varphi)R^{n-1} \bigg] \\
&amp;= \frac{1}{4\pi} \sum_{n=1}^\infty n R^{n-1} \bigg[(c_n^+ R^{-2n} + a_n^-) \cos n\varphi + (d_n^+ R^{-2n} + b_n^-) \sin n\varphi \bigg] \ .
\end{align*}
\]</span> Once we have a specific form for <span class="math inline">\(\sigma(\varphi)\)</span> we can proceed to match coefficients on the left and right hand sides and determine the coefficients. As an example, suppose <span class="math inline">\(\sigma(\varphi) = k \sin m\varphi\)</span> for some integer <span class="math inline">\(m\)</span> and parameter <span class="math inline">\(k\)</span>. This means for all <span class="math inline">\(n \neq m\)</span> each term must vanish, with <span class="math inline">\(a_n^- = -c_n^+ R^{-2n}\)</span> for all <span class="math inline">\(n\)</span>, <span class="math inline">\(b_n^- = -d_n^+ R^{-2n}\)</span> for <span class="math inline">\(n \neq m\)</span>, and <span class="math inline">\(d_m^+ R^{-2m} + b_m^- = k\)</span> when <span class="math inline">\(n=m\)</span>.</p>
<p>Matching these two sets of conditions together, we evidently require that <span class="math inline">\(a_n^- = b_n^- = c_n^+ = d_n^+ = 0\)</span> when <span class="math inline">\(n \neq m\)</span>, and <span class="math display">\[
b_m^- = \frac{2\pi k}{m R^{m-1}} \quad , \quad d_m^+ = \frac{2\pi k}{m} R^{m+1} \ .
\]</span> The coefficients <span class="math inline">\(a_0^+ = a_0^-\)</span> are immaterial to this problem and can freely be set to zero. Plugging these coefficients in then gives the final potential for this particular choice of <span class="math inline">\(\sigma(\varphi)\)</span>, <span class="math display">\[
\phi(\mathbf{x}) = \begin{cases}
\frac{2\pi k R}{m} \big(\frac{\varrho}{R}\big)^m \sin m\varphi &amp; \varrho \leq R \ , \\
\frac{2\pi k R}{m} \big(\frac{R}{\varrho}\big)^m \sin m\varphi &amp; \varrho \geq R \ .
\end{cases} \ .
\]</span> Notice that this potential evidently has a discontinuous first derivative at the surface of the cylinder. This is consistent with our observation that the electric field is discontinuous when crossing a surface of charge.</p>
</section>
<section id="example-behavior-of-electric-fields-around-corners-and-edges-of-conductors" class="level5">
<h5 class="anchored" data-anchor-id="example-behavior-of-electric-fields-around-corners-and-edges-of-conductors">Example: Behavior of electric fields around corners and edges of conductors</h5>
<p>Let’s now consider a problem that will help us understand some physics better. We want to ask ourselves how the potential and electric field behave near sharp corners and edges of conducting objects. We can model this behavior by studying the following relatively simple problem.</p>
<p>Suppose we have two infinite conducting sheets that intersect at some angle <span class="math inline">\(0 \leq \beta \leq 2\pi\)</span> in the <span class="math inline">\(xy\)</span>-plane. We’ll suppose that both of the sheets are held at some constant potential <span class="math inline">\(V\)</span> on their surfaces. Since the sheets are infinite along the <span class="math inline">\(z\)</span>-direction, we can treat this as a cylindrically symmetric problem and focus only on the behavior of the potential <span class="math inline">\(\phi(\varrho,\varphi)\)</span> in the <span class="math inline">\(xy\)</span>-plane.</p>
<p>Consider then the following Dirichlet boundary value problem, <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(\varrho,\varphi,z) = 0 \ , \\
\text{where} \ \phi(\varrho,0,z) = V \ , \\
\phi(\varrho,\beta,z) = V \ .
\end{cases}
\end{align*}
\]</span> Note that we require <span class="math inline">\(0 \leq \varphi \leq \beta\)</span>. This means <span class="math inline">\(n\)</span> will no longer be an integer, but instead <span class="math inline">\(n = \frac{k\pi}{\beta}\)</span> for some integer <span class="math inline">\(k\)</span>. Replacing <span class="math inline">\(n\)</span> by this expression in the general formula for the potential, we thus have <span class="math display">\[
\phi(\mathbf{x}) = a_0 + b_0 \log\varrho + \sum_{k=1}^\infty \bigg[\bigg(a_k \cos \frac{k\pi\varphi}{\beta} + b_k \sin \frac{k\pi\varphi}{\beta}\bigg) \varrho^{k\pi / \beta} + \bigg(c_k \cos \frac{k\pi\varphi}{\beta} + d_k \sin \frac{k\pi\varphi}{\beta}\bigg) \varrho^{-k\pi / \beta}\bigg] \ .
\]</span> We’re interested in studying the behavior of this potential as <span class="math inline">\(\varrho \rightarrow 0\)</span>. To keep the potential from blowing up we thus require that <span class="math inline">\(b_0 = c_k = d_k = 0\)</span>. Requiring that <span class="math inline">\(\phi = V\)</span> when <span class="math inline">\(\varphi = 0,\beta\)</span> also forces <span class="math inline">\(a_0 = V\)</span> and all <span class="math inline">\(b_k = 0\)</span>. We’re thus left with the potential <span class="math display">\[
\phi(\mathbf{x}) = V + \sum_{k=1}^\infty b_k \varrho^{k\pi / \beta} \sin \frac{k\pi\varphi}{\beta} \ .
\]</span> Now, as <span class="math inline">\(\varrho \rightarrow 0\)</span> only the <span class="math inline">\(k=1\)</span> term dominates in the sum, meaning near the corner <span class="math inline">\(\varrho = 0\)</span> we have <span class="math display">\[
\phi(\mathbf{x}) \approx V + b_1 \varrho^{\pi / \beta} \sin \frac{\pi\varphi}{\beta} \ .
\]</span> This means near the corner the electric field is evidently given by <span class="math display">\[
\mathbf{E}(\mathbf{x}) \approx -\frac{\pi b_1}{\beta} \varrho^{\pi / \beta-1} \bigg(\sin \frac{\pi\varphi}{\beta}\mathbf{e}_\varrho + \cos \frac{\pi\varphi}{\beta} \mathbf{e}_\varphi\bigg) \ .
\]</span> The surface charge density near the corner is evidently then proportional to the field strength near the corner, with <span class="math display">\[
\sigma \approx \frac{|\mathbf{E}(\varrho,0)|}{4\pi} \approx -\frac{b_1}{4\beta} \varrho^{\pi / \beta-1} \ .
\]</span> Evidently, both the field strength and the density near the corner vary as <span class="math inline">\(\varrho^{\pi / \beta-1}\)</span>. Evidently, the strength of the field and the charge density near the corner will depend explicitly on the corner’s angle <span class="math inline">\(\beta\)</span>. In the figure below, we show this relation for different values of <span class="math inline">\(\beta\)</span>.</p>
<p>FIGURE</p>
<p>Notice when <span class="math inline">\(\beta = \pi\)</span> we recover the case of a flat conducting plane, where the electric field is constant and the charge is uniformly distributed along the surface. When <span class="math inline">\(\beta &lt; \pi\)</span> the charge density and field go to zero near the corner, but grow rapidly as we move away from the corner. Meanwhile, when <span class="math inline">\(\beta &gt; \pi\)</span> the corner becomes an edge, where the charge density and field become infinitely large at the edge before rapidly falling off away from the edge.</p>
<p>The same qualitative behaviors turn out to hold true for 3-dimensional surfaces as well. This is the reason why lightening rods work. The high concentration of charges near the edge of the rod creates a large electric field, which will draw lightening from the air when electric breakdown takes place. Electric breakdown typically occurs when clouds create electric field strengths higher than about <span class="math inline">\(E \sim 250 \ \frac{\text{kV}}{\text{cm}}\)</span>. When this happens, a closed circuit effectively gets created between the charged clouds and the ground, which causes the charge to move from clouds to the ground, where the lightening rod will attract much of the charge.</p>
</section>
</section>
<section id="general-potentials-1" class="level4">
<h4 class="anchored" data-anchor-id="general-potentials-1">General Potentials</h4>
<p>We’ll now return to the more general case with no symmetry in the potential. Recall we had Laplace’s equation in the form <span class="math display">\[
0 = \frac{1}{\varrho} \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial\phi}{\partial\varrho} \bigg) + \frac{1}{\varrho^2} \frac{\partial^2 \phi}{\partial^2\varphi} + \frac{\partial^2 \phi}{\partial z^2} \ .
\]</span> We’ll first apply separation of variables to split off the first two terms from the second. Assume a trial solution of the form <span class="math display">\[
\phi(\mathbf{x}) = F(\varrho, \varphi) Z(z) \ .
\]</span> Plugging this in and dividing by <span class="math inline">\(JZ\)</span>, we end up with <span class="math display">\[
0 = \frac{1}{F\varrho} \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial F}{\partial\varrho} \bigg) + \frac{1}{F\varrho^2} \frac{\partial^2 F}{\partial^2\varphi} + \frac{1}{Z}\frac{\partial^2 Z}{\partial z^2} \ .
\]</span> The only way this equation can vanish is if the first two terms equal a constant, and the last term is a constant of opposite sign. We’ll call that constant <span class="math inline">\(-k^2\)</span>. We then end up with two differential equations of the form <span class="math display">\[
\begin{align*}
\frac{1}{\varrho} \frac{\partial}{\partial\varrho} \bigg(\varrho \frac{\partial F}{\partial\varrho} \bigg) + \frac{1}{\varrho^2} \frac{\partial^2 F}{\partial^2\varphi} &amp;= -k^2 F(\varrho,\varphi) \ , \\
\frac{d^2 Z}{dz^2} &amp;= k^2 Z(z) \ .
\end{align*}
\]</span> The second equation is easy enough to solve. Its solutions are just exponentials, with <span class="math display">\[
Z(z) = A e^{kz} + B e^{-kz} \ .
\]</span> To deal with the first equation we separate variables again by assuming a trial solution of the form <span class="math display">\[
F(\varrho,\varphi) = R(\varrho) \Phi(\varphi) \ .
\]</span> Then multiplying both sides of the equation by <span class="math inline">\(\varrho^2\)</span>, dividing by <span class="math inline">\(F = R\Phi\)</span>, and rearranging terms, we get <span class="math display">\[
\bigg[\frac{\varrho}{R\varrho} \frac{d}{d\varrho} \bigg(\varrho \frac{dR}{d\varrho} \bigg) + k^2 \varrho^2\bigg] + \frac{1}{\Phi} \frac{d^2 \Phi}{d^2\varphi} = 0 \ .
\]</span> Again, the only way these terms can vanish is if they equal the same constant with opposite sign. We’ll call that constant <span class="math inline">\(n^2\)</span>, so that we end up with following two differential equations, <span class="math display">\[
\begin{align*}
\frac{1}{\varrho} \frac{d}{d\varrho} \bigg(\varrho \frac{dR}{d\varrho} \bigg) + k^2 \varrho^2 R(\varrho)  &amp;= n^2 R(\varrho) \ , \\
\frac{d^2 \Phi}{d^2\varphi} &amp;= -n^2 \Phi(\varphi) \ .
\end{align*}
\]</span> The second equation just gives the same solution found in the cylindrically symmetric case. Requiring that <span class="math inline">\(\Phi(\varphi)\)</span> be periodic on the interval <span class="math inline">\(0 \leq \varphi \leq 2\pi\)</span> forces <span class="math inline">\(n\)</span> be an integer. For each integer <span class="math inline">\(n\)</span> we get a solution in terms of sines and cosines of the form <span class="math display">\[
\Phi_n(\varphi) = a_n \cos n\varphi + b_n \sin n\varphi \ .
\]</span> Since these Fourier functions form a complete set of orthogonal functions, we can get the general solution <span class="math inline">\(\Phi(\varphi)\)</span> by expanding in terms of these basis functions <span class="math inline">\(\Phi_n(\varphi)\)</span> to get a Fourier series solution.</p>
<p>To deal with the first equation, we’ll expand out the derivative and move everything to one side to write <span class="math display">\[
\varrho^2\frac{d^2R}{d\varrho^2} + \varrho \frac{dR}{d\varrho} + \big(k^2 \varrho^2 - n^2\big) R(\varrho) = 0 \ .
\]</span> It’s conventional to write this equation slightly differently by letting <span class="math inline">\(x = k\varrho\)</span>. Plugging this in, we get <span class="math display">\[
x^2\frac{d^2R}{dx^2} + x \frac{dR}{dx} + \big(x^2 - n^2\big) R(x) = 0 \ .
\]</span> From the appendix, we recognize this differential equation as <em>Bessel’s equation</em>. Its solutions are given by a superposition of Bessel functions of the first and second kind, denoted <span class="math inline">\(J_n(x)\)</span> and <span class="math inline">\(Y_n(x)\)</span> respectively, <span class="math display">\[
R_n(x) = c_n J_n(x) + d_n Y_n(x) \ .
\]</span> Recall that Bessel functions can be qualitatively thought of as decaying oscillating functions. This means they’ll both have infinitely many roots, which we’ll call <span class="math inline">\(x_{nm}\)</span>, where <span class="math inline">\(m\)</span> is another integer characterizing the <span class="math inline">\(m\)</span><sup>th</sup> root of <span class="math inline">\(J_n(x)\)</span>. Note that by definition both <span class="math inline">\(J_n(x)\)</span> and <span class="math inline">\(Y_n(x)\)</span> will share the same roots for a given fixed <span class="math inline">\(n\)</span>.</p>
<p>As written, solutions of this form don’t form a complete set of orthogonal functions, but for each <span class="math inline">\(n\)</span> we can find such a set by letting <span class="math inline">\(k\)</span> be proportional to the roots <span class="math inline">\(x_{nm}\)</span>. Indeed, if we let <span class="math inline">\(k_{nm} = \frac{x_{nm}}{a}\)</span> for some characteristic length <span class="math inline">\(a\)</span>, then for each <span class="math inline">\(n\)</span>, the set of functions <span class="math inline">\(J_n(k_{nm} \varrho)\)</span> and <span class="math inline">\(Y_n(k_{nm} \varrho)\)</span> will form a complete set of orthogonal functions on the interval <span class="math inline">\(0 \leq \varrho \leq a\)</span>. We can then express each radial solution <span class="math inline">\(R_n(\varrho)\)</span> as a superposition of these basis functions <span class="math inline">\(R_{nm}(\varrho)\)</span> defined by <span class="math display">\[
R_{nm}(\varrho) = c_n J_n(k_{nm}\varrho) + d_n Y_n(k_{nm} \varrho) \ .
\]</span> To proceed further we need to know the specific boundary conditions for the given problem to stitch together the general solution. Let’s suppose we have a cylinder of radius <span class="math inline">\(R\)</span> and height <span class="math inline">\(h\)</span>. Suppose the bottom and side of the cylinder are grounded, and the top of the cylinder is held at some known potential <span class="math inline">\(V(\varrho,\varphi)\)</span>.</p>
<p>FIGURE</p>
<p>This then gives a Dirichlet boundary value problem of the form <span class="math display">\[
\begin{align*}
\begin{cases}
\nabla^2 \phi(\varrho,\varphi,z) = 0 \ , \\
\text{where} \ \phi(\varrho,\varphi,h) = V(\varrho,\varphi) \ , \\
\phi(\varrho,\varphi,0) = 0 \ , \\
\phi(R,\varphi,z) = 0 \ .
\end{cases}
\end{align*}
\]</span> Suppose first we’re inside the cylinder, so <span class="math inline">\(0 \leq \varrho \leq R\)</span> and <span class="math inline">\(0 \leq z \leq h\)</span>. We can express the radial solution as a superposition of Bessel functions of the form <span class="math display">\[
R_{nm}(\varrho) = c_{nm} J_n(k_{nm}\varrho) + d_{nm} Y_n(k_{nm} \varrho) \ ,
\]</span> where requiring <span class="math inline">\(k_{nm} = \frac{x_{nm}}{R}\)</span> will forces this solution to vanish at the sides of the cylinder where <span class="math inline">\(\varrho = R\)</span>. Since <span class="math inline">\(Y_n(k_{nm} \varrho)\)</span> blows up at the origin, requiring that the potential not blow up at the origin will force each <span class="math inline">\(d_{nm} = 0\)</span>.</p>
<p>Along the <span class="math inline">\(z\)</span>-direction, it’s easy to see that imposing the boundary condition <span class="math inline">\(Z(0) = 0\)</span> will yield a family of general solutions parametrized by <span class="math inline">\(k_{nm}\)</span> of the form <span class="math display">\[
Z_{nm}(z) = \sinh k_{nm} z \ .
\]</span> The general solution for <span class="math inline">\(\Phi_n(\varphi)\)</span> is unaffected by the boundary conditions. Multiplying the three solutions together will then yield an infinite set of basis potentials of the form <span class="math display">\[
\phi_{nm}(\varrho,\varphi,z) = J_n(k_{nm}\varrho) \big[a_{nm} \cos n\varphi + b_{nm} \sin n\varphi\big] \sinh k_{nm} z \ .
\]</span> These basis potentials still don’t satisfy the final boundary condition that <span class="math inline">\(\phi(\varrho,\varphi,h) = V(\varrho,\varphi)\)</span>. This means we need to use the principle of superposition to consider a more general class of solutions of the form <span class="math display">\[
\phi(\varrho,\varphi,z) = \sum_{n=0}^\infty \sum_{m=1}^\infty J_n(k_{nm}\varrho) \big[a_{nm} \cos n\varphi + b_{nm} \sin n\varphi\big] \sinh k_{nm} z \ .
\]</span> If we plug the final boundary condition into the previous expression and set <span class="math inline">\(z = h\)</span>, we get <span class="math display">\[
V(\varrho,\varphi) = \phi(\varrho,\varphi,h) = \sum_{n=0}^\infty \sum_{m=1}^\infty J_n(k_{nm}\varrho) \big[a_{nm} \cos n\varphi + b_{nm} \sin n\varphi\big] \sinh k_{nm} h \ .
\]</span> To determine the coefficients <span class="math inline">\(a_{nm}\)</span>, we multiply both sides by <span class="math inline">\(\varrho J_{n'}(k_{n'm'}\varrho) \cos n'\varphi\)</span> and integrate over <span class="math inline">\(\varrho\)</span> and <span class="math inline">\(\varphi\)</span> inside the cylinder. On the right-hand side, we end up with <span class="math display">\[
\sum_{n,m} \sinh k_{nm} h \int_0^R d\varrho \ \varrho J_{n'}(k_{n'm'}\varrho) J_n(k_{nm}\varrho) \int_0^{2\pi} d\varphi \ \cos n'\varphi \big[a_{nm} \cos n\varphi + b_{nm} \sin n\varphi\big] \ .
\]</span> To deal with the first integral we appeal to the orthogonality condition of Bessel functions, which says that <span class="math display">\[
\int_0^R d\varrho \ \varrho J_{n'}(k_{n'm'}\varrho) J_n(k_{nm}\varrho) = \frac{R^2}{2} J_{n'+1}^2(k_{n'm'} \varrho) \delta_{mm'} \ .
\]</span> For the second integral, we use the fact that <span class="math inline">\(\cos n'\varphi\)</span> will be orthogonal to all <span class="math inline">\(\sin n\varphi\)</span>, and all <span class="math inline">\(\cos n\varphi\)</span> when <span class="math inline">\(n \neq n'\)</span> to get <span class="math display">\[
\int_0^{2\pi} d\varphi \ \cos n'\varphi \big[a_{nm} \cos n\varphi + b_{nm} \sin n\varphi\big] = \pi a_{nm} \delta_{nn'} \ .
\]</span> Putting these two results together, the left-hand side evidently evaluates to <span class="math display">\[
\frac{\pi R^2}{2} J_{n'+1}^2(k_{n'm'} \varrho) a_{n'm'} \sinh k_{n'm'} h \ .
\]</span> For the right-hand side we do the same thing to get an integral of the form <span class="math display">\[
\int_0^R d\varrho \int_0^{2\pi} d\varphi \ \varrho V(\varrho,\varphi) J_{n'}(k_{n'm'}\varrho) \cos n'\varphi \ .
\]</span> This means the coefficients <span class="math inline">\(a_{nm}\)</span> will be given by the formula <span class="math display">\[
a_{nm} = \frac{2}{\pi R^2 J_{n+1}^2(k_{nm} \varrho)} \frac{1}{\sinh k_{nm} h} \int_0^R d\varrho \int_0^{2\pi} d\varphi \ \varrho V(\varrho,\varphi) J_{n}(k_{nm}\varrho) \cos n\varphi \ .
\]</span> Note that this is strictly speaking only true when <span class="math inline">\(n \neq 0\)</span>. When <span class="math inline">\(n = 0\)</span> we need to also divide by <span class="math inline">\(2\)</span>, since in that case no cosine terms appear in the <span class="math inline">\(\varphi\)</span> integral, which will cause it to give <span class="math inline">\(2\pi\)</span> instead of <span class="math inline">\(\pi\)</span>.</p>
<p>Similarly, we can determine the coefficients <span class="math inline">\(b_{nm}\)</span> by multiplying both sides of the equation for <span class="math inline">\(\phi(\varrho,\varphi,h)\)</span> by <span class="math inline">\(\varrho J_{n'}(k_{n'm'}\varrho) \sin n'\varphi\)</span> and performing the same integrations. We end up with the same formula except with the cosine replaced by a sine, <span class="math display">\[
b_{nm} = \frac{2}{\pi R^2 J_{n+1}^2(k_{nm} \varrho)} \frac{1}{\sinh k_{nm} h} \int_0^R d\varrho \int_0^{2\pi} d\varphi \ \varrho V(\varrho,\varphi) J_{n}(k_{nm}\varrho) \sin n\varphi \ .
\]</span> Once these coefficients are determined we have the general solution for the potential that solves this BVP.</p>
<p>In some cases, we might be interested in a problem where there is no cylindrical surface present. In that case we want to send <span class="math inline">\(R \rightarrow \infty\)</span> and <span class="math inline">\(z \rightarrow \infty\)</span>. It turns out in this case that the radial solution <span class="math inline">\(R(\varrho)\)</span> will now need to be expressed as an integral over all <span class="math inline">\(k\)</span>. Such an integral is called a <em>Hankel transform</em>. In that case we’d instead express the general solution for the potential in this problem as a sum over <span class="math inline">\(n\)</span> and an integral over <span class="math inline">\(k\)</span>. Sending <span class="math inline">\(z \rightarrow \infty\)</span> as well makes the <span class="math inline">\(\sinh\)</span> function goes away, giving <span class="math display">\[
\phi(\varrho,\varphi,z) = \sum_{n=0}^\infty \int_0^\infty dk \ J_n(k\varrho) \big[a_n(k) \cos n\varphi + b_n(k) \sin n\varphi\big] \ .
\]</span> The boundary condition relation would then be expressed by the integral <span class="math display">\[
V(\varrho,\varphi) = \sum_{n=0}^\infty \int_0^\infty dk \ J_n(k\varrho) \big[a_n(k) \cos n\varphi + b_n(k) \sin n\varphi\big] \ .
\]</span> Other than that, we’d proceed as the same. The only difference is that we now have a continuum of coefficients to obtain for both <span class="math inline">\(a_n(k)\)</span> and <span class="math inline">\(b_n(k)\)</span>. We can use similar techniques as above, except that the orthogonality relation will result in the Kronecker delta <span class="math inline">\(\delta_{mm'}\)</span> being replaced by a Dirac delta function <span class="math inline">\(\delta(k-k')\)</span>.</p>
<ul>
<li>Fill this in more, since you’ll use it in the next example.</li>
<li>Add a section on Hankel transforms to the appendix, and expand on the Fourier transform there (and above perhaps).</li>
</ul>
<section id="example-conducting-plane-with-a-circular-hole" class="level5">
<h5 class="anchored" data-anchor-id="example-conducting-plane-with-a-circular-hole">Example: Conducting plane with a circular hole</h5>
<ul>
<li>See Jackson.</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../electrodynamics/bvps-1.html" class="pagination-link" aria-label="Boundary Value Problems I">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Boundary Value Problems I</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../electrodynamics/multipole-expansion.html" class="pagination-link" aria-label="Multipole Expansion">
        <span class="nav-page-text"><span class="chapter-title">Multipole Expansion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>